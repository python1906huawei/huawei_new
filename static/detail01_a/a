ec.pkg("ec.product.remark");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});function rmsImgUrl(url){return url.replace(openApiDomain+"/rms/getCommentImage?imagePath=/",domainRms+"/comment/image/")}ec.remark={};var loadEvaluate=false;var bFirstLoadEvaluate=false;var pageSize=10;$(function(){$("#j-gbomcode4comments").change(function(){ec.product.remark.loadEvaluate({pageNumber:1,type:0,extraType:$("#productCommentId .product-comment-tab li.current a").attr("extratype"),gbomCode:ec.product.remark.getGbomCode()})})});ec.product.remark.getGbomCode=function(){var sku=ec.product.getSkuInfo(ec.product.getSku());var gbomCode="";if(sku&&sku.pro_sbomList){for(var i=0;i<sku.pro_sbomList.length;i++){if(sku.pro_sbomList[i].sbomCode===sku.code){gbomCode=sku.pro_sbomList[i].gbomCode;break}}}return $("#j-gbomcode4comments").attr("checked")?gbomCode:""};ec.product.remark.loadEvaluate=function(page){$.ajax({url:openApiDomain+"/rms/comment/getCommentList.json?t="+(new Date).getTime(),data:JSON.stringify({pid:ec.product.id,gbomCode:page.gbomCode?page.gbomCode:"",type:page.type?page.type:0,extraType:page.extraType?page.extraType:1,pageSize:pageSize,pageNum:page.pageNumber}),type:"POST",dataType:"json",beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(json.resultCode!="0"){commentFlag=true;$("#pro-tab-evaluate").hide();return}if(!json.data.comments||json.data.comments.length==0){commentFlag=true;$("#pro-tab-evaluate span").textS("("+(json.data.count||0)+")");$("#pro-tab-evaluate").show();$("#pro-msg-list").hide();$("#pro-msg-pager").hide();$("#evaluatePageNumber").hide();if(page.extraType=="0"&&json.data.defaultGoodCount!=null&&json.data.defaultGoodCount>0){$("#product-remark-comment-no").html(+json.data.defaultGoodCount+"位用户进行了默认好评")}else{$("#product-remark-comment-no").html("该商品暂无评价")}$("#product-remark-comment-no").show();return}commentFlag=false;$("#pro-tab-evaluate-content").show();$("#productCommentId").show();$("#pro-tab-evaluate").show();$("#product-remark-comment-no").hide();loadEvaluate=true;var html=[],p,v;for(var i=0;i<json.data.comments.length;i++){p=json.data.comments[i];html.push('<li class="clearfix"><div class="product-comment-user"><p class="product-comment-user-img">');var userPng=imagePath+"/echannel/misc/defaultface_user_small.png";if(p.headImage&&$.trim(p.headImage)!=""){userPng=p.headImage}html.push('<img src="'+ec.autoEncodeAttr(userPng)+'" alt="'+ec.autoEncodeAttr(userPng)+'">');var grade=p.gradeCode==null?0:p.gradeCode;html.push('<i class="icon-vip-level-'+grade+'"></i></p>');html.push('<p class="product-comment-user-name">'+ec.autoEncodeAttr(p.userName)+"</p></div>");html.push('<div class="product-user-comment"><div class="product-user-comment-detial"><div class="h clearfix">');html.push('<div class="product-star"><span class="starRating-area"><s style="width:'+p.score*20+'%"></s></span>');html.push('</div><div class="product-user-comment-impress">');html.push("<dl>");for(var j=0;j<p.tags.length;j++){html.push("<dd>"+ec.autoEncodeAttr(p.tags[j])+"</dd>")}html.push("</dl></div>");var custmerLikeNum=p.likes;if(!custmerLikeNum||custmerLikeNum==null||$.trim(custmerLikeNum)==""){custmerLikeNum=0}html.push('<div class="fr"><div class="product-user-comment-time">'+p.creationTime.substring(0,19)+'</div><a href="javascript:;" class="product-praise-btn" pid="'+p.productId+'" commentId="'+p.commentId+'" type="0"><span>'+parseInt(custmerLikeNum)+"</span></a></div>");html.push("</div>");html.push('<div class="product-user-comment-word" id="'+p.productId+"-"+p.commentId+'">');html.push(htmlspecialcharsOnce(p.content)||"");html.push("</div>");if(p.images.length>0){html.push('<div class="user-comment-img">                           ');html.push('\t<p class="img-small clearfix">                                  ');for(var j=0;j<p.images.length;j++){var pic=p.images[j];html.push('<a href="javascript:;" '+ec.remark.common.privewMin()+' class="img-wrap" ><img id="'+pic.id+'" image-large="'+ec.autoEncodeAttr(rmsImgUrl(pic.large))+'" src="'+ec.autoEncodeAttr(rmsImgUrl(pic.small))+'"></a> ')}html.push("\t</p>                                                         ");html.push('\t<div class="clearfix">                                       ');html.push(ec.remark.common.privewImg("view"));html.push("\t</div>                                                       ");html.push("</div>                                                        ")}html.push('<div class="product-user-comment-sku">');html.push(p.skuAttrs);html.push("</div></div>");html.push('<div class="product-reply">');if(p.canReply==1){html.push('<div class="product-reply-input">');html.push('<input id="reply-'+p.commentId+'" type="text" placeholder="回复评论"><a href="javascript:void(0)" productId="'+p.productId+'" commentId="'+p.commentId+'" type="remark" onclick="ec.product.addReply.addCheck(this)">回复</a>');html.push("</div>")}html.push('<div class="product-reply-detail" replyCount='+p.replyCount+">");for(var j=0;j<p.replies.length;j++){v=p.replies[j];html.push('<div class="product-admin-reply clearfix" >');html.push('<div class="admin-user-img">');html.push('<img src="'+(ec.autoEncodeAttr(v.headImage)||"")+'">');html.push("</div>");html.push("<dl>");if(v.type==0){html.push('<dt class="red">'+(ec.autoEncodeAttr(v.replyerName)||"")+"</dt>");html.push("<dd>"+(htmlspecialcharsOnce(v.replyContent)||"")+"</dd>");var likeNum=v.likes;if(!likeNum||likeNum==null||$.trim(likeNum)==""){likeNum=0}html.push('<dd><a href="javascript:;" class="product-admin-praise-btn" pid="'+p.productId+'" commentId="'+p.commentId+'" replyId="'+v.replyId+'" type="1">赞客服（<span>'+parseInt(likeNum)+"</span>）</a><dd>")}else{html.push("<dt>"+(ec.autoEncodeAttr(v.replyerName)||"")+"</dt>");html.push("<dd>"+(htmlspecialcharsOnce(v.replyContent)||"")+"</dd>")}html.push("</dl></div>")}if(p.replyCount>3){html.push('<div class="product-reply-btn"><a target="_blank" href="/product/viewReply/'+p.productId+"/"+p.commentId+"?t="+(new Date).getTime()+'">查看全部<span>'+p.replyCount+"</span>条回复</a></div>")}else{html.push('<div class="product-reply-btn" style="display:none;"><a target="_blank" href="/product/viewReply/'+p.productId+"/"+p.commentId+"?t="+(new Date).getTime()+'">查看全部<span>'+p.replyCount+"</span>条回复</a></div>")}html.push("</div>");html.push("</div></li>")}if(page.extraType=="0"){if(json.data.defaultGoodCount!=null&&json.data.defaultGoodCount>0&&json.data.page.pageNum==json.data.page.totalPage){html.push('<div class="product-comment-default">还有<span>'+json.data.defaultGoodCount+"</span>位用户给了默认好评</div>")}}var proMsgList=$("#pro-msg-list");proMsgList.html(html.join(""));if(json.data.comments.length==0){proMsgList.hide();$("#product-remark-comment-no").show()}else{proMsgList.show()}$("#pro-tab-evaluate span").textS("("+(json.data.count||0)+")");if(json.data.page.totalPage>1){$("#pro-msg-pager").show();$("#pro-msg-pager").pager({pageNumber:json.data.page.pageNum,pageCount:json.data.page.totalPage,recordCount:json.data.page.totalRow,type:0,extraType:page.extraType?page.extraType:1,gbomCode:ec.product.remark.getGbomCode(),qpageSize:10,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.remark.loadEvaluate})}else{$("#pro-msg-pager").hide()}$("#pro-msg-pager li.link").click(function(){$("html,body").animate({scrollTop:$("#pro-tab-evaluate-content").offset().top-$("#product-tab").height()},100)});$(".product-admin-praise-btn,.product-praise-btn").bind("click",function(){ec.product.remark.likes($(this))});$("#pro-msg-list li").each(function(){var $this=$(this),index=0,$a=$(this).find(".img-wrap"),$img=$(this).find(".img-big img"),$imgBig=$(this).find(".img-big"),prev=$(this).find(".cursor-prev"),next=$(this).find(".cursor-next");if($a.length){$a.click(function(){var $imgSrc=$(this).find("img").attr("image-large");index=$(this).index();$imgBig.removeClass("none");$a.eq(index).addClass("selected").siblings().removeClass("selected");showImg($a,$img,index);showBtn(index,$a.length,prev,next)});$(this).bind("click",function(e){var className=e.target.className.split(" ")[0];switch(className){case"cursor-small":$(this).find(".img-big").addClass("none");$a.removeClass("selected");index=0;break;case"cursor-prev":index<=0?0:--index;$a.eq(index).addClass("selected").siblings().removeClass("selected");showImg($a,$img,index);showBtn(index,$a.length,prev,next);break;case"cursor-next":index>=$a.length-1?$a.length-1:++index;$a.eq(index).addClass("selected").siblings().removeClass("selected");showImg($a,$img,index);showBtn(index,$a.length,prev,next);break;default:break}})}});function showImg(a,img,index){var src=a.eq(index).find("img").attr("image-large");img.attr("src",src)}function showBtn(index,len,btnpre,btnnext){index==len-1?btnnext.hide():btnnext.show();index==0?btnpre.hide():btnpre.show()}},error:function(){commentFlag=true;$("#pro-tab-evaluate-content").hide();$("#productCommentId").hide();$("#pro-tab-evaluate").hide();$(".product-comment-tab").hide()}})};ec.product.remark.loadEvaluateScore=function(){$.ajax({url:openApiDomain+"/rms/comment/getCommentScore.json?t="+(new Date).getTime(),type:"POST",dataType:"json",data:JSON.stringify({pid:ec.product.id}),beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(json&&json.resultCode=="0"&&json.data){if(json.data.goodRate){$("#pro-evaluate-avgSorce").html(parseInt(json.data.goodRate*100)+"<em>%</em>")}if(json.data.hotTags){var html0=[];for(var i=0;i<json.data.hotTags.length;i++){var p=json.data.hotTags[i];if(p.count>0){var temp='<li><a href="javascript:;"><em>'+ec.autoEncodeAttr(p.tagName)+"</em><span>"+p.count+"</span></a></li>";html0.push(temp)}}$("#pro-score-impress").html(html0.join(""))}}else{return}}})};ec.product.remark.bindEvent=function(){$(".product-comment-tab").find("a").bind("click",function(){var exType=$(this).attr("extraType");$(this).parent().addClass("current").siblings().removeClass("current");ec.product.remark.loadEvaluate({pageNumber:1,type:0,extraType:exType,gbomCode:ec.product.remark.getGbomCode()})})};ec.product.remark.likes=function(obj){var productId=obj.attr("pid");var remarkId=obj.attr("commentId");var repId=obj.attr("replyId");var type=obj.attr("type");$.ajax({url:openApiDomain+"/rms/comment/like.json?t="+(new Date).getTime(),type:"POST",data:JSON.stringify({pid:productId,commentId:remarkId,replyId:repId,type:type}),dataType:"json",beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(json&&json!=undefined&&json.resultCode){var resultCode=json.resultCode;switch(resultCode){case"0":var likeNum=obj.find("span").text();obj.find("span").text(parseInt(likeNum)+1);obj.addClass("click");obj.unbind("click");break;case"42003":ec.account.loginName="";ec.account.afterLogin(function(){ec.product.remark.likes(obj)});break;case"60008":ec.product.remark.showErrorMsg();break;default:break}return}}})};ec.product.remark.loadProductInfoEvaluateScore=function(){$.ajax({url:openApiDomain+"/rms/comment/getCommentCount.json",type:"POST",dataType:"json",data:JSON.stringify({pid:ec.product.id}),beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(json&&json!=undefined&&json.resultCode=="0"&&json.data){$("#prd-remark-scoreAverage").attr("style","width:"+json.data.averageScore*20+"%");$("#prd-remark-scoreAverage").show();$("#prd-remark-jmptoremark").attr("title","共 "+json.data.count+" 条评论");$("#prd-remark-jmptoremark").textS("共&nbsp;"+json.data.totalPrdCount+"&nbsp;条评论");$("#prd-remark-jmptoremark").show();$("#prd-remark-span-tab-evaluate").html("用户评价<em>（"+json.data.totalPrdCount+"）</em>");$("#prd-remark-span-tab-evaluate").show()}}})};ec.product.remark.showErrorMsg=function(){var html=[];html.push('<div class="box-errors-1">');html.push("<span>不能重复点赞</span>");html.push("</div>");html.push('<div class="box-button"><a href="javascript:;" class="box-ok"><span>确定</span></a></div>');var box=new ec.box(html.join(""),{boxid:"box_reply_error_msg",boxclass:"ol_box_4 small",title:"",showButton:false,onopen:function(box){box.setPosition()},onok:function(box){box.close()},onclose:function(){}}).open()};ec.pkg("ec.product.addReply");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.product.addReply.addCheck=function(obj){ec.product.addReply.productId=$(obj).attr("productId");ec.product.addReply.commentId=$(obj).attr("commentId");ec.product.addReply.type=$(obj).attr("type");ec.product.addReply.content=$.trim($("#reply-"+ec.product.addReply.commentId).val());if(!ec.product.addReply.checkIllegalChar(ec.product.addReply.content)){ec.product.addReply.showErrorMsg("回复内容不能包含“[]><&#”等特殊字符");return}var _replylen=ec.product.addReply.length($.trim($("#reply-"+ec.product.addReply.commentId).val()));if(_replylen>600){ec.product.addReply.showErrorMsg("评论最多不能超过600个字符");return}if(_replylen==0){ec.product.addReply.showErrorMsg("回复不能为空");return}ec.product.addReply.add(ec.product.addReply.productId,ec.product.addReply.commentId,ec.product.addReply.type)};ec.product.addReply.add=function(productId,commentId,type){$.ajax({url:openApiDomain+"/rms/comment/saveReply.json?t="+(new Date).getTime(),type:"POST",data:JSON.stringify({productId:productId,commentId:commentId,userClient:1,content:ec.product.addReply.content}),dataType:"json",timeout:1e4,beforeSend:function(xhr){ec.ui.loading.show;xhr.withCredentials=true},success:function(json){if(json!=""&&json!=undefined){var processResult=ec.product.addReply.result(json,true);if(processResult.result){ec.product.addReply.showErrorMsg("回复成功",1)}else{ec.ui.loading.hide();if(processResult.code=="42003"){ec.account.loginName=ec.util.cookie.set("ac_loNa",null,{domain:"vmall.com"});ec.account.afterLogin(function(){ec.product.addReply.add(productId,commentId,type)})}else{ec.product.addReply.showErrorMsg(processResult.msg);return}}}else{ec.product.addReply.showErrorMsg("添加回复失败，请稍后重试");return}},error:function(){ec.product.addReply.showErrorMsg("添加回复失败，请稍后重试");return}});$("#reply-"+commentId).val("")};ec.product.addReply.showErrorMsg=function(msg,success){var html=[];html.push('<div id="pro-add-success-mask" style="visibility:hidden;font-size:18px;width:348px;position: absolute;"></div>');var computeRes=ec.product.addReply.compute($("#pro-add-success-mask"),msg);if(success!=null){html.push('<div class="box-right-1">')}else{if(computeRes.h>27){html.push('<div class="box-errors-2">')}else{html.push('<div class="box-errors-1">')}}html.push("<span>"+msg+"</span>");html.push("</div>");html.push('<div class="box-button"><a href="javascript:;"  class="box-ok"><span>确定</span></a></div>');var box=new ec.box(html.join(""),{boxid:"box_reply_error_msg",boxclass:"ol_box_4 small",title:"",showButton:false,onopen:function(box){box.setPosition()},onok:function(box){box.close();if(success!=null){ec.product.addReply.addComment()}},onclose:function(){}}).open()};ec.product.addReply.compute=function(dom,val){dom.textS(val);return{w:dom[0].offsetWidth,h:dom[0].offsetHeight}};ec.product.addReply.result=function(data,isShowMsg){var resultObj={};var result=false;var msg="";var resultCode="";if(data!=""&&data!=undefined){resultCode=data.resultCode;switch(resultCode){case"0":result=true;break;case"42003":msg="系统繁忙，请稍后重试";break;case"42005":msg="系统繁忙，请稍后重试";break;case"42019":msg="系统繁忙，请稍后重试";break;case"60043":msg="回复已超过最长字数限制";break;case"60044":msg="回复内容不能包含“[]><&#”等特殊字符";break;case"60048":msg="您回复的次数超过限制，无法再次回复";break;case"60049":msg="您发布不当言论过多，被禁止发布回复";break;case"42019":msg="系统繁忙，请稍后重试";break;case"50999":msg="系统繁忙，请稍后重试";break;default:msg="系统繁忙，请稍后重试";break}}else{msg="系统繁忙，请稍后重试"}resultObj.result=result;resultObj.msg=msg;resultObj.code=resultCode;return resultObj};ec.product.addReply.length=function(str){var m=0;var l=str.length;var r=-1;for(var n=0;n<l;n++){r=str.charCodeAt(n);if(r>=0&&r<=128){m+=1}else{m+=2}}return m};ec.product.addReply.getUserHeadUrl=function(){var url;(new ec.ajax).get({url:domainMain+"/member/accountInfo.json",dataType:"json",timeout:1e4,async:false,timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success&&json.code=="login"){ec.account.loginName="";ec.account.afterLogin(function(){})}else{if(json.customerInfo.headPictureURL){url=json.customerInfo.headPictureURL}else{url=imagePath+"/echannel/misc/img_logged_in.png"}}},error:function(){alert("操作超时，请重试！")}});return url};ec.product.addReply.addComment=function(){var rbox=$("#reply-"+ec.product.addReply.commentId).closest("li").find(".product-reply-detail");var r=0;var userImg=ec.product.addReply.getUserHeadUrl();if(ec.util.isEmpty(userImg)||userImg==undefined){userImg=imagePath+"/echannel/misc/img_logged_in.png"}r=rbox.children().find(".red").length;var content='<div class="product-admin-reply clearfix">'+'<div class="admin-user-img">'+'<img src="'+htmlspecialcharsOnce(userImg)+'"></div><dl><dt>'+htmlspecialcharsOnce(ec.account.loginName)+"</dt>"+"<dd>"+htmlspecialcharsOnce(ec.product.addReply.content)+"</dd>"+"</dl></div>";var num=rbox.attr("replyCount");num=parseInt(num)+1;rbox.attr("replyCount",num);if(ec.product.addReply.type=="remark"){rbox.find(".product-reply-btn span").text(num);if(num>3){if(rbox.find(".product-reply-btn").size()==0){$(rbox.children()[2]).after('<div class="product-reply-btn"><a target="_blank" href="/product/viewReply/'+ec.product.addReply.productId+"/"+ec.product.addReply.commentId+"?t="+(new Date).getTime()+'">查看全部<span>'+num+"</span>条回复</a></div>")}else{rbox.find(".product-reply-btn").show()}}if(r<3){if(rbox.children().length>2){$(rbox.children()[2]).remove()}if(r==0){rbox.prepend(content)}else{$(rbox.children()[r-1]).after(content)}}}else{if(r==0){rbox.prepend(content)}else{$(rbox.children()[r-1]).after(content)}}};ec.product.addReply.checkIllegalChar=function(value){var pattern=/(\[|\]|>|<|\\|"|&|#|')/;if(value!=""&&value!=null&&pattern.test(value)){return false}return true};ec.pkg("ec.remark.common");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});var _remarkPrivate={showError:function(text,skuCode){$("#error-area-"+skuCode).show();$("#error-area-"+skuCode).find("label").empty().html(text)},hideError:function(skuCode){$("#error-area-"+skuCode).hide()},getSelectedLen:function(skuCode){return $("#tags-"+skuCode).find(".selected").length},getSelectedDiyLen:function(skuCode){return $("#tags-"+skuCode).find(".tag-li-diy-item.selected").length},checkTagNameRepeat:function(skuCode,tagName){var allTagNames=$("#tags-"+skuCode).find("li .impress").find("a");var allTagNameArray=[];for(var i=0;i<allTagNames.length;i++){var tag=allTagNames[i].text;if(tag!="\u81ea\u5b9a\u4e49")allTagNameArray.push(tag)}return $.inArray(tagName,allTagNameArray)},check:function(skuCode){this.hideError(skuCode);var val=ec.util.trim($("#tag-input-"+skuCode).val());if(val.length==0){this.showError("\u8f93\u5165\u4e0d\u80fd\u4e3a\u7a7a",skuCode);return false}if(val.len()>=13){this.showError("\u6807\u7b7e\u4e0d\u53ef\u4ee5\u8d85\u8fc76\u4e2a\u6c49\u5b57",skuCode);return false}return true}};ec.remark.common.checkSeletedTagNum=function(el,skuCode,opType){var selectedDiyLen=_remarkPrivate.getSelectedDiyLen(skuCode);var selectedLen=_remarkPrivate.getSelectedLen(skuCode);if(selectedDiyLen>=4&&!$(el).hasClass("selected")){var flag=true;switch(opType){case "tagOnclick":if(selectedDiyLen==4&&$(el).hasClass("tag-li-diy-item"))flag=false;else if(selectedLen<5)flag=true;else flag=false;break;case "addTag":flag=false;break;case "diyOnclick":if($(el).hasClass("tag-li-diy-item"))flag=false;break;default:flag=false;break}if(!flag)if(selectedLen>=5)_remarkPrivate.showError("\u6700\u591a\u8d345\u4e2a\u6807\u7b7e\uff0c\u4f60\u5df2\u7ecf\u8d34\u6ee1\u4e86",skuCode);else _remarkPrivate.showError("\u6700\u591a\u8d344\u4e2a\u81ea\u5b9a\u4e49\u6807\u7b7e\uff0c\u4f60\u5df2\u7ecf\u8d34\u6ee1\u4e86",skuCode);return flag}if(selectedLen>=5&&!$(el).hasClass("selected")){_remarkPrivate.showError("\u6700\u591a\u8d345\u4e2a\u6807\u7b7e\uff0c\u4f60\u5df2\u7ecf\u8d34\u6ee1\u4e86",skuCode);return false}return true};ec.remark.common.tagOnclick=function(el){var skuCode=$(el).parent().attr("data-sku");if(ec.remark.common.checkSeletedTagNum(el,skuCode,"tagOnclick")){_remarkPrivate.hideError(skuCode);$(el).toggleClass("selected");var ch=$(el).find("input")[0];if(ch)if(ch.checked)ch.checked=false;else ch.checked=true}};ec.remark.common.diyOnclick=function(el){var skuCode=$(el).parent().parent().parent().attr("data-sku");if(ec.remark.common.checkSeletedTagNum(el,skuCode,"diyOnclick"))$("#diy-area-"+skuCode).addClass("current")};ec.remark.common.addTag=function(e1,skuCode){if(ec.remark.common.checkSeletedTagNum(e1,skuCode,"addTag")&&_remarkPrivate.check(skuCode)){var tagContent=ec.util.trim($("#tag-input-"+skuCode).val());if(checks(tagContent)){alert("\u6807\u7b7e\u5185\u5bb9\u5b58\u5728\u4e0d\u5408\u6cd5\u5b57\u7b26\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165");return}else{var checkResult=_remarkPrivate.checkTagNameRepeat(skuCode,tagContent);if(checkResult>=0){_remarkPrivate.showError("\u60a8\u8f93\u5165\u7684\u6807\u7b7e\u540d\u79f0\u5df2\u7ecf\u5b58\u5728",skuCode);return}else _remarkPrivate.hideError();var html=[];html.push('\x3cli class\x3d"ce-post-impress-item tag-li-diy-item selected" onclick\x3d"ec.remark.common.tagOnclick(this);"\x3e');html.push('\x3cdiv class\x3d"impress"\x3e');html.push('\x3cinput type\x3d"checkbox" checked\x3d"checked" name\x3d"diyTags-'+skuCode+'" style\x3d"visibility: hidden; position: absolute;" value\x3d"'+ec.autoEncodeAttr(tagContent)+'" id\x3d"diyTags"\x3e');html.push('\x3ca href\x3d"javascript:;" id\x3d"diyTags-a-'+skuCode+'"\x3e'+ec.autoEncodeAttr(tagContent)+"\x3c/a\x3e\x3cs\x3e\x3c/s\x3e\x3c/div\x3e\x3c/li\x3e");$("#diy-area-"+skuCode).before(html.join(""));$("#tag-input-"+skuCode).val("");if(_remarkPrivate.getSelectedLen()>=5)$("#diy-area-"+skuCode).removeClass("current")}}};function checks(newName){var regCn=/[^\u4e00-\u9fa5\s*a-zA-Z1-9\-]/;if(regCn.test(newName))return true;return false}ec.remark.common.login=function(call){ec.account.afterLogin(function(){if(call)call()})};ec.remark.common.showErrorMsg=function(msg,buttonType){if(!msg||$.trim(msg)=="")msg="";var buttonInfo='\x3ca href\x3d"javascript:;" class\x3d"box-cancel"\x3e\x3cspan\x3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e';switch(buttonType){case 1:buttonInfo='\x3ca href\x3d"javascript:;" class\x3d"box-cancel"\x3e\x3cspan\x3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e';break;case 2:buttonInfo='\x3ca href\x3d"/member/prdRemarkView?t\x3d'+(new Date).getTime()+'" class\x3d"box-cancel" \x3e\x3cspan\x3e\u6211\u4e0d\u6539\u4e86\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"'+serviceRobotim+'" target\x3d"_blank" class\x3d"box-ok"\x3e\x3cspan\x3e\u8054\u7cfb\u5ba2\u670d\x3c/span\x3e\x3c/a\x3e';break;default:buttonInfo='\x3ca href\x3d"javascript:;" class\x3d"box-cancel"\x3e\x3cspan\x3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e';break}var html=[];html.push('\x3cdiv class\x3d"box-content" style\x3d"height: auto;"\x3e                                                         ');html.push('\t\x3cdiv class\x3d"box-prompt01-error"\x3e                                                                       ');html.push('\t\t\x3cdiv class\x3d"h"\x3e                                                                                    ');html.push("\t\t\t\x3ci\x3e\x3c/i\x3e                                                                                        ");html.push("\t\t\x3c/div\x3e                                                                                             ");html.push('\t\t\x3cdiv class\x3d"b"\x3e                                                                                    ');html.push('\t\t\t\x3cp id\x3d"comments-msg-'+buttonType+'"\x3e'+msg+"\x3c/p\x3e                                            ");html.push("\t\t\x3c/div\x3e                                                                                             ");html.push("\t\x3c/div\x3e                                                                                                 ");html.push('\t\x3cdiv class\x3d"box-button"\x3e                                                                               ');html.push(buttonInfo);html.push("\t\x3c/div\x3e                                                                                                 ");html.push("\x3c/div\x3e                                                                                                  ");var box=new ec.box(html.join(""),{boxid:"box_remark_tips_common_message",boxclass:"ol_box_4",showButton:false,showTitle:true,showCancel:false,showOk:false,width:600,onclose:function(dom){},onopen:function(box){},onok:function(dom){}});box.open()};ec.remark.common.privewImg=function(view){var html=[];html.push('\t\t\x3cdiv class\x3d"img-big none"\x3e                       ');if("view"!=view)html.push('        \x3ca href\x3d"javascript:;" class\x3d"comment-img-delete"\x3e\u5220\u9664\x3c/a\x3e');html.push('\t\t\t\x3cimg src\x3d""\x3e                                 ');html.push('\t\t\t\x3cdiv class\x3d"cursor-prev" style\x3d"cursor:url('+imagePath+'/echannel/icon/arrow-left.cur),auto;"\x3e\x3c/div\x3e              ');html.push('\t\t\t\x3cdiv class\x3d"cursor-small" style\x3d"cursor:url('+imagePath+'/echannel/icon/zoom-out.cur),auto;"\x3e\x3c/div\x3e             ');html.push('\t\t\t\x3cdiv class\x3d"cursor-next" style\x3d"cursor:url('+imagePath+'/echannel/icon/arrow-right.cur),auto;"\x3e\x3c/div\x3e              ');html.push("\t\t\x3c/div\x3e                                           ");return html.join("")};ec.remark.common.privewMin=function(){return'style\x3d"cursor:url('+imagePath+'/echannel/icon/zoom-in.cur),auto;"'};ec.remark.common.check=function(skuCode,count){var canSubmit=false;var skuCodeObj=$("#tags-"+skuCode);var score=$.trim($("#score-"+skuCode).attr("data-score"));var content=$.trim($("#content-"+skuCode).val());if(500<content.length){$("#commodity-content-msg-"+skuCode).html("\u8bc4\u8bba\u6700\u591a\u4e0d\u80fd\u8d85\u8fc7500\u4e2a\u5b57\u54e6").css("display","block");return false}if(!ec.remark.common.checkIllegalChar(content)){$("#commodity-content-msg-"+skuCode).html("\u60a8\u63d0\u4ea4\u7684\u8bc4\u8bba\u5305\u542b[]\x3e\x3c\"\x26#'\u7b49\u7279\u6b8a\u5b57\u7b26,\u8bf7\u4fee\u6539").css("display","block");return false}count.push(skuCode);return true};ec.remark.common.checkIllegalChar=function(value){var pattern=/(\[|\]|>|<|\\|"|&|#|')/;if(value!=""&&value!=null&&pattern.test(value))return false;return true};ec.pkg("ec.product");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.load("ec.index");ec.load("cloud-zoom",function(){setTimeout(function(){$("#product-img").CloudZoom()},200)});ec.load("ec.product.gift");ec.load("ec.product.coupon");ec.load("rush");ec.load("deposit");ec.load("jquery.fixed",function(){$(function(){$("#pro-tab-all").fixed()})});ec.ui.countdown2=function(selector,options){var obj=$(selector),timer=obj.data("countdown"),timeIndex=0,preTarget,diff,diffMs=options.now.getTime()-(new Date).getTime(),diffSecs=0,getNext=function(){if(timeIndex>=options.times.length)return false;preTarget=options.times[timeIndex];timeIndex++;return true},getDiffSec=function(){diffSecs=Math.round((ec.util.parseDate(preTarget).getTime()-(new Date).getTime()-diffMs)/1E3);diffSecs=diffSecs<=0?0:diffSecs;return diffSecs},render=function(){diffSecs--;if(diffSecs<=0)diffSecs=0;diff={day:Math.floor(diffSecs/(24*60*60)),hour:options.html.indexOf("{#day}")>=0?Math.floor(diffSecs/60/60)%24:Math.floor(diffSecs/60/60),minute:Math.floor(diffSecs/60)%60,second:diffSecs%60};var html=options.html.replace(/{#day}/g,diff.day>9?diff.day:"0"+diff.day).replace(/{#hours}/g,diff.hour>9?diff.hour:"0"+diff.hour).replace(/{#minutes}/g,diff.minute>9?diff.minute:"0"+diff.minute).replace(/{#seconds}/g,diff.second>9?diff.second:"0"+diff.second);obj.html(html);return diffSecs<=0?false:true};if(!options.times)options.times=[options.endTime];clearInterval(timer);while(getNext()){if(getDiffSec()<=0)continue;break}if(!render())return;timer=setInterval(function(){if(!render()){if(options.callback)options.callback(options);if(!getNext())clearInterval(timer);else getDiffSec()}},1E3);obj.data("countdown",timer)};var detailContentHeigh=0;var productParameterHeight=0;var packageServiceHeight=0;var customerServiceHeight=0;var tit1=0;var tit2=0;var tit3=0;var tit4=0;var oTop=0;var clickFlag=false;var packFlag=false;var commentFlag=false;var scollFlag=false;var upDownButton="";var finished=true;ec.product.packageList={};ec.product.warranty={};var playerArray=[];$(function(){$("#myConsultation").click(function(){$("#myConsultation").hide();$("#upUserAdvisory").removeClass("hide").addClass("show");$("#stopConsultationId").show()});oTop=$(".product-tab").offset().top;$("#pro-tab-feature").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag)tit1=$(".tit1").offset().top-50;clickFlag=true}$("#pro-tab-feature").addClass("selected").siblings().removeClass("selected");$("body,html").animate({scrollTop:tit1+75},0)});$("#pro-tab-parameter").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag)tit1=$(".tit1").offset().top-50;clickFlag=true}$("#pro-tab-parameter").addClass("selected").siblings().removeClass("selected");tit2=tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height();$("body,html").animate({scrollTop:tit2},0)});$("#pro-tab-package-service").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag)tit1=$(".tit1").offset().top-50;clickFlag=true}$("#pro-tab-package-service").addClass("selected").siblings().removeClass("selected");tit3=tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height()+$("#productParameter").height()+$("#hr60Detail").height();$("body,html").animate({scrollTop:tit3},0)});$("#pro-tab-evaluate").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag)tit1=$(".tit1").offset().top-50;clickFlag=true}$("#pro-tab-evaluate").addClass("selected").siblings().removeClass("selected");tit4=tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height()+$("#productParameter").height()+$("#hr60Detail").height()+$("#packagId").height()+$("#customerServiceLocation").height()+$("#productDetailstips").height();$("body,html").animate({scrollTop:tit4},0)});$(window).scroll(function(){var top=$(this).scrollTop()+1;detailContentHeight=$("#pro-tab-feature-content").height()+$("#hr60Detail").height();productParameterHeight=$("#productParameter").height()+$("#hr60Detail").height();packageServiceHeight=$("#packagId").height();customerServiceHeight=$("#customerServiceLocation").height()+$("#productDetailstips").height();if(top>oTop){$(".product-tab").addClass("product-tab-top").css({"position":"fixed","top":"0","background":"#fff","width":"100%","z-index":"100"});$(".product-tab-btn").css({"display":"block"});if(!clickFlag)tit1=$(".tit1").offset().top-50;scollFlag=true}else{$(".product-tab").css({"position":"static"});$(".product-tab-btn").css({"display":"none"});$(".product-tab").removeClass("product-tab-top");if(!clickFlag)tit1=$(".tit1").offset().top-150;scollFlag=false}if(top>=tit1+75&&top<tit1+detailContentHeight)$("#pro-tab-feature").addClass("selected").siblings().removeClass("selected");if(packFlag==true){if(top>=tit1+detailContentHeight&&top<tit1+detailContentHeight+productParameterHeight+$("#productDetailstips").height())$("#pro-tab-parameter").addClass("selected").siblings().removeClass("selected")}else if(top>=tit1+detailContentHeight&&top<tit1+detailContentHeight+productParameterHeight)$("#pro-tab-parameter").addClass("selected").siblings().removeClass("selected");if(packFlag==false)if(top>=tit1+detailContentHeight+productParameterHeight&&top<tit1+detailContentHeight+productParameterHeight+packageServiceHeight+customerServiceHeight)$("#pro-tab-package-service").addClass("selected").siblings().removeClass("selected");if(top>=tit1+detailContentHeight+productParameterHeight+packageServiceHeight+customerServiceHeight)$("#pro-tab-evaluate").addClass("selected").siblings().removeClass("selected")})});ec.ui.proNumer=function(selector,options){var defaultOpt={max:null,min:null,showButton:true,minusBtn:'\x3ca id\x3d"pro-quantity-minus" href\x3d"javascript:;"\x3e\x26minus;\x3c/a\x3e',plusBtn:'\x3ca id\x3d"pro-quantity-plus" href\x3d"javascript:;"\x3e\x26#43;\x3c/a\x3e'},thix=$(selector),options=$.extend(defaultOpt,options),checkNumber=function(e){var currentKey=e.which,val=parseInt(this.value,10),thisVal=val<1?1:val;if((currentKey<37||currentKey>40)&&currentKey!=8&&currentKey!=46)if(thisVal>options.max||thisVal<options.min){e.preventDefault();return false}else if((currentKey<48||currentKey>57)&&(currentKey<96||currentKey>105)&&currentKey!=9){e.preventDefault();return false}};thix.each(function(){var opt=$.extend({},options),inputObj=$(this).css("ime-mode","disabled");var tmp=inputObj.attr("max");if(tmp)options.max=opt.max=parseInt(tmp,10)||opt.max;tmp=inputObj.attr("min");if(tmp)options.min=opt.min=parseInt(tmp,10)||opt.min;if(opt.showButton){var minusBtn=$(opt.minusBtn).click(function(){var val=inputObj.val()||0,thisVal=parseInt(val,10)-1;if(typeof opt.min=="number"&&thisVal<opt.min)return;inputObj.valS(thisVal).trigger("blur")}),plusBtn=$(opt.plusBtn).click(function(){var val=inputObj.val()||0,thisVal=parseInt(val,10)+1;if(typeof opt.max=="number"&&thisVal>opt.max)return;inputObj.valS(thisVal).trigger("blur")});var temp=$('\x3cp class\x3d"product-stock-btn"\x3e\x3c/p\x3e').append(plusBtn).append(minusBtn);inputObj.after(temp);if(this.value<=1)$("#pro-quantity-minus").removeClass().addClass("disabled");else $("#pro-quantity-minus").removeClass()}inputObj.data("ovalue",inputObj.val()||0).keydown(checkNumber).keyup(function(){var thisVal=parseInt(this.value||0);if(typeof opt.min=="number"&&thisVal<opt.min){this.value=opt.min;return}else if(typeof opt.max=="number"&&thisVal>opt.max){this.value=opt.max;return}}).blur(function(){if(this.value<=1)$("#pro-quantity-minus").removeClass().addClass("disabled");else $("#pro-quantity-minus").removeClass();if(typeof opt.onchange==="function"){var oldVal=inputObj.data("ovalue"),newVal=this.value||0,diff=parseInt(newVal,10)-parseInt(oldVal,10);if(diff==0)return;inputObj.data("ovalue",newVal);opt.onchange.call(this,newVal,diff)}})})};ec.product.prefix="/product";ec.product.email=ec.autoEncodeAttr(ec.account.email);ec.product.mobile=ec.autoEncodeAttr(ec.account.mobile);var _skuForGetFeature={};var _giftBuyItemId=new Array;(function(){var _preSku=null,isFirstIn=true,_skuForGetParement={},_skuMap={},_skuShowType={},_skuAttrId2SkuMap={},_skuAttrTypeID=[],_skuAttrName=[],_skuAttrVallue={},_skuAttrType2ValueIds={},_selectAttrMap={},_attrValue2SkuId={},_timer,_skuPriority={},_skuPointWeigth={},_skuPointWeigthDetail={};ec.product.getSkuPointWeight=function(skuCode){return _skuPointWeigth[skuCode]};ec.product.setSkuPointWeight=function(skuCode,promotion){_skuPointWeigth[skuCode]=promotion};ec.product.getSkuPointWeightDetail=function(skuCode){return _skuPointWeigthDetail[skuCode]};ec.product.setSkuPointWeightDetail=function(skuCode,promotion){_skuPointWeigthDetail[skuCode]=promotion};_proGallerysMouseOver=function(){var thix=$(this);thix.parent().parent().addClass("current").siblings().removeClass("current");clearTimeout(_timer);_timer=setTimeout(function(){var img=thix.attr("src");$("#product-img").attr("href",img.replace("78_78","800_800")).find("img").attr("src",img.replace("78_78","428_428"));$("#product-img").CloudZoom()},150)},_updateSelect=function(){var selectPara="";$("#pro-skus").find(".selected").each(function(){if(!$(this).parents("#giftPackageList").length>0&&!$(this).parents("#packageList").length>0)selectPara+=$(this).children().children("a").attr("title")+" / "});selectPara=selectPara.substring(0,selectPara.length-2);selectPara=ec.autoEncodeAttr(selectPara);if($("#packageSelect").length>0)$("#packageSelect ul li").each(function(){if($(this).hasClass("selected")){var tempPackage=ec.autoEncodeAttr($(this).attr("data-attrname"));selectPara+='\x3cdiv id\x3d"package-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;'+tempPackage+"\x3c/div\x3e"}});if($("#giftBuy_dl").length>0)$("#giftBuy_dl ul li").each(function(){if($(this).hasClass("selected")){var tempGiftBuy=ec.autoEncodeAttr($(this).find("a").attr("title"));selectPara+='\x3cdiv id\x3d"giftBuy-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;'+tempGiftBuy+"\x3c/div\x3e"}});selectPara+="";$("#pro-select-sku").html(selectPara);$("#pro-select-sku").parent().show()};_upadteSkuPrice=function(sku){if(sku.priceMode!=2)sku.price=parseFloat(sku.price).toFixed(2);if(parseFloat(sku.originPrice)!=parseFloat(sku.price)&&sku.priceMode!=2){$("#pro-price-label").html("\u62a2\u8d2d\u4ef7");$("#pro-price-label").removeClass("f24").addClass("type");$("#pro-price").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+sku.price);$("#pro-price-old").html("\x26yen;\x26nbsp;"+parseFloat(sku.originPrice).toFixed(2));$("#pro-price-label").show();$("#pro-price").show();$("#pro-price-old").show();if(ec.product.productType==4||parseInt(sku.buttonMode)==22)$("#pro-price-hide").valS(sku.price)}else{$("#pro-price-old").hide();$("#pro-price-label").hide();$("#pro-price-old").html("");$("#pro-price-label").html("");if(sku.price>0)if(ec.product.productType==4||parseInt(sku.buttonMode)==22){$("#pro-price-hide").valS(sku.price);$("#pro-price").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+sku.price);$("#pro-price").show();$("#pro-price-label-deposit").hide();$("#pro-price-deposit").hide();$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#buyProcessIDD").hide();$("#goAddressId").hide()}else{$("#pro-price").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+sku.price);$("#pro-price").show()}else{$("#pro-price").html("");$("#pro-price").hide();$("#pro-price-label").html("\u6682\u65e0\u62a5\u4ef7");if($("#pro-price-label").hasClass("type"))$("#pro-price-label").removeClass("type").addClass("f24");$("#pro-price-label").show()}}if(sku.priceMode==2||sku.price<=0){$("#pro-price").hide();$("#pro-price-old").hide();$("#pro-price-label").html("\u6682\u65e0\u62a5\u4ef7");$("#pro-price-label").show()}};_updateSkuInfo=function(){var sku=ec.product.getSku(),timerPromWord;if(!sku||_preSku==sku)return;else{ec.product.videoHide();if($("#extendSelect").next().is("a"))$("#extendSelect").next().remove();$("#extendSelect").parent().removeClass("selected");if($("#accidentSelect").next().is("a"))$("#accidentSelect").next().remove();$("#accidentSelect").parent().removeClass("selected");if($("#ucareSelect").next().is("a"))$("#ucareSelect").next().remove();$("#ucareSelect").parent().removeClass("selected")}$("#package_dl").remove();$("#packageList").html("");$("#packageCode").val("");$("#giftPackageList").html("");ec.product.gift.packageGiftMap[sku]==[];ec.product.setSkuId=_preSku=sku;$("#product-tips").hide();$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#pro-quantity-area").show();$("#pro-quantity-area-nochange").hide();$("#product-operation").hide();ec.diypkg.init();if(ec.product.remark.getGbomCode())ec.product.remark.loadEvaluate({pageNumber:1,type:0,extraType:$("#productCommentId .product-comment-tab li.current a").attr("extratype"),gbomCode:ec.product.remark.getGbomCode()});sku=_skuMap[sku];ec.product.setType(sku.type);_upadteSkuPrice(sku);var html=[];html.push('\x3ca href\x3d"javascript:;" class\x3d"product-slogan-btn"\x3e\x3c/a\x3e');if($.trim(sku.timerPromWord).length>0){if($.trim(sku.timerPromLink4PC).length>0)timerPromWord='\x3ca href\x3d"'+sku.timerPromLink4PC+'" target\x3d"_blank" class\x3d"product-slogan-link"\x3e'+sku.timerPromWord+"\x3c/a\x3e";var _now=ec.product.getSysDate();var start=sku.timerPromStarttime;var startTime=new Date;startTime.setTime(ec.util.parseDate(start));var end=sku.timerPromEndtime;var endTime=new Date;endTime.setTime(ec.util.parseDate(end));if(_now-startTime>=0&&endTime-_now>=0)html.push(timerPromWord||'\x3cspan class\x3d"product-slogan-link"\x3e'+sku.timerPromWord+"\x3c/span\x3e")}if($.trim(sku.skuPromWord).length>0)html.push("\x3cspan\x3e"+sku.skuPromWord+"\x3c/span\x3e");if(0<html.length){$("#skuPromWord").html(html.join(" "));$("#skuPromWord").css("display","block");$(".product-slogan-btn").hide();$("#skuPromWord").attr("class","product-slogan");var nowHeight=$("#skuPromWord").height();if(nowHeight>40){$("#skuPromWord").attr("class","product-slogan product-slogan-hide");$(".product-slogan-btn").show();$(".product-slogan-btn").mouseenter(function(){if($("#skuPromWord").hasClass("product-slogan-show"))$("#skuPromWord").attr("class","product-slogan product-slogan-hide");else $("#skuPromWord").attr("class","product-slogan product-slogan-show");ec.product.refreshStyle()});$("#skuPromWord").mouseleave(function(){if($("#skuPromWord").hasClass("product-slogan-show")){$("#skuPromWord").attr("class","product-slogan product-slogan-hide");ec.product.refreshStyle()}})}}else{$("#skuPromWord").html("");$("#skuPromWord").hide()}if(!$.trim(sku.skuPromWord).length>0&&!$.trim(sku.timerPromWord).length>0)$("#skuPromWord").hide();$("#pro-sku-code").valS(sku.code);$("#pro-sku-code2").textS(sku.code);$("#pro-name").html(sku.name);$("#bread-pro-name").html(sku.name);ec.product.inventory.wait(function(){ec.product.execute("renderInventory",[ec.product.inventory.haveInventory(sku.id)]);ec.product.refreshStyle()});ec.product.showPosters();html=[];if(!sku.giftList||sku.giftList.length==0)isShowGifts=false;else{isShowGifts=false;for(var i=0;i<sku.giftList.length;i++)if(sku.giftList[i].displayType==1){isShowGifts=true;break}}if(isShowGifts){$("#product-info-list-new").show();$("#pro-match-gift").show();$("#pro-gift-list-select").html(ec.product.gift.ftl(ec.product.getSku()))}else{if($("#product-prom-all").find("product-prom-item").length=1)if($("#product-prom-all").find("product-prom-item").attr("id")=="pro-match-gift")$("#product-info-list-new").hide();$("#pro-match-gift").hide()}html=[],htmldetail=[];if(!sku.promotionLst||sku.promotionLst.length==0){$(".product-prom-item").eq(0).siblings().remove();if($("#pro-gift-list-select").children().length<0||!sku.giftList||sku.giftList.length==0)$("#product-info-list-new").hide();if($("#product-prom-all .product-prom-item:visible").length<1)$("#product-info-list-new").hide()}else{if($(".product-prom").parent().hasClass("hide")||$(".product-prom").parent().css("display")=="none"){$(".product-prom").parent().removeClass("hide");$(".product-prom").parent().css("display","")}$(".product-prom-item").eq(0).siblings().remove();if($("#product-prom-all .product-prom-item:visible").length<1)$("#product-info-list-new").hide();htmldetail.push(' \x3cdiv class\x3d"product-prom-item clearfix relative hide" id\x3d"promBtn"\x3e');htmldetail.push('\x3cp class\x3d"fl"\x3e');for(var i=0;i<sku.promotionLst.length;i++){htmldetail.push('\x3cem class\x3d"tag"\x3e'+sku.promotionLst[i].promoLabel+"\x3c/em\x3e");html.push('\x3cdiv class\x3d"product-prom-item clearfix" \x3e');html.push('\x3cem class\x3d"tag"\x3e'+sku.promotionLst[i].promoLabel+"\x3c/em\x3e");html.push('\x3cdiv class\x3d"product-prom-con" title\x3d"'+sku.promotionLst[i].ruleDescription+'"\x3e');html.push(' \x3cspan class\x3d"product-prom-word"\x3e');html.push(sku.promotionLst[i].ruleDescription);html.push(" \x3c/span\x3e");if(sku.promotionLst[i].isRealNameAuth=="1")html.push('\x3ca href\x3d"/authmember/accesstoken" target\x3d"_blank"  class\x3d"product-prom-link"\x3e\u9650\u5b9e\u540d\u7528\u6237\u53c2\u52a0 \x3e\x3c/a\x3e');html.push("\x3c/div\x3e");html.push("\x3c/div\x3e")}htmldetail.push('\x3c/p\x3e\x3cdiv class\x3d"product-prom-btn" id\x3d"show-all-prom"  \x3e\u5c55\u5f00\u4fc3\u9500\x3c/div\x3e\x3c/div\x3e');$(".product-prom").append(html.join(""));$(".product-prom .product-prom-item").hide();if($("#pro-gift-list-select").find("a").length>0&&isShowGifts)if($("#product-prom-all").children().length>4){for(var i=0;i<3;i++)$(".product-prom-item").eq(i).show();$(".product-prom").append(htmldetail.join(""));$("#promBtn").show();for(var i=0;i<2;i++)$("#promBtn em").eq(i).hide()}else{$(".product-prom .product-prom-item").show();$(".product-prom").append(htmldetail.join(""))}else if($("#product-prom-all").children().length>5){for(var i=1;i<4;i++)$(".product-prom-item").eq(i).show();$(".product-prom").append(htmldetail.join(""));$("#promBtn").show();for(var i=0;i<3;i++)$("#promBtn em").eq(i).hide()}else{$(".product-prom .product-prom-item").show();$(".product-prom").append(htmldetail.join(""))}if(!$("#pro-gift-list-select").find("a").length>0||!isShowGifts)$("#pro-match-gift").hide()}html=[];if(ec.product.seCode!=ec.product.productSeCode)html.push("\x3cp\x3e\u5df2\u5305\u90ae\x3cem\x3e\x3c/em\x3e\u7531"+ec.product.productshopName+"\u53d1\u8d27\uff0c\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1\x3c/p\x3e");else{if(parseFloat(ec.product.deliveryModeValueFreeBase)>0&&ec.product.productType==0){if(sku.priceMode!=2)if(parseFloat(sku.price)>=parseFloat(ec.product.deliveryModeValueFreeBase))html.push("\x3cp\x3e\u5df2\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5df2\u514d\u8fd0\u8d39\x3cem\x3e\x3c/em\x3e");else html.push("\x3cp\x3e\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5373\u514d\u8fd0\u8d39\uff0c\u5feb\u53bb\u51d1\u5355\u5427\x3cem\x3e\x3c/em\x3e")}else html.push("\x3cp\x3e");html.push("\u7531\u534e\u4e3a\u5546\u57ce\u8d1f\u8d23\u53d1\u8d27\uff0c\u5e76\u63d0111\u4f9b\u552e\u540e\u670d\u52a1\x3c/p\x3e")}if($("#pro-select-gift-service")!=undefined){$("#pro-select-gift-service").remove();_giftBuyItemId=[]}if($("#giftBuy_dl")!=undefined)$("#giftBuy_dl").remove();var hasSelectCustomize=false;if(sku.buttonMode=="11")hasSelectCustomize=true;var isPriority=$("#isPriority").val();$("#package_dl").remove();$("#packageList").html("");$("#packageCode").val("");ec.product.inventory.wait(function(){if(sku.pro_sbomList!=null&&sku.pro_sbomList!=""&&sku.pro_sbomList.length>0&&ec.product.inventory.haveInventory(sku.id)){var newpackageListHtml=[];var pro_sbomList=sku.pro_sbomList;for(var s=0;s<pro_sbomList.length;s++)if(sku.code==pro_sbomList[s].sbomCode){var new_packageList=pro_sbomList[s].sbomPackageList;if(new_packageList!=null&&new_packageList!=""&&new_packageList.length>0){ec.product.hidebundleView();newpackageListHtml.push('\x3cdl class\x3d"product-choose clearfix" id\x3d"package_dl"\x3e\x3clabel\x3e\u9009\u62e9\u5957\u9910\x3c/label\x3e\x3cdiv class\x3d"product-choose-detail relative" id \x3d "packageSelect"\x3e\x3cul\x3e');newpackageListHtml.push('\x3cli class\x3d"selected" data-attrname\x3d"\u5355\u54c1"\x3e');newpackageListHtml.push('\x3cdiv class\x3d"sku"\x3e');newpackageListHtml.push('\x3ca href\x3d"javascript:;" title\x3d"\u5355\u54c1" onclick\x3d"ec.product.newpackageView(this,null,\''+ec.encodeForJS(sku.code)+"')\"\x3e\x3cp\x3e\x3cspan\x3e\u5355\u54c1\x3c/span\x3e\x3c/p\x3e\x3c/a\x3e\x3c/div\x3e\x3c/li\x3e");for(var p=0;p<new_packageList.length;p++){var packageList=new_packageList[p].packageList;newpackageListHtml.push('\x3cli class\x3d"" data-attrname\x3d"'+new_packageList[p].name+'"\x3e');newpackageListHtml.push('\x3cdiv class\x3d"sku"\x3e\x3ca href\x3d"javascript:;" attr-package\x3d'+new_packageList[p].packageCode+' title\x3d"'+new_packageList[p].name+'" onclick\x3d"ec.product.newpackageView(this,\''+ec.encodeForJS(new_packageList[p].packageCode)+"','"+ec.encodeForJS(sku.code)+"')\"\x3e\x3cp\x3e\x3cspan attr-package\x3d"+new_packageList[p].packageCode+"\x3e"+new_packageList[p].name+"\x3c/span\x3e\x3c/p\x3e\x3c/a\x3e\x3c/div\x3e\x3c/li\x3e")}newpackageListHtml.push('\x3c/ul\x3e\x3cdiv id\x3d"packageList"\x3e\x3c/div\x3e\x3c/dl\x3e')}else $("#bundlePackage").removeClass("hide")}if($("#bundlePackage").length>0)$("#bundlePackage").after(newpackageListHtml.join(""));else $("#pro-skus").after(newpackageListHtml.join(""))}else $("#packageList").html("")});if(sku.giftBuyLstX.length>0){var giftBuyHtml=[];giftBuyHtml.push('\x3cdl class\x3d"product-choose clearfix" id\x3d"giftBuy_dl"\x3e\x3clabel\x3e\u589e\u503c\u4e1a\u52a1\x3c/label\x3e\x3cdiv class\x3d"product-choose-detail"\x3e\x3cul\x3e');giftBuyHtml.push('\x3cli class\x3d"selected" data-attrname\x3d"\u65e0\u589e\u503c\u670d\u52a1"\x3e');giftBuyHtml.push('\x3ca href\x3d"javascript:;" title\x3d"\u65e0\u589e\u503c\u670d\u52a1"\x3e\x3cp\x3e\x3cspan\x3e\u65e0\u589e\u503c\u670d\u52a1\x3c/span\x3e\x3c/p\x3e\x3c/a\x3e\x3c/li\x3e');for(var o=0;o<sku.giftBuyLstX.length;o++){var giftSku=sku.giftBuyLstX[o];giftBuyHtml.push('\x3cli class\x3d"'+(giftSku.hasInv=="false"||hasSelectCustomize?"disabled":"")+'" data-skuid\x3d"'+giftSku.id+'"\x3e');giftBuyHtml.push('\x3ca href\x3d"javascript:;" title\x3d"'+giftSku.name+'" data-code\x3d"'+giftSku.sbomCode+'"interest-price\x3d"'+giftSku.price+'" data-pid\x3d"'+giftSku.productId+'"\x3e\x3cp\x3e\x3cspan\x3e'+giftSku.name+"\x3c/span\x3e\x3c/p\x3e\x3c/a\x3e\x3c/li\x3e")}giftBuyHtml.push('\x3ca href\x3d"javascript:;" target\x3d"_blank" class\x3d"btn-product-more hidden" id\x3d"gift-service-detail-link"\x3e\x3cspan\x3e\u4e86\u89e3\u8be6\u60c5\x3c/span\x3e\x26gt;\x3c/a\x3e');giftBuyHtml.push("\x3c/ul\x3e\x3c/div\x3e\x3c/dl\x3e");if($("#conRelItemList").length>0)$("#conRelItemList").after(giftBuyHtml.join(""));else $("#contractLst").after(giftBuyHtml.join(""));var proSelectGiftService=[];proSelectGiftService.push('\x3cdiv id\x3d"giftBuy-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;\u65e0\u589e\u503c\u670d\u52a1\x3c/div\x3e');var originVal=$("#pro-select-sku").html();$("#pro-select-sku").html(originVal+proSelectGiftService.join(""));ec.product.hasRemovedCartButton=false;$("#giftBuy_dl li").find("a").each(function(){if($(this).parent().hasClass("disabled"))return;$(this).click(function(){$(this).parent().addClass("selected").siblings().removeClass("selected");var giftBuySbomCode=$(this).attr("data-code");if($("#pro-select-gift-service")!=undefined)$("#pro-select-gift-service").remove();if(giftBuySbomCode!=undefined&&giftBuySbomCode.length>0){ec.diypkg.hide();_giftBuyItemId=[];_giftBuyItemId.push(giftBuySbomCode);pushProGiftBuySerMsg();$("#gift-service-detail-link").attr("href","/product/"+$(this).attr("data-pid")+".html");$("#gift-service-detail-link").show();$("#giftBuy-selected").remove();var proSelectGiftService=[];proSelectGiftService.push('\x3cdiv id\x3d"giftBuy-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;'+ec.autoEncodeAttr($(this).attr("title"))+"\x3c/div\x3e");var originVal=$("#pro-select-sku").html();$("#pro-select-sku").html(originVal+proSelectGiftService.join(""));if($("#pro-operation").find("a").length==2&&$("#pro-operation").find("a").first().find("span").html()=="\u52a0\u5165\u8d2d\u7269\u8f66"&&!$("#pro-operation").find("a").first().hasClass("disabled")){$("#pro-operation").find("a").first().remove();$("#pro-operation").attr("data-gift",2);ec.product.hasRemovedCartButton=true}}else{ec.product.inventory.wait(function(){ec.diypkg.render()});_giftBuyItemId=[];$("#gift-service-detail-link").attr("href","");$("#gift-service-detail-link").hide();$("#pro-operation").attr("data-gift",0);if($("#pro-operation").find("a").length==1&&!$("#pro-operation").find("a").hasClass("disabled")&&ec.product.hasRemovedCartButton){$("#pro-operation").find("a").before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01"\x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e');ec.product.hasRemovedCartButton=false}if($("#pro-select-gift-service")!=undefined)$("#pro-select-gift-service").remove();$("#giftBuy-selected").remove();var proSelectGiftService=[];proSelectGiftService.push('\x3cdiv id\x3d"giftBuy-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;\u65e0\u589e\u503c\u670d\u52a1'+"\x3c/div\x3e");var originVal=$("#pro-select-sku").html();$("#pro-select-sku").html(originVal+proSelectGiftService.join(""))}ec.product.interest.queryFreeDetail()})})}else if($("#giftBuy_dl")!=undefined)$("#giftBuy_dl").remove();if(sku.prolongLst.length>0){var lst;html=[];var ExtendedProtectProductId=[];var accidentProtectProductId=[];var ExtendedProtectName=[],ExtendedProtectBrifeName=[];var ExtendedProtectId=[];var ExtendedProtectNum=0;var ExtendedOption;var accidentProtectName=[],accidentProtectBrifeName=[];var accidentProtectId=[];var exetendedPrice=[],accidentPrice=[],exetendedOrderPrice=[],accidentOrderPrice=[];var accidentProtectsNum=0;var uCareList=[];var extendedProtectCode=[];var accidentProtectCode=[];for(var i=0;i<sku.prolongLst.length;i+=1){lst=sku.prolongLst[i];if(lst.serviceType==1){ExtendedProtectName[ExtendedProtectNum]=lst.name;ExtendedProtectId[ExtendedProtectNum]=lst.id;extendedProtectCode[ExtendedProtectNum]=lst.sbomCode;ExtendedProtectProductId[ExtendedProtectNum]=lst.productId;ExtendedProtectBrifeName[ExtendedProtectNum]=lst.brifeName;exetendedPrice[ExtendedProtectNum]=lst.price;exetendedOrderPrice[ExtendedProtectNum]=lst.orderPrice;ExtendedProtectNum+=1}if(lst.serviceType==2){accidentProtectName[accidentProtectsNum]=lst.name;accidentProtectId[accidentProtectsNum]=lst.id;accidentProtectCode[accidentProtectsNum]=lst.sbomCode;accidentProtectProductId[accidentProtectsNum]=lst.productId;accidentProtectBrifeName[accidentProtectsNum]=lst.brifeName;accidentPrice[accidentProtectsNum]=lst.price;accidentOrderPrice[accidentProtectsNum]=lst.orderPrice;accidentProtectsNum+=1}if(lst.serviceType==0)uCareList.push(lst)}$("#extendProtected").find("ul").html("");$("#accidentProtected").find("ul").html("");$("#pro-service").hide();$("#extendSelect").attr("skuid","");$("#extendSelect").attr("data-scode","");$("#extendSelect").attr("interest-price","");$("#accidentSelect").attr("skuid","");$("#accidentSelect").attr("data-scode","");$("#accidentSelect").attr("interest-price","");$("#extendSelect").html("");$("#accidentSelect").html("");$(".product-operation-main").css("min-height","49px");if(ExtendedProtectNum>0||accidentProtectsNum>0||uCareList.length>0)$("#pro-service").show();else $("#pro-service").hide();if(ExtendedProtectNum>0){$("#extendProtected").parent().parent().show();for(var i=0;i<ExtendedProtectNum;i++){if(exetendedPrice[i]<exetendedOrderPrice[i]){var tempEShow='\x26nbsp;\x3cs class\x3d"fl"\x3e\uffe5'+exetendedOrderPrice[i]+"\x3c/s\x3e";var tempEShow1='\x3cem class\x3d"product-service-icon"\x3e\u4f18\u60e0\x3c/em\x3e'}else{var tempEShow="";var tempEShow1=""}ExtendedOption=$('\x3cli\x3e\x3cdiv class\x3d"fl" onclick\x3d"checkedThis(this,\''+ec.encodeForJS(extendedProtectCode[i])+"','extendedName','extendProtected');\"\x3e\x3cinput type\x3d\"checkbox\" name\x3d\"extendedName\"\x3e"+'\x3cdiv id\x3d"'+extendedProtectCode[i]+'" class\x3d"product-service-listcon" title\x3d"'+ec.autoEncodeAttr(ExtendedProtectBrifeName[i])+'"  skuID\x3d"'+ExtendedProtectId[i]+'"data-scode\x3d"'+extendedProtectCode[i]+'"data-price\x3d"'+exetendedPrice[i]+'"\x3e'+tempEShow1+'\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(ExtendedProtectBrifeName[i])+'\x3c/span\x3e\x3cp class\x3d"f1"\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+exetendedPrice[i]+"\x3c/span\x3e"+tempEShow+'\x3ca target\x3d"_blank" href\x3d"/product/'+ExtendedProtectProductId[i]+'.html"\x3e\u8be6\u60c5\x26nbsp;\x26gt;\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e'+"\x3c/div\x3e\x3c/li\x3e");ExtendedOption.appendTo($("#extendProtected").find("ul"))}var selectExtendName='\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(ExtendedProtectBrifeName[0])+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+exetendedPrice[0]+"\x3c/span\x3e";$("#extendProtected").parent().before('\x3ca href\x3d"javascript:;"  onclick\x3d"ec.product.click_function(this)"  class\x3d"product-service-btn"\x3e'+selectExtendName+"\x3c/a\x3e")}else $("#extendProtected").parent().parent().hide();if(accidentProtectsNum>0){$("#accidentProtected").parent().parent().show();for(var i=0;i<accidentProtectsNum;i++){if(accidentPrice[i]<accidentOrderPrice[i]){var tempAShow='\x26nbsp;\x3cs class\x3d"fl"\x3e\uffe5'+accidentOrderPrice[i]+"\x3c/s\x3e";var tempAShow1='\x3cem class\x3d"product-service-icon"\x3e\u4f18\u60e0\x3c/em\x3e'}else{var tempAShow="";var tempAShow1=""}var accidentOption=$('\x3cli\x3e\x3cdiv class\x3d"fl" onclick\x3d"checkedThis(this,\''+ec.encodeForJS(accidentProtectCode[i])+"','accidentName','accidentProtected');\"\x3e\x3cinput type\x3d\"checkbox\" name\x3d\"accidentName\" \x3e"+'\x3cdiv id\x3d"'+accidentProtectCode[i]+'" class\x3d"product-service-listcon" title\x3d"'+ec.autoEncodeAttr(accidentProtectBrifeName[i])+'"  skuID\x3d"'+accidentProtectId[i]+'" data-scode\x3d"'+accidentProtectCode[i]+'"data-price\x3d"'+accidentPrice[i]+'"\x3e'+tempAShow1+'\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(accidentProtectBrifeName[i])+'\x3c/span\x3e\x3cp class\x3d"fl"\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+accidentPrice[i]+"\x3c/span\x3e"+tempAShow+'\x3ca target\x3d"_blank" href\x3d"/product/'+accidentProtectProductId[i]+'.html"\x3e\u8be6\u60c5\x26nbsp;\x26gt;\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e'+"\x3c/div\x3e\x3c/li\x3e");accidentOption.appendTo($("#accidentProtected").find("ul"))}var selectAccidentName='\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(accidentProtectBrifeName[0])+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+accidentPrice[0]+"\x3c/span\x3e";$("#accidentProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+selectAccidentName+"\x3c/a\x3e")}else $("#accidentProtected").parent().parent().hide();if(uCareList.length>0){$("#ucareProtected").find("ul").html("");$("#j-ucare").show();for(var i=0;i<uCareList.length;i++){if(uCareList[i].price<uCareList[i].orderPrice){var tempAShow='\x26nbsp;\x3cs class\x3d"fl"\x3e\uffe5'+uCareList[i].orderPrice+"\x3c/s\x3e";var tempAShow1='\x3cem class\x3d"product-service-icon"\x3e\u4f18\u60e0\x3c/em\x3e'}else{var tempAShow="";var tempAShow1=""}var accidentOption=$('\x3cli\x3e\x3cdiv class\x3d"fl" onclick\x3d"checkedThis(this,\''+ec.encodeForJS(uCareList[i].sbomCode)+"','ucareName','ucareProtected');\"\x3e\x3cinput type\x3d\"checkbox\" name\x3d\"ucareName\" \x3e"+'\x3cdiv id\x3d"'+uCareList[i].sbomCode+'" class\x3d"product-service-listcon" title\x3d"'+ec.autoEncodeAttr(uCareList[i].brifeName)+'"  skuID\x3d"'+uCareList[i].id+'" data-scode\x3d"'+uCareList[i].sbomCode+'"data-price\x3d"'+uCareList[i].price+'"\x3e'+tempAShow1+'\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(uCareList[i].brifeName)+'\x3c/span\x3e\x3cp class\x3d"fl"\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+uCareList[i].price+"\x3c/span\x3e"+tempAShow+'\x3ca target\x3d"_blank" href\x3d"/product/'+uCareList[i].productId+'.html"\x3e\u8be6\u60c5\x26nbsp;\x26gt;\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e'+"\x3c/div\x3e\x3c/li\x3e");accidentOption.appendTo($("#ucareProtected").find("ul"))}var selectAccidentName='\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(uCareList[0].brifeName)+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+uCareList[0].price+"\x3c/span\x3e";$("#ucareProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+selectAccidentName+"\x3c/a\x3e");$("#j-ucare").mouseover(function(){$("#j-ucare").addClass("hover")}).mouseout(function(){$("#j-ucare").removeClass("hover")})}else $("#j-ucare").hide()}else{$("#pro-service").hide();$("#extendSelect").attr("skuid","");$("#extendSelect").attr("data-scode","");$("#extendSelect").attr("interest-price","");$("#accidentSelect").attr("skuid","");$("#accidentSelect").attr("data-scode","");$("#accidentSelect").attr("interest-price","");$("#extendSelect").html("");$("#accidentSelect").html("");$("#extendProtected ul").each(function(index){$(this).html("")});$("#accidentProtected ul").each(function(index){$(this).html("")})}ec.product.showSbomInterest(sku);_updateSelect();$("#integral").html(sku.integral);ec.product.renderGroup(_preSku);var sku=ec.product.getSkuInfo(ec.product.getSku());if(ec.product.productType==4&&parseInt(sku.buttonMode)!=22)ec.product.depositActivity(ec.product.getSku());else if(parseInt(sku.buttonMode)==22)ec.product.depositNewActivity(ec.product.getSku());else{$("#goAddressId").hide();$("#buyProcessIDD").hide();ec.product.depositInfoNew={};ec.product.depositInfo={};if($("#product-deposit-agreement-area"))$("#product-deposit-agreement-area").hide();$("#buyProcessIDD").hide();$("#pro-price-label-deposit").html("");$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("");$("#pro-price-deposit").show();$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();if($("#pro-global-parameter").attr("data-skulist-rushbuy"))ec.product.rushbuyActivity()}packFlag=false;upDownButton="";ec.product.getFeature(sku.id);ec.product.getParameter(sku.id,sku.code);ec.product.getPackageAndService(sku.id);ec.product.switchSku();$(".product-tab-btn").css({"display":"none"});if($("#packageCode").val()!="")ec.product.hiddenTips();else ec.product.processSupportDisplayDilieryTime(sku);ec.product.queryPointWeight(ec.product.setSkuId||ec.product.defaultSku);var couponList=ec.product.coupon.sbomCouponList[sku.code];if(couponList||couponList==""){$("#couponBtn").show();$("#couponTag").html("");if(couponList!=""){var couponTagHtml=[];if(couponList.length>3)for(var i=0;i<couponList.length;i++){if(i<3)if(couponList[i].couponTag!=null)couponTagHtml.push("\x3cspan onclick\x3d\"ec.product.coupon.clickBtn('"+ec.encodeForJS(sku.code)+'\')" class\x3d"product-ticket"\x3e'+couponList[i].couponTag+"\x3c/span\x3e");if(i>=3)break}else for(var i=0;i<couponList.length;i++)if(couponList[i].couponTag!=null)couponTagHtml.push("\x3cspan onclick\x3d\"ec.product.coupon.clickBtn('"+ec.encodeForJS(sku.code)+'\')" class\x3d"product-ticket"\x3e'+couponList[i].couponTag+"\x3c/span\x3e");couponTagHtml.push(' \x3ca href\x3d"javascript:;" id\x3d"immediatelyReceiveID" class\x3d"product-ticket-link" onclick\x3d"ec.product.coupon.clickBtn(\''+ec.encodeForJS(sku.code)+"')\"\x3e\u7acb\u5373\u9886\u53d6\x26nbsp;\x26gt;\x3c/a\x3e");$("#couponTag").html(couponTagHtml.join(" "))}else $("#couponBtn").hide()}else ec.product.coupon.loadCoupon(sku.code);$("#product-prom-all").on("mouseenter",function(){$(".product-prom").addClass("show");$("#promBtn").css("display","none");$(".product-prom-item").hide();$(".product-prom-item").show();if(!isShowGifts)$("#pro-match-gift").hide();$("#promBtn").hide()}).on("mouseleave",function(){if(isShowGifts){if($("#product-prom-all").children().length<5)return}else if($("#product-prom-all").children().length<6)return;$(".product-prom").removeClass("show");$("#promBtn").css("display","block");$(".product-prom .product-prom-item").hide();if(isShowGifts){for(var i=0;i<3;i++)$(".product-prom-item").eq(i).show();$("#promBtn").show();for(var i=0;i<2;i++)$("#promBtn em").eq(i).hide()}else{for(var i=1;i<4;i++)$(".product-prom-item").eq(i).show();$("#promBtn").show();for(var i=0;i<3;i++)$("#promBtn em").eq(i).hide()}})};ec.product.tabSkuInfo=function(skuId){$("#pro-tab-feature-content-"+skuId+", #pro-tab-feature-content2-"+skuId+", #pro-tab-parameter-content-"+skuId+", #pro-tab-package-content-"+skuId+", #pro-tab-service-content-"+skuId).show().siblings().hide();var sku=ec.product.getSkuInfo(skuId);var price=parseFloat(sku.price);$("#combList-list-"+skuId).show().siblings().hide();if(!$("#combList-list-"+skuId).children().eq(0).hasClass("current"))$("#combList-list-"+skuId).children().eq(0).addClass("current").siblings().removeClass("current")};ec.product.addSkuAttr=function(skuId,attrTypeId,attrName,attrId,attrValue){var sku=_skuMap[skuId];if(!sku)_skuMap[skuId]={attrIds:[attrId]};else sku.attrIds.push(attrId);_skuAttrId2SkuMap[attrId]=skuId;var attrV=_skuAttrVallue[attrName];if(!attrV){_skuAttrName.push(attrName);_skuAttrTypeID.push(attrTypeId);_skuAttrVallue[attrName]=[attrValue]}else if(attrV.indexOf(attrValue)==-1)attrV.push(attrValue);var ids=_skuAttrType2ValueIds[attrTypeId+"-"+attrValue];if(!ids)_skuAttrType2ValueIds[attrTypeId+"-"+attrValue]=[attrId];else ids.push(attrId);if(!_attrValue2SkuId[attrValue])_attrValue2SkuId[attrValue]=[];_attrValue2SkuId[attrValue].push(skuId)};ec.product.setSku=function(skuId,options){options=options||{};options.id=skuId;$.extend(_skuMap[skuId]||(_skuMap[skuId]={}),options)};ec.product.getAllSku=function(){return _skuMap};ec.product.getSku=function(){var sku;$.each(_selectAttrMap,function(){if(!sku){sku=this;return}var _t=this,newSku=[];for(var i=0;i<sku.length;i++)for(var j=0;j<_t.length;j++)if(sku[i]==_t[j])newSku.push(sku[i]);sku=newSku});if(!sku||sku.length!=1)return _preSku||ec.product.defaultSku;return sku[0]};ec.product.getSkuInfo=function(skuId){return _skuMap[skuId]};ec.product.setSkuForParement=function(skuId){_skuForGetParement[skuId]=skuId};ec.product.getSkuForParement=function(skuId){return _skuForGetParement[skuId]};ec.product.setSkuForFeature=function(skuId){_skuForGetFeature[skuId]=skuId};ec.product.getSkuForFeature=function(skuId){return _skuForGetFeature[skuId]};ec.product.setSkuShowType=function(attrTypeId,showType){_skuShowType[attrTypeId]=showType};ec.product.setSkuPriority=function(skuId){_skuPriority[skuId]=true};ec.product.getSkuPriority=function(skuId){return _skuPriority[skuId]};ec.product.selectBySku=function(skuId){var sku=_skuMap[skuId];if(!sku||!sku.attrIds){_upadteSkuPrice(sku);if(ec.product.productType==4)ec.product.depositActivity(skuId);else{$("#goAddressId").hide();if($("#pro-global-parameter").attr("data-skulist-rushbuy"))ec.product.rushbuyActivity()}ec.product.showPosters();ec.product.refreshStyle();return}$("#pro-skus").find(".attr"+sku.attrIds.join(",.attr")).children(".sku").trigger("click")};ec.product.queryPointWeight=function(skuId){var sku=_skuMap[skuId];if(sku||sku.code){if(ec.product.productType==1||ec.product.productType==2||ec.product.productType==5||ec.product.productType==6)return;if(ec.product.seCode!="VMALL-HUAWEIDEVICE")return;if(ec.product.getSkuPointWeight(sku.code)!=undefined){$("#promBtn p").append(ec.product.getSkuPointWeightDetail(sku.code));var htmlproBtn=[];htmlproBtn.push('\x3cdiv class\x3d"product-prom-item clearfix relative" id\x3d"promBtn"\x3e');htmlproBtn.push($("#promBtn").html());htmlproBtn.push("\x3c/div\x3e");$("#promBtn").remove();$(".product-prom").append(ec.product.getSkuPointWeight(sku.code));$(".product-prom .product-prom-item").hide();if($("#pro-gift-list-select").find("a").length>0&&isShowGifts)if($("#product-prom-all").children().length>4){for(var i=0;i<3;i++)$(".product-prom-item").eq(i).show();$(".product-prom").append(htmlproBtn.join(""));$("#promBtn").show();for(var i=0;i<2;i++)$("#promBtn em").eq(i).hide()}else $(".product-prom .product-prom-item").show();else if($("#product-prom-all").children().length>5){for(var i=1;i<4;i++)$(".product-prom-item").eq(i).show();$(".product-prom").append(htmlproBtn.join(""));$("#promBtn").show();for(var i=0;i<3;i++)$("#promBtn em").eq(i).hide()}else $(".product-prom .product-prom-item").show();if($(".product-prom").parent().hasClass("hide")||$(".product-prom").parent().css("display")=="none"){$(".product-prom").parent().removeClass("hide");$(".product-prom").parent().css("display","")}if(!$("#pro-gift-list-select").find("a").length>0||!isShowGifts)$("#pro-match-gift").hide();if($("#pro-promotions-list").parent().parent().hasClass("hide"))$("#pro-promotions-list").parent().parent().removeClass("hide");ec.product.refreshStyle()}else $.ajax({url:openApiDomain+"/point/queryPointWeight.json?skuCodes\x3d["+sku.code+"]",dataType:"json",timeout:1E4,beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){var pointWeight=1;if(json.resultCode=="200000"){json.pointWeightMap=json.data;if(json.pointWeightMap!=null)for(var k in json.pointWeightMap)if(json.pointWeightMap[k]!=null)pointWeight=json.pointWeightMap[k]}var html=[],htmldetail=[];if(pointWeight==0)return;else if(pointWeight==1){htmldetail.push('\x3cem class\x3d"tag"\x3e\u8d60\u9001\u79ef\u5206\x3c/em\x3e');html.push('\x3cdiv class\x3d"product-prom-item clearfix" \x3e');html.push('\x3cem class\x3d"tag"\x3e\u8d60\u9001\u79ef\u5206\x3c/em\x3e');html.push('\x3cdiv class\x3d"product-prom-con"\x3e');html.push("\u8d2d\u4e70\u5373\u8d60\u5546\u57ce\u79ef\u5206\uff0c\u79ef\u5206\u53ef\u62b5\u73b0~");html.push("\x3c/div\x3e");html.push("\x3c/div\x3e")}else if(pointWeight>1){htmldetail.push('\x3cem class\x3d"tag"\x3e\u79ef\u5206\u7ffb\u500d\x3c/em\x3e');html.push('\x3cdiv class\x3d"product-prom-item clearfix" \x3e');html.push('\x3cem class\x3d"tag"\x3e\u79ef\u5206\u7ffb\u500d\x3c/em\x3e');html.push('\x3cdiv class\x3d"product-prom-con"\x3e');html.push("\u6d3b\u52a8\u8d60\u9001\u7ffb\u500d\u79ef\u5206\uff0c\u79ef\u5206\u53ef\u62b5\u73b0~");html.push("\x3c/div\x3e");html.push("\x3c/div\x3e")}$("#promBtn p").append(htmldetail.join(""));var htmlproBtn=[];htmlproBtn.push('\x3cdiv class\x3d"product-prom-item clearfix relative" id\x3d"promBtn"\x3e');htmlproBtn.push($("#promBtn").html());htmlproBtn.push("\x3c/div\x3e");$("#promBtn").remove();$(".product-prom").append(html.join(""));$(".product-prom .product-prom-item").hide();if($("#pro-gift-list-select").find("a").length>0&&isShowGifts)if($("#product-prom-all").children().length>4){for(var i=0;i<3;i++)$(".product-prom-item").eq(i).show();$(".product-prom").append(htmlproBtn.join(""));$("#promBtn").show();for(var i=0;i<2;i++)$("#promBtn em").eq(i).hide()}else $(".product-prom .product-prom-item").show();else if($("#product-prom-all").children().length>5){for(var i=1;i<4;i++)$(".product-prom-item").eq(i).show();$(".product-prom").append(htmlproBtn.join(""));$("#promBtn").show();for(var i=0;i<3;i++)$("#promBtn em").eq(i).hide()}else $(".product-prom .product-prom-item").show();if($(".product-prom").parent().hasClass("hide")||$(".product-prom").parent().css("display")=="none"){$(".product-prom").parent().removeClass("hide");$(".product-prom").parent().css("display","")}if(!$("#pro-gift-list-select").find("a").length>0||!isShowGifts)$("#pro-match-gift").hide();ec.product.setSkuPointWeight(sku.code,html.join(" "));ec.product.setSkuPointWeightDetail(sku.code,htmldetail.join(" "));ec.product.refreshStyle()}})}};ec.product.refreshStyle=function(){var buyBox=$(".product-operation-main");var buyBoxHeight=buyBox.height();$(".product-property").css("min-height",536-buyBoxHeight+"px").css("height","auto").css("padding-bottom",buyBoxHeight+30+"px");$(".product-operation-main").removeClass("product-operation-location").addClass("product-operation-location");function runRefreshStyle(){ec.product.refreshStyle()}$(".product-choose li").unbind("click").click(runRefreshStyle);$(".product-service-detail input").unbind("change").change(runRefreshStyle)};ec.ready(function(){ec.product.hiddenTips();$(".product-tab-btn").css({"display":"none"});var html=[],attrTypeId,attrName,attrValueIds,showText;for(var i=0;i<_skuAttrName.length;i++){attrTypeId=_skuAttrTypeID[i];showText=_skuShowType[attrTypeId]=="2";attrName=_skuAttrName[i];var hml='\x3cdl class\x3d"product-choose clearfix ';if(showText)if(attrName.transHtmlAttribute()=="\u5957\u9910"||attrName.transHtmlAttribute()=="\u7c7b\u578b")hml+='" id \x3d "bundlePackage" \x3e';else hml+='"\x3e';else if(attrName.transHtmlAttribute()=="\u5957\u9910"||attrName.transHtmlAttribute()=="\u7c7b\u578b")hml+=' product-choosepic" id \x3d "bundlePackage" \x3e';else hml+=' product-choosepic"\x3e';hml+="\x3clabel\x3e\u9009\u62e9"+attrName+'\x3c/label\x3e\x3cdiv class\x3d"product-choose-detail ';if(attrName.transHtmlAttribute()=="\u5957\u9910"||attrName.transHtmlAttribute()=="\u7c7b\u578b")hml+=' relative" id \x3d "bundlePackageSelect" \x3e';else hml+='"\x3e';hml+="\x3cul\x3e";html.push(hml);var values=_skuAttrVallue[attrName];for(var j=0;j<values.length;j++){attrValueIds=_skuAttrType2ValueIds[attrTypeId+"-"+values[j]];html.push('\x3cli class\x3d" attr'+attrValueIds.join(" attr")+'" data-attrName\x3d"'+attrName+'" data-attrCode\x3d"'+attrTypeId+'" data-attrId\x3d"'+attrValueIds.join(",")+'" data-skuId\x3d"'+_attrValue2SkuId[values[j]].join(",")+'"\x3e\x3cdiv class\x3d"sku"\x3e\x3ca  href\x3d"javascript:;" title\x3d"'+values[j]+'"\x3e');if(showText){html.push("\x3cp\x3e\x3cspan\x3e");html.push(values[j]);html.push("\x3c/span\x3e\x3c/p\x3e\x3c/a\x3e")}else{var sku=_skuMap[_skuAttrId2SkuMap[attrValueIds[0]]];html.push('\x3cimg src\x3d"'+ec.mediaPath+sku.photoPath+"40_40_"+sku.photoName+'" alt\x3d"'+values[j]+'"/\x3e');html.push("\x3cp\x3e\x3cspan\x3e"+values[j]+"\x3c/span\x3e\x3c/p\x3e\x3c/a\x3e")}}html.push("\x3c/ol\x3e\x3c/dd\x3e\x3c/dl\x3e")}var skuObj=$(html.join(""));var _checkDisabledSkuAttrValue=function(prevPrdSkuIds,nextAttrSkuDom){var _strPrdSkuIds=nextAttrSkuDom.attr("data-skuId");if(nextAttrSkuDom.parents("#packageSelect").length>0)return true;if(nextAttrSkuDom.parents("#giftPackageList").length>0)return true;var result=false;for(var i=0,length=prevPrdSkuIds.length;i<length;i++)if(_strPrdSkuIds.indexOf(prevPrdSkuIds[i]+"")>-1){result=true;break}return result};var _listenerAttrSkuTrigger=function(skuObj){var _interSectionPrdList=[];var _first=true;var _skuId=null;$.each(skuObj.find("li.selected").not($("#package_dl").find("li.selected")),function(){var $li=$(this);var key=$li.find("a").attr("title");var skey=ec.autoEncodeAttr(key);var nextAttrSkuDom;if($li.closest("dl").next().attr("id")=="package_dl")nextAttrSkuDom=$li.closest("dl").next().next().find("li").not($("#giftPackageList").find("li"));else nextAttrSkuDom=$li.closest("dl").next().find("li").not($("#giftPackageList").find("li"));if(_first){_interSectionPrdList=_attrValue2SkuId[key]||_attrValue2SkuId[skey];$.each(nextAttrSkuDom,function(){var current=$(this);if(!_checkDisabledSkuAttrValue(_interSectionPrdList,current))current.addClass("disabled").removeClass("selected");else current.removeClass("disabled")});_first=false;_skuId=_preSku||ec.product.defaultSku;return}var _arrTempSkuIds=[];var _tempList=_attrValue2SkuId[key]||_attrValue2SkuId[skey];for(var i=0;i<_interSectionPrdList.length;i++)for(var j=0;j<_tempList.length;j++)if(_interSectionPrdList[i]==_tempList[j])_arrTempSkuIds.push(_interSectionPrdList[i]);_interSectionPrdList=_arrTempSkuIds;if(_interSectionPrdList.length!=1){_skuId=_preSku||ec.product.defaultSku;if(_interSectionPrdList.length>1)$.each(nextAttrSkuDom,function(){var current=$(this);if(!_checkDisabledSkuAttrValue(_interSectionPrdList,current))current.addClass("disabled").removeClass("selected");else current.removeClass("disabled")})}else{$.each(nextAttrSkuDom,function(){var current=$(this);if(!_checkDisabledSkuAttrValue(_interSectionPrdList,current))current.addClass("disabled").removeClass("selected");else current.removeClass("disabled")});_skuId=_interSectionPrdList[0]}});return _skuId};skuObj.find(".sku").click(function(){var thix=$(this).parent();if(thix.hasClass("disabled"))return false;var attrIds=thix.attr("data-attrId").split(","),attrName=thix.attr("data-attrName"),skuIds=[];for(var i=0;i<attrIds.length;i++)skuIds.push(_skuAttrId2SkuMap[attrIds[i]]);_selectAttrMap[attrName]=skuIds;thix.addClass("selected").siblings().removeClass("selected");$("#layoutRelative p a").each(function(){var tab=$(this).css("display");if(tab!="none"){$(this).addClass("selected").siblings().removeClass("selected");return false}});var _skuId=_listenerAttrSkuTrigger(skuObj);var firstLi=null;var interestAllow="";var flag=true;$.each(skuObj.find("ul"),function(){var $ol=$(this);if($ol.parents("#giftPackageList").length>0)return true;if($ol.parents("#packageList").length>0)return true;if(1!=$ol.find("li.selected").length){firstLi=$ol.find("li").not($ol.find("li.disabled")).first();if(firstLi.length>=1){flag=false;return false}}if($ol.parents("#giftBuy_dl").text()=="\u589e\u503c\u4e1a\u52a1")ec.product.interest.queryFreeDetail()});if(flag){sku=_skuMap[_skuId];_updateSkuInfo();_updateSelect();isFirstIn=false;ec.product.refreshStyle();ec.product.gift.showGiftPackageView($("#bundlePackageSelect").find("li.selected").find("a"),true)}else if(firstLi)if(!isFirstIn)$(firstLi).find(".sku").trigger("click")});if($(".hot-area").find("li").size()==0){$(".hot-area").hide();$("#pro-seg-hot").hide()}$("#pro-skus").html(skuObj);var giftShowHtml=[];giftShowHtml.push('\x3cdiv id\x3d"giftPackageList" class\x3d"hide"\x3e\x3c/div\x3e');$("#bundlePackageSelect").append(giftShowHtml.join(""));html=[],skuId=ec.product.getSku();sku=ec.product.getSkuInfo(skuId);if(ec.product.seCode!=ec.product.productSeCode)html.push("\u5df2\u5305\u90ae\x3cem\x3e\x3c/em\x3e"+ec.product.productshopName+"\u53d1\u8d27\uff0c\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1");else{if(parseFloat(ec.product.deliveryModeValueFreeBase)>0&&ec.product.productType==0)if(sku.priceMode!=2)if(parseFloat(sku.price)>=parseFloat(ec.product.deliveryModeValueFreeBase))html.push("\u5df2\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5df2\u514d\u8fd0\u8d39\x3cem\x3e\x3c/em\x3e");else html.push("\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5373\u514d\u8fd0\u8d39\uff0c\u5feb\u53bb\u51d1\u5355\u5427\x3cem\x3e\x3c/em\x3e");html.push("\u7531\u534e\u4e3a\u5546\u57ce\u8d1f\u8d23\u53d1\u8d27\uff0c\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1")}$("#service-description").html(html.join(" "));if(skuObj.find(".sku").length==0){var sku=ec.product.getSku();packFlag=false;sku=ec.product.getSkuInfo(sku);upDownButton="";ec.product.getFeature(sku.id);ec.product.getParameter(sku.id,sku.code);ec.product.getPackageAndService(sku.id);ec.product.processSupportDisplayDilieryTime(sku)}ec.product.selectBySku(ec.product.setSkuId||ec.product.defaultSku);var skuIdForGift=ec.product.setSkuId||ec.product.defaultSku,skuForPromotion,showPromotion=false,showGifts=false;skuForPromotion=ec.product.getSkuInfo(skuIdForGift);if(!skuForPromotion.promotionLst||skuForPromotion.promotionLst.length==0)showPromotion=false;else showPromotion=true;if(!skuForPromotion.giftList||skuForPromotion.giftList.length==0)showGifts=false;else{isShowGifts=false;for(var i=0;i<skuForPromotion.giftList.length;i++)if(sku.giftList[i].displayType==1){isShowGifts=true;break}}if(!showPromotion){$("#pro-promotions-list").html("");$("#pro-promotions-list").hide()}if(showGifts){$("#product-info-list-new").show();$("#pro-match-gift").show();$("#pro-gift-list-select").html(ec.product.gift.ftl(ec.product.getSku()))}else{if($("#product-prom-all").find("product-prom-item").length=1)if($("#product-prom-all").find("product-prom-item").attr("id")=="pro-match-gift")$("#product-info-list-new").hide();$("#pro-gift").hide()}$("#pro-gallerys").find("img").mouseover(_proGallerysMouseOver);var paras=getUrlParaMap4CartBinding();var isSuccess=paras["isSuccess"];if(null!=isSuccess&&"0"==isSuccess)bindCartResult("ec-binding-phone");$("#address").hover(function(){var sku=ec.product.getSku();sku=ec.product.getSkuInfo(sku);ec.product.processAddress(sku)},function(){});ec.product.gift.showGiftPackageView($("#bundlePackageSelect").find("li.selected").find("a"),false);setTimeout(function(){ec.diypkg.init()},500)})})();ec.product.disableAddCartButtons=function(){$("#pro-operation a.product-button01").each(function(){$(this).removeClass("product-button01").addClass("product-button01 disabled");this.backup=this.onclick;this.onclick=""});$("#pro-operation a.product-button02").each(function(){$(this).removeClass("product-button02").addClass("product-button02 disabled");this.backup=this.onclick;this.onclick=""});$("#pro-operation a.button-book-2").each(function(){$(this).removeClass("pro-button01 button-style-2").addClass("pro-button01 button-style-disabled-2");this.backup=this.onclick;this.onclick=""});$("a.button-add-cart-2, a.button-add-cart-3").each(function(){$(this).removeClass("pro-button01 button-style-1").addClass("pro-button01 button-style-disabled-2");this.backup=this.onclick;this.onclick=""})};ec.product.enableAddCartButtons=function(){$("#pro-operation a.product-button01").each(function(){$(this).removeClass("product-button01 disabled").addClass("product-button01").css("background-position-y","8px");this.onclick=this.backup;this.backup=""});$("#pro-operation a.product-button02").each(function(){$(this).removeClass("product-button02 disabled").addClass("product-button02").css("background-position-y","8px");this.onclick=this.backup;this.backup=""});$("#pro-operation a.button-book-2").each(function(){$(this).removeClass("pro-button01 button-style-disabled-2").addClass("pro-button01 button-style-2");this.onclick=this.backup;this.backup=""});$("a.button-add-cart-2, a.button-add-cart-3").each(function(){$(this).removeClass("pro-button01 button-style-disabled-2").addClass("pro-button01 button-style-1");this.onclick=this.backup;this.backup=""})};ec.product.addCart=function(){var buyNumber=parseInt($("#pro-quantity").val()),cartNUmber=parseInt($("#header-cart-total").html());ec.minicart.setNum(cartNUmber+buyNumber);var skusListArr=$("#pro-skus").find("dl").not($("#giftPackageList").find("dl")).not($("#packageList").find("dl"));for(p=0;p<skusListArr.length;p++){var flag=false;var skuInfoArr=skusListArr.get(p);$(skuInfoArr).children(".product-choose-detail").children("ul").find("li").each(function(index){if($(this).parents("#giftPackageList").length>0||$(this).parents("#packageList").length>0)return true;if($(this).hasClass("selected")){flag=true;return}});if(!flag){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var temp=ec.product.finalGift();var paras={salePortal:1,saleChannel:1001,needResultset:0,cartjson:temp.cartjson};ec.cart.add(paras,{successFunction:function(json){if(json.resultCode==2E5){var cartText=$("#pro-name").text()+"\u6210\u529f\u52a0\u5165\u8d2d\u7269\u8f66!";var computeRes=ec.product.compute($("#pro-add-success-mask"),cartText);if(computeRes.h>27)$("#cart-tips").find("p").parent().removeClass("box-right-1").addClass("box-right-2");else $("#cart-tips").find("p").parent().removeClass("box-right-2").addClass("box-right-1");$("#cart-tips").find("p").textS(cartText);$(".pro-add-success-total").hide();ec.minicart.setNum(json.cartNumber);var box=(new ec.box($("#cart-tips").html(),{boxclass:"ol_box_4",showButton:false})).open()}ec.product.enableAddCartButtons()},errorFunction:function(json){var box=(new ec.box('\x3cdiv class\x3d"box-errors-1"\x3e\x3cspan\x3e'+json.msg+"\x3c/span\x3e\x3c/div\x3e",{boxclass:"ol_box_4",showButton:true})).open();ec.product.enableAddCartButtons()}});ec.product.clickHide=function(id){$(document).click(function(){$("#"+id).hide()});$("#"+id).click(function(event){event.stopPropagation()})};ec.product.clickHide("cart-tips")};ec.product.compute=function(dom,val){dom.textS(val);return{w:dom[0].offsetWidth,h:dom[0].offsetHeight}};ec.product.finalGift=function(style){ec.product.packageGetSkuCode();var temp="";var cartjson="";var skuId=ec.product.getSku();var type;var skuCode=$("#pro-sku-code").val();var buyNum=parseInt($("#pro-quantity").val());var extendServiceSkuID=$("#extendSelect").attr("data-scode");var accidentServiceSkuID=$("#accidentSelect").attr("data-scode");var ucareServiceSkuID=$("#ucareSelect").attr("data-scode");var finalGift=ec.product.gift.finalMainSbomGiftMap[skuId];var gifts=[];var gifts2Cart=[];var gifts2Order=[];var otherPrdList=[];var defnum=1;var attrs="";if($("#packageCode").val()!=""){type="P";attrs={"package_code":$("#packageCode").val()};var packagelist=$("#packageListCode").val().split(",");for(var i=0;i<packagelist.length;i++){cartTemp={"itemCode":packagelist[i],"itemType":"P","qty":buyNum};otherPrdList.push(cartTemp)}}else type="S0";if(finalGift){for(var key in finalGift){var aGift={"sbomCode":finalGift[key].giftSkuCode};var bGift={"sbomCode":finalGift[key].giftSkuId};gifts2Cart.push(bGift);gifts2Order.push(aGift);cartTemp={"itemCode":finalGift[key].giftSkuCode,"itemType":"G","qty":buyNum};otherPrdList.push(cartTemp)}if(ec.product.gift.packageGiftMap[skuId])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuId].length;giftKey++){cartTemp={"itemCode":ec.product.gift.packageGiftMap[skuId][giftKey],"itemType":"G","qty":buyNum};otherPrdList.push(cartTemp)}if(extendServiceSkuID.length>0&&accidentServiceSkuID.length>0){otherPrdList.push({"itemCode":extendServiceSkuID,"itemType":"S1","qty":buyNum});otherPrdList.push({"itemCode":accidentServiceSkuID,"itemType":"S6","qty":buyNum});cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else if(extendServiceSkuID.length>0){otherPrdList.push({"itemCode":extendServiceSkuID,"itemType":"S1","qty":buyNum});cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else if(accidentServiceSkuID.length>0){otherPrdList.push({"itemCode":accidentServiceSkuID,"itemType":"S6","qty":buyNum});cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else{if(ec.product.gift.packageGiftMap[skuId])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuId].length;giftKey++){cartTemp={"itemCode":ec.product.gift.packageGiftMap[skuId][giftKey],"itemType":"G","qty":buyNum};otherPrdList.push(cartTemp)}if(extendServiceSkuID.length>0&&accidentServiceSkuID.length>0){otherPrdList.push({"itemCode":extendServiceSkuID,"itemType":"S1","qty":buyNum});otherPrdList.push({"itemCode":accidentServiceSkuID,"itemType":"S6","qty":buyNum});cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else if(extendServiceSkuID.length>0){otherPrdList.push({"itemCode":extendServiceSkuID,"itemType":"S1","qty":buyNum});cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else if(accidentServiceSkuID.length>0){otherPrdList.push({"itemCode":accidentServiceSkuID,"itemType":"S6","qty":buyNum});cartjson=JSON.stringify({"itemCode":skuCode,"itemType":type,"qty":buyNum,"subs":otherPrdList,"attrs":attrs})}else{cartjson0={"itemCode":skuCode,"itemType":type,"qty":buyNum,"attrs":attrs,"subs":otherPrdList};cartjson=JSON.stringify(cartjson0)}}if(ucareServiceSkuID.length>0){cartjson=JSON.parse(cartjson);cartjson.subs.push({itemCode:ucareServiceSkuID,itemType:"S15",qty:buyNum});cartjson=JSON.stringify(cartjson)}temp={cartjson:cartjson};return temp};ec.product.orderEasyBuy=function(){var skusListArr=$("#pro-skus").find("dl").not($("#giftPackageList").find("dl")).not($("#packageList").find("dl"));for(p=0;p<skusListArr.length;p++){var flag=false;var skuInfoArr=skusListArr.get(p);$(skuInfoArr).children(".product-choose-detail").children("ul").find("li").each(function(index){if($(this).parents("#giftPackageList").length>0||$(this).parents("#packageList").length>0)return true;if($(this).hasClass("selected")){flag=true;return}});if(!flag){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}var skuId=ec.product.getSku();var skuInfo=ec.product.getSkuInfo(skuId);var finalGift=ec.product.gift.finalMainSbomGiftMap[skuId];var skuCode=$("#pro-sku-code").val(),extendCode=$("#extendSelect").attr("data-scode"),accidentCode=$("#accidentSelect").attr("data-scode"),giftCodes="";if(finalGift){var giftCodeList=[];for(var key in finalGift)giftCodeList.push(finalGift[key].giftSkuCode);giftCodes=giftCodeList.join(",")}if(skuInfo.easyBuyPcUrl!="")ec.redirectTo(skuInfo.easyBuyPcUrl)};ec.product.isEasyBuy=function(){var skuInfo=ec.product.getSkuInfo(ec.product.getSku());var isPriority=$("#isPriority").val();var isPrioritySku=ec.product.getSkuPriority(ec.product.getSku());if(isPriority==1&&isPrioritySku==true)return false;if(skuInfo&&skuInfo.showEasyBuy=="1"){var easyBuyStartTime=skuInfo.easyBuyStartTime;var easyBuyEndTime=skuInfo.easyBuyEndTime;if(easyBuyStartTime!=""&&easyBuyEndTime!=""){var nowTime=ec.product.getSysDate();var eBuyStartTime=new Date;eBuyStartTime.setTime(ec.util.parseDate(easyBuyStartTime));var eBuyEndTime=new Date;eBuyEndTime.setTime(ec.util.parseDate(easyBuyEndTime));if(nowTime-eBuyStartTime>0&&nowTime-eBuyEndTime<0)if(skuInfo.webEnabled=="1")return true}else if(easyBuyStartTime!=""){var nowTime=ec.product.getSysDate();var eBuyStartTime=new Date;eBuyStartTime.setTime(ec.util.parseDate(easyBuyStartTime));if(nowTime-eBuyStartTime>0)if(skuInfo.webEnabled=="1")return true}}return false};ec.product.renderVisitorButton=function(appendSelector){var isValCas=ec.util.cookie.get("isValCas"),casLogin=ec.util.cookie.get("CASLOGIN"),uid=ec.util.cookie.get("uid"),displayName=ec.util.cookie.get("displayName");if(ec.account.isLogin()||isValCas!=null||casLogin!=null||uid!=null||displayName!=null)return;var skuInfo=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);skuId=skuInfo.id;if(ec.product.isSupportVisitorMode!="1"||ec.product.productType==4||rush.sbom.isRushProduct()||rush.sbom.isRushSbom(skuId))return;$("#product-deposit-agreement-area").next().remove()};ec.product.orderNowByVisitor=function(giftBuyTemp){var skusListArr=$("#pro-skus").find("dl").not($("#giftPackageList").find("dl")).not($("#packageList").find("dl"));for(p=0;p<skusListArr.length;p++){var flag=false;var skuInfoArr=skusListArr.get(p);$(skuInfoArr).children(".product-choose-detail").children("ul").find("li").each(function(index){if($(this).parents("#giftPackageList").length>0||$(this).parents("#packageList").length>0)return true;if($(this).hasClass("selected")){flag=true;return}});if(!flag){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var orderItemReqArgList=[];var orderitem={};orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=$("#pro-quantity").val();orderitem.itemType="S0";if(ec.product.productType==9)orderitem.itemType="S9";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();var gifts2Order=[];if(finalGift)for(var key in finalGift){var aGift={"sbomCode":finalGift[key].giftSkuCode};gifts2Order.push(aGift)}if(ec.product.gift.packageGiftMap[skuIds])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={"sbomCode":ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}orderitem.gifts=gifts2Order;orderitem.subOrderItemReqArgs=[];var packageCode=$("#packageCode").val();if(packageCode!=""){orderitem.itemType="P";var packageCodeList={"package_code":packageCode};orderitem.itemProp=packageCodeList}var packageSkuCode=$("#packageListCode").val();if(packageSkuCode!="")$.each(packageSkuCode.split(","),function(index,value){var apack={"itemId":value,"qty":$("#pro-quantity").val(),"itemType":"P"};orderitem.subOrderItemReqArgs.push(apack)});var giftBuyItem={};if(giftBuyTemp==2&&_giftBuyItemId.length>0){giftBuyItem.itemId=_giftBuyItemId[0];giftBuyItem.qty=$("#pro-quantity").val();giftBuyItem.itemType="S10";giftBuyItem.mainSkuCode=$("#pro-sku-code").val();orderitem.subOrderItemReqArgs.push(giftBuyItem)}orderitem.subOrderItemReqArgs=ec.product.subServices(orderitem.subOrderItemReqArgs);orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);var input="";input+='\x3cinput name\x3d"orderReqJson" type\x3d"text" value\x3d\''+jsonReqArg+"'\x3e";input+='\x3cinput name\x3d"state" type\x3d"text" value\x3d"0"\x3e';if(giftBuyTemp==2&&_giftBuyItemId.length>0)input+='\x3cinput name\x3d"routingTag" type\x3d"hidden" value\x3d"30"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(ec.product.productType==9)if(parseInt(getSku.buttonMode)==18)input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"36"\x3e';else input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"28"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(ec.product.isSupportVisitorMode=="1")$("#order-confirm-form").attr("action","/visitor/vistorConfirm");var form=$("#order-confirm-form").append(input);form.submit()};ec.product.orderNow=function(giftBuyTemp,orderFrom){giftBuyTemp=giftBuyTemp||$("#pro-operation").attr("data-gift");ec.product.isGift=giftBuyTemp;ec.product.isCover=false;ec.product.isComb=false;ec.account.afterLogin(function(){var skusListArr=$("#pro-skus").find("dl").not($("#giftPackageList").find("dl")).not($("#packageList").find("dl"));for(p=0;p<skusListArr.length;p++){var flag=false;var skuInfoArr=skusListArr.get(p);$(skuInfoArr).children(".product-choose-detail").children("ul").find("li").each(function(index){if($(this).parents("#giftPackageList").length>0||$(this).parents("#packageList").length>0)return true;if($(this).hasClass("selected")){flag=true;return}});if(!flag){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var orderItemReqArgList=[];var orderitem={};orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=$("#pro-quantity").val();orderitem.itemType="S0";if(ec.product.productType==9)orderitem.itemType="S9";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();var gifts2Order=[];if(finalGift)for(var key in finalGift){var aGift={"sbomCode":finalGift[key].giftSkuCode};gifts2Order.push(aGift)}if(ec.product.gift.packageGiftMap[skuIds])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={"sbomCode":ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}orderitem.gifts=gifts2Order;orderitem.subOrderItemReqArgs=[];var packageCode=$("#packageCode").val();if(packageCode!=""){orderitem.itemType="P";var packageCodeList={"package_code":packageCode};orderitem.itemProp=packageCodeList}var packageSkuCode=$("#packageListCode").val();if(packageSkuCode!="")$.each(packageSkuCode.split(","),function(index,value){var apack={"itemId":value,"qty":$("#pro-quantity").val(),"itemType":"P"};orderitem.subOrderItemReqArgs.push(apack)});var giftBuyItem={};if(giftBuyTemp==2&&_giftBuyItemId.length>0){giftBuyItem.itemId=_giftBuyItemId[0];giftBuyItem.qty=$("#pro-quantity").val();giftBuyItem.itemType="S10";giftBuyItem.mainSkuCode=$("#pro-sku-code").val();orderitem.subOrderItemReqArgs.push(giftBuyItem)}orderitem.subOrderItemReqArgs=ec.product.subServices(orderitem.subOrderItemReqArgs);orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);var input='\x3cinput name\x3d"orderReqJson" type\x3d"text" value\x3d\''+jsonReqArg+"'\x3e";input+='\x3cinput name\x3d"state" type\x3d"text" value\x3d"0"\x3e';if(giftBuyTemp==2&&_giftBuyItemId.length>0)input+='\x3cinput name\x3d"routingTag" type\x3d"hidden" value\x3d"30"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(ec.product.productType==9)if(parseInt(getSku.buttonMode)==18)input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"36"\x3e';else input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"28"\x3e';if(orderFrom==="HB"){var o=$("#hbDetail .product-stages-main li.selected a");if(o.length>0)input+='\x3cinput name\x3d"interest" type\x3d"text" value\x3d"'+ec.autoEncodeAttr(o.attr("interest-info"))+'"\x3e'}else if(orderFrom==="HL"){var o=$("#hlDetail .product-stages-main li.selected a");if(o.length>0)input+='\x3cinput name\x3d"interest" type\x3d"text" value\x3d"'+ec.autoEncodeAttr(o.attr("interest-info"))+'"\x3e'}var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);var form=$("#order-confirm-form").append(input);ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){form.submit()},500)})},"visitorInfo")};ec.product.addCartWithLogin=function(){ec.account.afterLogin(ec.product.addCart)};ec.product.buyBundle=function(bundleCode,dom){ec.dapClick("300020402",{buttonName:$(dom).text(),number:$("#pro-quantity").val(),SKUCode:$("#pro-sku-code").val(),packagecode:$("#packageCode").val(),packageSKUCode:$("#packageListCode").val(),click:1});ec.product.disableAddCartButtons();var temp=ec.product.finalGift(bundleCode);paras={cartjson:temp.cartjson};ec.cart.add(paras,{successFunction:function(json){ec.product.enableAddCartButtons();document.location.href="/cart2"},errorFunction:function(json){ec.product.enableAddCartButtons();alertS(json.msg)}})};ec.product.addComb=function(thix){var dataIndex=$(thix).attr("data-index");var orderItemReqArgList=[];var id=ec.product.getSku(),skuIds=[id],quantity=[1],type=[1],isPriority=$("#isPriority").val();skuCode=$("#pro-sku-code").val();var mainItem={};mainItem.itemCode=$("#pro-sku-code").val();mainItem.qty=1;mainItem.itemType="S0";orderItemReqArgList.push(mainItem);var comboToCart=[];var mainProduct={"itemCode":skuCode,"itemType":"S0","qty":1};comboToCart.push(mainProduct);$('[id\x3d"comb-pro-'+id+"-"+dataIndex+'"]').find("input[name\x3dskuId]:checked").each(function(){skuIds.push(this.value);quantity.push(1);type.push(1);var orderitem={};orderitem.itemId=this.value;orderitem.qty=1;orderitem.itemType="S0";orderItemReqArgList.push(orderitem);var combo={"itemType":"S0","qty":1,"itemCode":$(this).attr("data-scode")};comboToCart.push(combo)});var paras={number:1,cartjson:JSON.stringify(comboToCart)};if(isPriority==1)if(ec.product.getSkuPriority(id)==true)return ec.product.buy("sku",skuIds);$("#order-confirm-form").attr({"action":"/order/nowConfirmcart","method":"post"});ec.product.disableAddCartButtons();var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);ec.cart.add(paras,{successFunction:function(json){ec.product.enableAddCartButtons();document.location.href="/cart2"},errorFunction:function(json){ec.product.enableAddCartButtons();alertS(json.msg)}})};ec.product.orderComb=function(thix){ec.product.isComb=true;ec.account.afterLogin(function(){var skusListArr=$("#pro-skus").find("dl").not($("#giftPackageList").find("dl")).not($("#packageList").find("dl"));for(p=0;p<skusListArr.length;p++){var flag=false;var skuInfoArr=skusListArr.get(p);$(skuInfoArr).children(".product-choose-detail").children("ul").find("li").each(function(index){if($(this).parents("#giftPackageList").length>0||$(this).parents("#packageList").length>0)return true;if($(this).hasClass("selected")){flag=true;return}});if(!flag){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var dataIndex=$(thix).attr("data-index");var orderItemReqArgList=[];var orderitem={};$('[id\x3d"comb-pro-'+ec.product.getSku()+"-"+dataIndex+'"]').find("input[name\x3dskuId]:checked").each(function(){var orderitem={};orderitem.itemId=$(this).attr("data-scode");orderitem.qty=1;orderitem.itemType="S0";orderItemReqArgList.push(orderitem)});orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=$("#pro-quantity").val();orderitem.itemType="S0";if(ec.product.productType==9)orderitem.itemType="S9";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();var gifts2Order=[];if(finalGift)for(var key in finalGift){var aGift={"sbomCode":finalGift[key].giftSkuCode};gifts2Order.push(aGift)}if(ec.product.gift.packageGiftMap[skuIds])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={"sbomCode":ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}orderitem.gifts=gifts2Order;orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);var input="";input+='\x3cinput name\x3d"orderReqJson" type\x3d"text" value\x3d\''+jsonReqArg+"'\x3e";input+='\x3cinput name\x3d"state" type\x3d"text" value\x3d"0"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(ec.product.productType==9)if(parseInt(getSku.buttonMode)==18)input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"36"\x3e';else input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"28"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);var form=$("#order-confirm-form").append(input);ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){form.submit()},500)})})};ec.product.buy=function(type,id){ec.account.afterLogin(function(){var input="";if(type=="sku"){var orderItemReqArgList=[];var orderitem={};orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=1;orderitem.itemType="S0";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();var gifts2Order=[];if(finalGift)for(var key in finalGift){var aGift={"sbomCode":finalGift[key].giftSkuCode};gifts2Order.push(aGift)}if(ec.product.gift.packageGiftMap[skuIds])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={"sbomCode":ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}orderitem.gifts=gifts2Order;orderitem.subOrderItemReqArgs=[];orderitem.subOrderItemReqArgs=ec.product.subServices(orderitem.subOrderItemReqArgs);orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);input='\x3cinput name\x3d"orderReqJson" type\x3d"text" value\x3d\''+jsonReqArg+"'\x3e"}var form=$("#order-confirm-form").append(input);ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){form.submit()},500)})})};ec.product.subServices=function(subOrderItemReqArgs){subOrderItemReqArgs=subOrderItemReqArgs||[];var extendSbomCode=$("#extendSelect").attr("data-scode");var accidentSbomCode=$("#accidentSelect").attr("data-scode");var ucareSbomCode=$("#ucareSelect").attr("data-scode");if(extendSbomCode.length>0){var subItem={};subItem.itemId=extendSbomCode;subItem.qty=$("#pro-quantity").val();subItem.itemType="S1";subItem.mainSkuCode=$("#pro-sku-code").val();subOrderItemReqArgs.push(subItem)}if(accidentSbomCode.length>0){var subItem={};subItem.itemId=accidentSbomCode;subItem.qty=$("#pro-quantity").val();subItem.itemType="S6";subItem.mainSkuCode=$("#pro-sku-code").val();subOrderItemReqArgs.push(subItem)}if(ucareSbomCode.length>0){var subItem={};subItem.itemId=ucareSbomCode;subItem.qty=$("#pro-quantity").val();subItem.itemType="S15";subItem.mainSkuCode=$("#pro-sku-code").val();subOrderItemReqArgs.push(subItem)}return subOrderItemReqArgs};ec.product.timingBuy=function(){ec.product.inventory.wait(function(){var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);var _now=ec.product.getSysDate();var start=getSku.startTime;var startTime=new Date;startTime.setTime(ec.util.parseDate(start));var startArray=[];startArray.push(start);var countdownLength=getSku.countDown;$("#pro-operation").css("visibility","visible");$("#product-operation").show();if(_now-startTime>=0){var end=getSku.endTime;var endTime=new Date;if(null==end||""==end)endTime=new Date(2999,1,1,0,0,0);else endTime.setTime(ec.util.parseDate(end));if(_now-endTime<0){var haveQuantity=ec.product.inventory.haveInventory(getSku.id);if(haveQuantity){var content='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e'+'\x3cspan class\x3d"product-button-tips"\x3e\u9650\u65f6\u62a2\u8d2d\u8fdb\u884c\u4e2d\x3c/span\x3e';ec.product.renderVisitorButton($("#pro-operation"));$("#pro-operation").html(content);$("#product-operation").show()}else{$("#pro-quantity-area").hide();$("#pro-operation").html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#product-operation").show();ec.diypkg.hideAll()}}else{$("#pro-operation").html('\x3ca href\x3d"javascript:;" class\x3d"product-button02 disabled"\x3e\u6d3b\u52a8\u5df2\u7ed3\u675f\x3c/a\x3e');$("#pro-operation").css("visibility","visible");$("#product-operation").show();ec.diypkg.hideAll()}}else if(!ec.util.isEmpty(getSku.gotoUrl)&&(startTime-_now)/(1E3*3600)>countdownLength)if(1==getSku.isShowReminder){$("#pro-operation").html('\x3ca target\x3d"_blank" href\x3d"'+getSku.gotoUrl+'" class\x3d"product-button02" \x3e\x3cspan\x3e\u5f00\u552e\u63d0\u9192\x3c/span\x3e\x3c/a\x3e');$("#product-operation").show()}else{if(0==getSku.isShowReminder){var content='\x3ca href\x3d"javascript:;" class\x3d"product-button01 disabled" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;"  class\x3d"product-button02 disabled" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e\x3cdiv class\x3d"product-time"\x3e\x3c/div\x3e';$("#pro-operation").html(content);$("#product-operation").show();ec.ui.countdown2($(".product-time"),{html:"\x3cp\x3e\u79bb\u62a2\u8d2d\u5f00\u59cb\u8fd8\u6709\uff1a\x3c/p\x3e\x3cul\x3e\x3cli\x3e\x3cspan\x3e{#day}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e\u5929\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#hours}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e:\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#minutes}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e:\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#seconds}\x3c/span\x3e\x3c/li\x3e",now:_now,times:startArray,callback:function(json){var content='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e';$("#pro-operation").html(content);$("#product-operation").show();ec.product.gift.updateOperationBtns()}})}}else{var content='\x3ca href\x3d"javascript:;" class\x3d"product-button01 disabled" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;"  class\x3d"product-button02 disabled" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e\x3cdiv class\x3d"product-time"\x3e\x3c/div\x3e';$("#pro-operation").html(content);$("#product-operation").show();ec.ui.countdown2($(".product-time"),{html:"\x3cp\x3e\u79bb\u62a2\u8d2d\u5f00\u59cb\u8fd8\u6709\uff1a\x3c/p\x3e\x3cul\x3e\x3cli\x3e\x3cspan\x3e{#day}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e\u5929\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#hours}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e:\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#minutes}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e:\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#seconds}\x3c/span\x3e\x3c/li\x3e",now:_now,times:startArray,callback:function(json){var content='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e';$("#pro-operation").html(content);$("#product-operation").show();ec.product.showSbomInterest(ec.product.getSkuInfo(ec.product.getSku()));ec.product.gift.updateOperationBtns()}})}})};ec.product.arrival=function(){ec.account.afterLogin(function(){ec.product.syncCustomSession();var email=ec.product.email;var mobile=ec.product.mobile;var noticeType="";var box=new ec.box($("#product-arrival-html").val(),{boxid:"product-arriva-box",boxclass:"ol_box_4",title:"\u5230\u8d27\u901a\u77e5",width:700,showButton:false,onopen:function(box){if(ec.util.isEmpty(email)){$("#arrival-email").css({"cursor":"pointer"});$("#arrival-email").click(function(){ec.openWindow("/member/account");ec.product.bind()});$("#arrival-email").attr("class","disabled");$("#account-email").html('\u672a\u7ed1\u5b9a\u5b89\u5168\u90ae\u7bb1\x26nbsp;\x3ca href\x3d"javascript:;" target\x3d"_blank"\x3e\u53bb\u7ed1\u5b9a\x3c/a\x3e')}else{$("#arrival-email").bind("click",function(){noticeType=ec.product.chooseNoticeType("email")});$("#account-email").html(email)}if(ec.util.isEmpty(mobile)){$("#arrival-mobile").css({"cursor":"pointer"});$("#arrival-mobile").click(function(){ec.openWindow("/member/account");ec.product.bind()});$("#arrival-mobile").attr("class","disabled");$("#account-mobile").html('\u672a\u7ed1\u5b9a\u5b89\u5168\u624b\u673a\x26nbsp;\x3ca href\x3d"javascript:;" target\x3d"_blank"\x3e\u53bb\u7ed1\u5b9a\x3c/a\x3e')}else{$("#arrival-mobile").bind("click",function(){noticeType=ec.product.chooseNoticeType("mobile")});$("#account-mobile").html(ec.product.splitMobile(mobile))}},onok:function(box){if(noticeType.length==0){$("#arrival-error span").html("\u8bf7\u9009\u62e9\u4e00\u79cd\u901a\u77e5\u65b9\u5f0f\uff01");$("#arrival-error").removeClass("hide");return}var type="1";var informWay=email;if(noticeType=="mobile"){type="3";informWay=mobile}$.ajax({url:"/product/arrivalMail.json",dataType:"json",type:"post",data:{informWay:informWay,type:type,skuId:ec.product.getSku(),skuCode:$("#pro-sku-code2").html()},timeout:1E4,error:function(){ec.ui.loading.hide();$("#arrival-error span").html("\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01");$("#arrival-error").removeClass("hide")},beforeSend:function(xhr){ec.ui.loading.show();xhr.withCredentials=true},success:function(json){ec.ui.loading.hide();if(!json.success){$("#arrival-error span").html(json.msg);$("#arrival-error").removeClass("hide");return}alert("\u8bbe\u7f6e\u6210\u529f\uff01");$("#arrival-error").addClass("hide");box.close();$(".ol_box_mask").remove()}})},onclose:function(box){$(".ol_box_mask").remove()}});box.open();ec.product.bind=function(){box.close();$(".ol_box_mask").remove()}})};ec.product.chooseNoticeType=function(type){$("#arrival-email").removeClass("selected");$("#arrival-mobile").removeClass("selected");$("#arrival-"+type).attr("class","selected");return type};ec.product.attention=function(){var box=new ec.box($("#product-attention-html").val(),{boxid:"product-attention-box",title:"\u5173\u6ce8\u5546\u54c1",width:580,focus:"input[name\x3demail]",showButton:false,onok:function(box){var email=box.find("input[name\x3demail]").val(),mobile=box.find("input[name\x3dmobile]").val(),regMobile=/^0?(13|14|15|17|18)[0-9]{9}$/;if(!email){alert("\u8bf7\u8f93\u5165email\uff01");return}if(!ec.util.isEmail(email)){alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684email\uff01");return}if(!mobile){alert("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801\uff01");return}if(!regMobile.test(mobile)){alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\uff01");return}(new ec.ajax).submit({url:"/product/saveAttention.json",data:{email:email,phone:mobile,skuId:ec.product.getSku()},timeout:1E4,timeoutFunction:function(){alert(timeOutInfo)},beforeSendFunction:ec.ui.loading.show,afterSendFunction:ec.ui.loading.hide,successFunction:function(json){if(!json.success){ec.showError(json);return}alert("\u8bbe\u7f6e\u6210\u529f\uff01");box.close()}})}});box.open();box.find("input[name\x3demail]").focus()};ec.product.jmptoRemark=function(){$("#pro-tab-evaluate").click();ec.ui.scrollTo("#pro-tab-evaluate")};(function(){var _index=0,_length;ec.ready(function(){_length=$("#pro-gallerys").css("left","0").children().length});ec.product.imgSlider={prev:function(){if(_index==0)return;_index--;$("#pro-gallerys").animate({"left":_index*-74},100)},next:function(){if(_index+5>=_length)return;_index++;$("#pro-gallerys").animate({"left":_index*-74},100)},reset:function(){_length=$("#pro-gallerys").css("left","0").children().length;_index=0}}})();(function(_ep){_ep.renderGroup=function(skuId){var _showId=[],bundle=$("#bundle-list-"+skuId);if(bundle.length>0){_showId.push("#tab-bundle");bundle.show().siblings().hide();_ep.renderBundle(skuId)}var buttonMode=parseInt(ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku).buttonMode);if(buttonMode<1||buttonMode>13&&buttonMode!==22)ec.diypkg.hideAll();else ec.diypkg.init();$("#tab-bundle,#tab-comb").hide();if(_showId.length==0){$("#group-area").hide();return}if(_showId.length>1)_showId.push("#tab-split");_showId.push("#group-area");$(_showId.join(",")).show()};_ep.renderBundle=function(skuId){var bundleList=$("#bundle-list-"+skuId);this.showBundle(bundleList.children("li.current").attr("data-id"))};_ep.showBundle=function(bundleId){$("#bundle-pro-"+bundleId+",#bundle-price-"+bundleId).show().siblings().hide();_bundleId=bundleId;var bundle=$("#bundle-pro-"+bundleId)}})(ec.product);(function(){var _type;_options={};_options["default"]={};_options["normal"]={renderInventory:function(haveQuantity){var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku),$proMsg=$("#pro-msg"),$buyBtns=$("#pro-quantity-area,#pro-operation"),$buyBtnMod=$("#pro-operation"),isPriority=$("#isPriority").val();if(ec.product.productType==4||getSku.buttonMode==22)return false;$("#tab-addcart-button").hide();$("#tab-notice-button").hide();$("#product-tips").html("");$("#product-tips").hide();if(ec.product.status==3){$proMsg.show();$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u5df2\u4e0b\u67b6");$buyBtnMod.css("visibility","hidden");$("#pro-skus").html("");$("#pro-skus").hide();$(".product-operation-main").hide();$("#package_dl").remove();return}if(ec.product.status==5){$proMsg.show();$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u4e0d\u5728\u6b64\u9500\u552e\u524d\u7aef\u9500\u552e");$buyBtnMod.css("visibility","hidden");$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u4e0d\u5728\u6b64\u9500\u552e\u524d\u7aef\u9500\u552e");$("#product-tips").show();$("#product-operation").hide();return}if(getSku.tipsContent.length>1){$proMsg.show();$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a"+getSku.tipsContent);$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a"+getSku.tipsContent);$("#product-tips").show()}else{$proMsg.hide();$("#product-tips").hide()}if(getSku.priceMode==2){$("#pro-price-label").html("\u6682\u65e0\u62a5\u4ef7");$("#pro-price-label").show();$("#pro-price").hide();$("#pro-price-old").hide();$("#pro-price").html("");$("#pro-price-old").hide()}if(isPriority==1)if(ec.product.getSkuPriority(getSku.id)==true){$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.buy(\'sku\');return false;"\x3e\x3cspan\x3e\u7acb\u5373\u8d2d\u4e70\x3c/span\x3e\x3c/a\x3e');$("#pro-quantity-area").hide();$buyBtnMod.css("visibility","visible");$("#product-operation").show();$("#order-confirm-form").attr({"action":"/order/priorityConfirm","method":"post"});return}$("#order-confirm-form").attr({"action":"/order/nowConfirmcart","method":"post"});$("#product-deposit-agreement-area").next().remove();switch(parseInt(getSku.buttonMode,10)){case 5:$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 4:$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 2:$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.buy(\'sku\');return false;"\x3e\x3cspan\x3e\u7acb\u5373\u8d2d\u4e70\x3c/span\x3e\x3c/a\x3e');$("#pro-quantity-area").show();$buyBtnMod.css("visibility","visible");$("#product-operation").show();return;case 7:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();$buyBtnMod.html('\x3ca onclick\x3d"ec.product.orderEasyBuy()" class\x3d"product-button-priority" \x3e\x3cspan\x3e'+getSku.easyBuyName+"\x3c/span\x3e\x3c/a\x3e"+'\x3ca target\x3d"_blank" href\x3d"'+getSku.gotoUrl+'" class\x3d"product-button02" \x3e\x3cspan\x3e'+getSku.buttonText+"\x3c/span\x3e\x3c/a\x3e")}else $buyBtnMod.html('\x3ca target\x3d"_blank" href\x3d"'+getSku.gotoUrl+'" class\x3d"product-button02" \x3e\x3cspan\x3e'+getSku.buttonText+"\x3c/span\x3e\x3c/a\x3e");$buyBtnMod.css("visibility","visible");$("#product-operation").show();return;case 8:return;case 9:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();$buyBtnMod.html('\x3ca onclick\x3d"ec.product.orderEasyBuy()" class\x3d"product-button-priority" \x3e\x3cspan\x3e'+getSku.easyBuyName+"\x3c/span\x3e\x3c/a\x3e"+'\x3ca target\x3d"_blank" href\x3d"'+getSku.gotoUrl+'" class\x3d"product-button02" \x3e\x3cspan\x3e\u5f00\u552e\u63d0\u9192\x3c/span\x3e\x3c/a\x3e')}else $buyBtnMod.html('\x3ca target\x3d"_blank" href\x3d"'+getSku.gotoUrl+'" class\x3d"product-button02" \x3e\x3cspan\x3e\u5f00\u552e\u63d0\u9192\x3c/span\x3e\x3c/a\x3e');$buyBtnMod.css("visibility","visible");$("#product-operation").show();return;case 10:ec.product.timingBuy();return;case 12:if(ec.product.productType==9){if(haveQuantity){$("#pro-quantity-area").show();$buyBtnMod.css("visibility","visible");$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.orderNow()"\x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e');$("#product-operation").show()}else{$("#pro-quantity-area").hide();$buyBtnMod.css("visibility","visible");$("#product-operation").show();$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#tab-notice-button").show()}return}$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 18:if(ec.product.productType==9){if(haveQuantity){$("#pro-quantity-area").show();$buyBtnMod.css("visibility","visible");$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.orderNow()"\x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e');$("#product-operation").show()}else{$("#pro-quantity-area").hide();$buyBtnMod.css("visibility","visible");$("#product-operation").show();$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#tab-notice-button").show()}return}$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 15:$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();$("#product-operation").hide();if(getSku.tipsContent.length>1)$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a"+getSku.tipsContent);else $("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u6682\u4e0d\u552e\u5356");$("#product-tips").show();return;case 3:case 1:if(haveQuantity){$("#pro-quantity-area").show();$buyBtnMod.css("visibility","visible");$("#product-operation").show();if(getSku.groupType=="1")$buyBtnMod.html('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u56e2\u8d2d\x3c/span\x3e\x3c/a\x3e');else{var html='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e';ec.product.renderVisitorButton($buyBtnMod);$buyBtnMod.html(html);$("#tab-addcart-button").show()}}else{$("#pro-quantity-area").hide();$buyBtnMod.css("visibility","visible");$("#product-operation").show();if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();$buyBtnMod.html('\x3ca onclick\x3d"ec.product.orderEasyBuy()" class\x3d"product-button-priority" \x3e\x3cspan\x3e'+getSku.easyBuyName+"\x3c/span\x3e\x3c/a\x3e"+'\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e')}else{$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#tab-notice-button").show();ec.diypkg.hideAll()}}return;case 19:$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();$("#product-operation").hide();if(getSku.tipsContent.length>1)$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a"+getSku.tipsContent);else $("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u6682\u4e0d\u552e\u5356");$("#product-tips").show();return;case 22:if(haveQuantity){$("#pro-quantity-area").show();$buyBtnMod.css("visibility","visible");$("#product-operation").show();var html='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01" \x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e'+'\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e';$buyBtnMod.html(html);$("#tab-addcart-button").show()}else{$("#pro-quantity-area").hide();$buyBtnMod.css("visibility","visible");$("#product-operation").show();$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#tab-notice-button").show();ec.diypkg.hideAll()}return;case 23:var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);var _now=ec.product.getSysDate();var start=getSku.startTime;var startTime=new Date;startTime.setTime(ec.util.parseDate(start));var startArray=[];startArray.push(start);var countdownLength=getSku.countDown;$("#pro-operation").css("visibility","visible");$("#product-operation").show();if(_now-startTime>=0)if(haveQuantity){$("#pro-quantity-area").show();$buyBtnMod.css("visibility","visible");$("#product-operation").show();var html='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e';$buyBtnMod.html(html);$("#tab-addcart-button").show()}else{$("#pro-quantity-area").hide();$buyBtnMod.css("visibility","visible");$("#product-operation").show();$buyBtnMod.html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#tab-notice-button").show();ec.diypkg.hideAll()}else{var content='\x3ca href\x3d"javascript:;"  class\x3d"product-button02 disabled" \x3e\x3cspan\x3e\u5373\u5c06\u5f00\u552e\x3c/span\x3e\x3c/a\x3e\x3cdiv class\x3d"product-time"\x3e\x3c/div\x3e';$("#pro-operation").html(content);$("#product-operation").show();ec.ui.countdown2($(".product-time"),{html:"\x3cp\x3e\u8ddd\u79bb\u5f00\u552e\u8fd8\u6709\uff1a\x3c/p\x3e\x3cul\x3e\x3cli\x3e\x3cspan\x3e{#day}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e\u5929\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#hours}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e:\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#minutes}\x3c/span\x3e\x3c/li\x3e\x3cli\x3e\x3cem\x3e:\x3c/em\x3e\x3c/li\x3e\x3cli\x3e\x3cspan\x3e{#seconds}\x3c/span\x3e\x3c/li\x3e",now:_now,times:startArray,callback:function(json){var content='\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.orderNow()" class\x3d"product-button02" \x3e\x3cspan\x3e\u7acb\u5373\u4e0b\u5355\x3c/span\x3e\x3c/a\x3e';$("#pro-operation").html(content);$("#product-operation").show();ec.product.showSbomInterest(ec.product.getSkuInfo(ec.product.getSku()));ec.product.gift.updateOperationBtns()}})}return;default:$buyBtnMod.css("visibility","hidden");$("#pro-quantity-area").hide();$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u6682\u672a\u552e\u5356");$("#product-tips").show();$("#product-operation").hide()}}};_options["reservation"]={renderInventory:function(haveQuantity){$("#pro-msg").hide();if(haveQuantity){$("#pro-quantity-area").show();$("#pro-operation").html('\x3ca href\x3d"javascript:;"  onclick\x3d"ec.product.addCartWithLogin()" class\x3d"product-button02" \x3e\x3cspan\x3e\u9884\u7ea6\u8d2d\u4e70\x3c/span\x3e\x3c/a\x3e');$("#product-operation").show()}else{$("#pro-quantity-area").hide();$("#pro-operation").html('\x3ca href\x3d"javascript:;" class\x3d"product-button02" onclick\x3d"ec.product.arrival()"\x3e\x3cspan\x3e\u5230\u8d27\u901a\u77e5\x3c/span\x3e\x3c/a\x3e');$("#product-operation").show()}}};_options["queue"]={renderInventory:function(haveQuantity){if(haveQuantity){$("#sale-buy-btn").show();$("#sale-sell-out").hide()}else{$("#sale-buy-btn").hide();$("#sale-sell-out").show()}}};_options["seckill"]={renderInventory:function(haveQuantity){if(haveQuantity){$("#sale-buy-btn").show();$("#sale-sell-out").hide()}else{$("#sale-buy-btn").hide();$("#sale-sell-out").show()}}};ec.product.execute=function(command,args){var opt=_options[_type],fun=opt[command]||_options["default"][command];if(fun)fun.apply(ec.product,args)};ec.product.setType=function(type){_type=type;switch(type){case "normal":case "reservation":ec.product.isSale=false;break;default:ec.product.isSale=true}ec.product.prefix=ec.product.isSale?"/sale":"/product"}})();ec.ready(function(){$(function(){var fix=$(".product-gallery");var end=$(".gallery-scroll-bottom");var fixTop=fix.offset().top,fixHeight=fix.height();var endTop,miss;$(window).scroll(function(){var docTop=Math.max(document.body.scrollTop,document.documentElement.scrollTop);if(end.length>0){endTop=$(".header").height()+$(".hr-10").height()*4+$(".g").height()+$(".product").height();miss=endTop-docTop-fixHeight}if(fixTop<docTop){fix.addClass("positionFixed");fix.removeClass("positionStatic");if(end.length>0&&endTop<docTop+fixHeight)fix.css({top:miss});else fix.css({top:0})}else{fix.addClass("positionStatic");fix.removeClass("positionFixed")}})});var product=ec.product;ec.ui.proNumer("#pro-quantity",{max:999,min:1});ec.product.tabSkuInfo(ec.product.setSkuId||ec.product.defaultSku);var loadParameter=false;var _loadEvaluateSorce=function(){if(loadEvaluate)return;ec.product.remark.loadEvaluateScore();$("#pro-tab-evaluate-content").show();ec.product.remark.loadEvaluate({pageNumber:1,type:0,extraType:1});ec.product.remark.bindEvent()};_loadEvaluateSorce();var product=ec.product;_bindEvent();$("#pro-tab-feature , #pro-tab-parameter , #pro-tab-package-service , #pro-tab-evaluate").click(function(){var thix=$(this),id=this.id});ec.product.history.add(ec.product.id);$(window).scroll(function(){var hisScroll=$(this).scrollTop(),winHeight=$(window).height(),scrollTop=$("#product-history-area").offset().top;if(finished&&hisScroll>=scrollTop-winHeight){finished=false;product.history.load(function(list){if(list.length==0){$("#product-history-area").hide();return}var html=[],p;for(var i=0;i<list.length;i++){p=list[i];p.price=p.priceMode==2?'\x3cem  class\x3d"disabled"\x3e\u6682\u65e0\u62a5\u4ef7\x3c/em\x3e':"\x3cem\x3e\x26yen;"+p.price+"\x3c/em\x3e";html.push('\x3cli class\x3d"swiper-slide"\x3e');html.push('\x3ca href\x3d"/product/'+p.id+'.html"  title\x3d"'+p.name+'"  onclick\x3d"pushProHistoryMsg(\''+ec.encodeForJS(p.code)+"','"+(i+1)+'\')" target\x3d"_blank"\x3e');html.push('\x3cimg src\x3d"'+ec.mediaPath+p.photoPath+"142_142_"+p.photoName+'" alt\x3d"'+p.name+'"/\x3e');html.push('\x3cdiv class\x3d"product-link-detail"\x3e');html.push("\x3cp\x3e\x3cspan\x3e"+p.name+"\x3c/span\x3e\x3c/p\x3e");html.push(""+p.price+"");html.push("\x3c/div\x3e");html.push("\x3c/a\x3e");html.push("\x3c/li\x3e")}$("#product-history-list").html("");$("#product-history-list").html(html.join(" "));$("#product-history-area").show();ec.product.scroll("product-history-scroll",5)},null,ec.product.isSale?null:ec.product.id)}});product.renderGroup(product.setSkuId||product.defaultSku);var comb_timer;product.renderBundle(product.setSkuId||product.defaultSku);var sku=ec.product.getSku();sku=ec.product.getSkuInfo(sku);ec.form.input.label("#extend-text","\u8f93\u5165IMEI/SN/MEID\u4fe1\u606f");$("#extendProtected").parent().parent().mouseover(function(){var a=$("#extendProtected").parent().parent().data("flag");if(a==1)$("#extendProtected").parent().parent().data("flag","");else $("#extendProtected").parent().parent().addClass("hover")});$("#extendProtected").parent().parent().mouseout(function(){$("#extendProtected").parent().parent().data("flag","");$("#extendProtected").parent().parent().removeClass("hover")});$("#accidentProtected").parent().parent().mouseover(function(){var a=$("#accidentProtected").parent().parent().data("flag");if(a==1)$("#accidentProtected").parent().parent().data("flag","");else $("#accidentProtected").parent().parent().addClass("hover")});$("#accidentProtected").parent().parent().mouseout(function(){$("#accidentProtected").parent().parent().data("flag","");$("#accidentProtected").parent().parent().removeClass("hover")})});ec.product.divchange=function(data){if(data==1){$("#prddetail_counsel_all").show();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_1").attr("class","selected")}else if(data==2){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").show();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_2").attr("class","selected");ec.product.counselloadprd({"pageNumber":1})}else if(data==3){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").show();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_3").attr("class","selected");ec.product.paycounselload({"pageNumber":1})}else if(data==4){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").show();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_4").attr("class","selected");ec.product.transcounselload({"pageNumber":1})}else if(data==5){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").show();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_5").attr("class","selected");ec.product.sercounselload({"pageNumber":1})}else{$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").show();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_6").attr("class","selected")}};ec.product.counselloadall=function(page){(new ec.ajax).submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{"prdId":ec.product.id,"dataType":0,"pageNumber":page.pageNumber,"pageSize":3},timeout:1E4,timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success){ec.showError(json);return}var html=[];html=ec.product.createcounselhtml(json);$("#all_prd_counsel_content").html(html.join(""));ec.product.allrenderPage(json.page)}})};ec.product.allrenderPage=function(page){$("#all_prd_counsel").show();$("#all_prd_counsel").pager({pageNumber:page.pageNumber,pageCount:page.totalPage,pageSize:3,text:{first:"|\x26lt;",pre:"\x26lt",next:"\x26gt;",last:"\x26gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.counselloadall});ec.product.pagerScroll("all_prd_counsel")};ec.product.counselloadprd=function(page){(new ec.ajax).submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{"prdId":ec.product.id,"dataType":1,"pageNumber":page.pageNumber,"pageSize":3},timeout:1E4,dataType:"json",timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success){ec.showError(json);return}var html=[];html=ec.product.createcounselhtml(json);$("#prd_prd_counsel_content").html(html.join(""));if(json.page.totalRow>0)$("#prddetail_counsel_prd_total \x3e div:first-child").html("\u5171"+json.page.totalRow+"\u6761");else $("#prddetail_counsel_prd_total").hide();ec.product.prdrenderPage(json.page)}})};ec.product.prdrenderPage=function(page){$("#prd_prd_counsel").show();$("#prd_prd_counsel").pager({pageNumber:page.pageNumber,pageCount:page.totalPage,pageSize:3,text:{first:"|\x26lt;",pre:"\x26lt",next:"\x26gt;",last:"\x26gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.counselloadprd});ec.product.pagerScroll("prd_prd_counsel")};ec.product.paycounselload=function(page){(new ec.ajax).submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{"prdId":ec.product.id,"dataType":2,"pageNumber":page.pageNumber,"pageSize":3},dataType:"json",timeout:1E4,timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success){ec.showError(json);return}var html=[];html=ec.product.createcounselhtml(json);$("#pay_prd_counsel_content").html(html.join(""));if(json.page.totalRow>0)$("#prddetail_counsel_pay_total \x3e div:first-child").html("\u5171"+json.page.totalRow+"\u6761");else $("#prddetail_counsel_pay_total").hide();ec.product.payrenderPage(json.page)}})};ec.product.payrenderPage=function(page){$("#pay_prd_counsel_page").show();$("#pay_prd_counsel_page").pager({pageNumber:page.pageNumber,pageCount:page.totalPage,pageSize:3,text:{first:"|\x26lt;",pre:"\x26lt",next:"\x26gt;",last:"\x26gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.paycounselload});ec.product.pagerScroll("pay_prd_counsel_page")};ec.product.transcounselload=function(page){(new ec.ajax).submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{"prdId":ec.product.id,"dataType":3,"pageNumber":page.pageNumber,"pageSize":3},timeout:1E4,dataType:"json",timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success){ec.showError(json);return}var html=[];html=ec.product.createcounselhtml(json);$("#trans_prd_counsel_content").html(html.join(""));if(json.page.totalRow>0)$("#prddetail_counsel_trans_total \x3e div:first-child").html("\u5171"+json.page.totalRow+"\u6761");else $("#prddetail_counsel_trans_total").hide();ec.product.transrenderPage(json.page)}})};ec.product.transrenderPage=function(page){$("#trans_prd_counsel_page").show();$("#trans_prd_counsel_page").pager({pageNumber:page.pageNumber,pageCount:page.totalPage,pageSize:3,text:{first:"|\x26lt;",pre:"\x26lt",next:"\x26gt;",last:"\x26gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.transcounselload});ec.product.pagerScroll("trans_prd_counsel_page")};ec.product.sercounselload=function(page){(new ec.ajax).submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{"prdId":ec.product.id,"dataType":4,"pageNumber":page.pageNumber,"pageSize":3},dataType:"json",timeout:1E4,timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success){ec.showError(json);return}var html=[];html=ec.product.createcounselhtml(json);$("#ser_prd_counsel_content").html(html.join(""));if(json.page.totalRow>0)$("#prddetail_counsel_serv_total \x3e div:first-child").html("\u5171"+json.page.totalRow+"\u6761");else $("#prddetail_counsel_serv_total").hide();ec.product.serrenderPage(json.page)}})};ec.product.serrenderPage=function(page){$("#ser_prd_counsel_page").show();$("#ser_prd_counsel_page").pager({pageNumber:page.pageNumber,pageCount:page.totalPage,pageSize:3,text:{first:"|\x26lt;",pre:"\x26lt",next:"\x26gt;",last:"\x26gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.sercounselload});ec.product.pagerScroll("ser_prd_counsel_page")};ec.product.quescounselload=function(page){(new ec.ajax).submit({url:"/product/query/frequentyQuestions/"+ec.product.id+".json",data:{"prdId":ec.product.id,"pageNumber":page.pageNumber,"pageSize":10},timeout:1E4,timeoutFunction:function(){alert(timeOutInfo)},successFunction:function(json){if(!json.success){ec.showError(json);return}var html=[];if(json.page.totalRow>0)for(var i=0;i<json.prdFrequentyQuestionsList.length;i++){var p=json.prdFrequentyQuestionsList[i];html.push("\x3cli\x3e");html.push("\x3ch2\x3e"+((page.pageNumber-1)*10+i+1)+"\u3001"+p.question+"\x3c/h2\x3e");html.push("\x3cp\x3e"+p.reply+"\x3c/p\x3e");html.push("\x3c/li\x3e")}else html.push('\x3cdiv class\x3d"product-inquire-list"\x3e\x3cdiv class\x3d"product-inquire-no"\x3e\u6682\u65e0\u76f8\u5173\u5185\u5bb9\x3c/div\x3e\x3c/div\x3e');$("#ques_prd_counsel_content").html(html.join(""));if(json.page.totalRow>0)$("#prddetail_counsel_ques_total div:first-child").html("\u5171"+json.page.totalRow+"\u6761");else $("#prddetail_counsel_ques_total").hide();ec.product.quesrenderPage(json.page)}})};ec.product.quesrenderPage=function(page){$("#ques_prd_counsel_page").show();$("#ques_prd_counsel_page").pager({pageNumber:page.pageNumber,pageCount:page.totalPage,pageSize:10,text:{first:"|\x26lt;",pre:"\x26lt",next:"\x26gt;",last:"\x26gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.quescounselload});ec.product.pagerScroll("ques_prd_counsel_page")};ec.product.createcounselhtml=function(json){var html=[];if(json.page.totalRow>0){html.push('\x3cul class\x3d"product-inquire-list"\x3e');for(var i=0;i<json.prdConsultationList.length;i++){p=json.prdConsultationList[i];var username=p.userName;var gradecode=p.gradeCode;var date=ec.util.parseDate(p.createTime);var answerdate=ec.util.parseDate(p.answerTime);html.push('\x3cli\x3e \x3cdiv class\x3d"product-inquire-user"\x3e\u7f51\u53cb');html.push("\x3cspan\x3e"+ec.autoEncodeAttr(username)+"\x3c/span\x3e");html.push("\x3cem\x3e"+date.format("yyyy-MM-dd HH:mm:ss")+"\x3c/em\x3e\x3c/div\x3e");html.push('\x3cdiv class\x3d"product-inquire-question"\x3e');html.push("\x3clabel\x3e\u54a8\u8be2\u5185\u5bb9\uff1a\x3c/label\x3e\x3cspan\x3e"+ec.autoEncodeAttr(p.question)+"\x3c/span\x3e\x3c/div\x3e");html.push('\x3cdiv class\x3d"product-inquire-answer"\x3e');html.push("\x3cp\x3e\x3clabel\x3e\u56de\u590d\uff1a\x3c/label\x3e"+ec.autoEncodeAttr(p.answer)+"\x3c/p\x3e");html.push("\x3cem\x3e"+answerdate.format("yyyy-MM-dd HH:mm:ss")+"\x3c/em\x3e");html.push("\x3c/div\x3e\x3c/li\x3e")}html.push("\x3c/ul\x3e")}else html.push('\x3cdiv class\x3d"product-inquire-list"\x3e\x3cdiv class\x3d"product-inquire-no"\x3e\u6682\u65e0\u76f8\u5173\u5185\u5bb9\x3c/div\x3e\x3c/div\x3e');return html};ec.product.loginCheckBefCoun=function(){ec.account.afterLogin(function(){$("#counseltextid").focus();$("#error-span").hide()})};ec.product.submitCounsel=function(){var temptext=$("#counseltextid").val();var typeValue=$('input[name\x3d"type"]').val();var text=ec.product.optCompany(temptext);if(text==null||text.length<1){$("#error-span").show();$("#error-span").html("\u63d0\u4ea4\u5185\u5bb9\u4e3a\u7a7a");return}else{var reg=new RegExp(addressFrontRegex);var textCopy=text.split("").filter(function(r){return reg.test(r)}).join("");if(textCopy!=text){$("#error-span").show();$("#error-span").html("\u60a8\u63d0\u4ea4\u7684\u5185\u5bb9\u542b\u6709\u975e\u6cd5\u5b57\u7b26");return}}if(text.length>100){$("#error-span").show();$("#error-span").html("\u8f93\u5165\u7684\u6587\u5b57\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57,\u8bf7\u91cd\u65b0\u8f93\u5165");return}if(ec.product.name!=null)ec.product.name=ec.product.name.transHtmlAttribute();var safeEmail="";if($("#safeEmail").attr("checked"))safeEmail="1";(new ec.ajax).post({url:domainMain+"/member/addUserRemarkView.json?t\x3d"+(new Date).getTime(),dataType:"json",data:{"orderCode":"comments"},timeout:1E4,timeoutFunction:function(){alert(timeOutInfo);return false},successFunction:function(json){if(!json.success)ec.account.syncCustomSession();$.ajax({url:"/product/save/consultation.json",type:"POST",dataType:"json",data:{"productId":ec.product.id,"productName":ec.product.name,"question":temptext,"type":typeValue,"email":safeEmail,"carrierCode":ec.product.seCode,"carrierName":$("#shopName").val()},beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(!json.success)if(json.msg=="notRealName")ec.product.commentsTip();else{$("#error-span").show();$("#error-span").html(json.msg)}else{if($("#safeEmail").attr("checked"))ec.product.counselSuccess(json.changeEmailUrl);else alert("\u63d0\u4ea4\u6210\u529f,\u6211\u4eec\u5c06\u5c3d\u5feb\u4e3a\u60a8\u89e3\u7b54");$("#counsel_content_form")[0].reset();$("#error-span").hide();return}}})}})};ec.product.commentsTip=function(){(new ec.box($("#realNameComment").val(),{boxclass:"ol_box_4",title:"",width:540,showButton:false,autoHeight:false,onok:function(){}})).open()};ec.product.optCompany=function(str){return str.replace(/(^\s*)|(\s*$)/g,"")};ec.product.counselSuccess=function(url){ec.account.afterLogin(function(){ec.product.syncCustomSession();var email=ec.product.email;var box=new ec.box($("#product-counsel-html").val(),{boxid:"product-counsel-box",boxclass:"ol_box_4",showButton:false,onopen:function(box){if(ec.util.isEmpty(email)){$("#counsel-success-msg").html("\u56de\u590d\u5c06\u53d1\u9001\u5230\u60a8\u7684\u5b89\u5168\u90ae\u7bb1\uff0c\u60a8\u8fd8\u672a\u7ed1\u5b9a\uff0c\u8bf7\u5148\u7ed1\u5b9a\u5b89\u5168\u90ae\u7bb1\u3002");$("#counsel-bind-email").html('\x3ca href\x3d"'+url+'" class\x3d"box-change box-pro-button01 button-style-2" target\x3d"_blank" onclick\x3d"ec.product.secEmailOper()"\x3e\x3cspan\x3e\u53bb\u7ed1\u5b9a\x3c/span\x3e\x3c/a\x3e')}else{$("#counsel-success-msg").html("\u5ba2\u670d\u56de\u590d\u5c06\u53d1\u9001\u5230\u60a8\u7684\u5b89\u5168\u90ae\u7bb1\x26nbsp;"+email+"\uff0c\u53ef\u70b9\u51fb\u4fee\u6539\u5b89\u5168\u90ae\u7bb1\u3002");$("#counsel-bind-email").html('\x3ca href\x3d"'+url+'" class\x3d"box-change box-pro-button01 button-style-2" target\x3d"_blank" onclick\x3d"ec.product.secEmailOper()"\x3e\x3cspan\x3e\u4fee\u6539\u5b89\u5168\u90ae\u7bb1\x3c/span\x3e\x3c/a\x3e')}},onok:function(box){},onclose:function(box){$(".ol_box_mask").remove()}});box.open();ec.product.secEmailOper=function(){box.close();$(".ol_box_mask").remove()}})};ec.product.combChange=function(data){var currentLi=$(data).parent();currentLi.addClass("current");currentLi.siblings().not(currentLi).removeClass("current");var ulId=currentLi.parent().attr("id");var skuId=ulId.substring(14,ulId.length);var index=currentLi.index();var cuttentDivs=$("#comb-pro-"+ec.product.getSku()+"-"+index);var cuttentDiv=cuttentDivs.eq(index);cuttentDivs.show();cuttentDivs.siblings(".product-recommend-con").hide()};ec.product.syncCustomSession=function(){(new ec.ajax).get({async:false,url:"/account/syncEmailAndMobile.json",timeout:1E4,successFunction:function(json){if(!ec.util.isEmpty(json.customerInfo)){ec.product.email=json.customerInfo.email;ec.product.mobile=json.customerInfo.mobile}return},timeoutFunction:function(){return},errorFunction:function(){return}})};ec.product.giftshow=function(){var box=new ec.box($("#pro-gift-box").html(),{boxclass:"ol_box_4",title:"\u9009\u62e9\u8d60\u54c1\u989c\u8272",showButton:false,autoHeight:false});box.open();$(".box-content").find("#pro-gift-list-detail").parent().siblings().show().html('\x3ca href\x3d"javascript:;" class\x3d"box-cancel" onclick\x3d"ec.product.boxCancle()"\x3e\x3cspan\x3e\u53d6\u6d88\x3c/span\x3e\x3c/a\x3e\x3ca href\x3d"javascript:;" class\x3d"box-sure" id\x3d"box-sures" \x3e\x3cspan\x3e\u786e\u8ba4\x3c/span\x3e\x3c/a\x3e');$("div[id^\x3d'pro-gift-list-detail'] li a").bind("click",function(event){if($(this).parent().hasClass("selected")){$(this).parent().parent().find("li").removeClass("new");$(this).parent().addClass("new");return}$(this).parent().parent().find("li").removeClass("selected");$(this).parent().addClass("selected");$(this).parent().parent().find("li").removeClass("new");$(this).parent().addClass("new");var mainSku=ec.product.getSku();var multiGiftVO=ec.product.gift.mainSkuGiftMap[mainSku];var finalGift=ec.product.gift.finalMainSbomGiftMap[mainSku];var choseGiftKey=$(this).attr("key");var gift=multiGiftVO[choseGiftKey];var defaultGiftKey=$(this).attr("defaultGiftKey");finalGift[defaultGiftKey]=gift;$("#ol_box").find("#gift-detail-"+defaultGiftKey).find("img").attrS("src",ec.mediaPath+gift.photoPath+ec.product.gift.middleImgSize+gift.photoName);$("#ol_box").find("#gift-detail-"+defaultGiftKey).attr("href","/product/"+gift.giftId+".html#"+gift.giftSkuId);$("#ol_box").find("#gift-detail-name"+defaultGiftKey).html(gift.giftName)});$("#box-sures").bind("click",function(event){$("div[id^\x3d'ol_box'] li.selected").each(function(){var mainSku=ec.product.getSku();var multiGiftVO=ec.product.gift.mainSkuGiftMap[mainSku];var finalGift=ec.product.gift.finalMainSbomGiftMap[mainSku];var choseGiftKey=$(this).children("a").attr("key");var gift=multiGiftVO[choseGiftKey];var defaultGiftKey=$(this).children("a").attr("defaultGiftKey");finalGift[defaultGiftKey]=gift;$("#ol_box").find("#gift-detail-"+defaultGiftKey).find("img").attrS("src",ec.mediaPath+gift.photoPath+ec.product.gift.middleImgSize+gift.photoName);$("#ol_box").find("#gift-detail-"+defaultGiftKey).attr("href","/product/"+gift.giftId+".html#"+gift.giftSkuId);$("#ol_box").find("#gift-detail-name"+defaultGiftKey).html(gift.giftName);$("#gift-"+defaultGiftKey).attr("href","/product/"+gift.giftId+".html#"+gift.giftSkuId);$("#gift-"+defaultGiftKey).attrS("title",""+gift.giftName);$("#gift-"+defaultGiftKey).attr("key",choseGiftKey);$("#gift-"+defaultGiftKey).find("img").attrS("src",ec.mediaPath+gift.photoPath+ec.product.gift.middleImgSize+gift.photoName);$("#gift-"+defaultGiftKey).find("img").attrS("alt",""+gift.giftName)});var html=$("#ol_box").find("#pro-gift-list-detail").html();$("#pro-gift-list-detail").html("");$("#pro-gift-list-detail").append(html);$(".ol_box_mask").remove();$("#ol_box").hide()})};ec.product.boxCancle=function(){$(".ol_box_mask").remove();$("#ol_box").remove()};ec.product.splitMobile=function(mobile){var result="";for(var i=0;i<mobile.length;i++){if((mobile.length-i)%4==0);result+=mobile.substring(i,i+1)}return result};ec.product.getPackageAndService=function(skuId){var packageContent=ec.product.packageList[skuId];var serviceContent=ec.product.warranty[skuId];var hasPackage=packageContent?true:false;var hasService=serviceContent?true:false;var hasBoth=hasPackage&&hasService;packFlag=!hasPackage&&!hasService;$("#pro-tab-package-service-content").empty();$("#pro-tab-service-content").empty();$("#pro-tab-package-service-content").hide();$("#packagTitleId").hide();$("#customerServiceTitle").hide();$("#customerServiceDiv").hide();$("#pro-tab-package-service").hide();if(hasPackage){$("#pro-tab-package-service-content").html(packageContent);$("#pro-tab-package-service-content").show();$("#packagTitleId").show();$("#pro-tab-package-service").show()}if(hasService){$("#pro-tab-service-content").html(serviceContent);$("#customerServiceTitle").show();$("#customerServiceDiv").show();$("#pro-tab-package-service").show()}};ec.product.getFeature=function(skuId){if(ec.product.getSkuForFeature(skuId)!=undefined||$("#pro-detail-content-"+skuId).length>0){$("#pro-tab-parameter").removeClass("selected");$("#pro-tab-feature").addClass("selected").show();$("#pro-detail-contents").show();$("#pro-detail-content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();ec.product.payVideo();return}(new ec.ajax).get({url:"/product/querySkuDetailFeature/"+ec.product.getSku()+".json",timeout:1E4,timeoutFunction:function(){$("#pro-detail-contents \x3e div:first-child").html(timeOutInfo)},successFunction:function(json){if(!json.success){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-detail-contents").hide();return}if(json.length==0){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-tab-feature").hide();$("#pro-detail-contents").hide();return}$("#pro-tab-parameter").removeClass("selected");$("#pro-tab-feature").addClass("selected");$("#pro-tab-feature").show();$("#pro-detail-contents").show();ec.product.setSkuForFeature(skuId);var content=[];content.push('\x3cdiv id\x3d"pro-detail-content-'+json.id+'" class\x3d"pro-detail-see"\x3e');content.push('\x3cdiv id\x3d"kindPicture-'+json.id+'"\x3e');content.push(json.detail);content.push("\x3c/div\x3e");content.push('\x3cdiv id\x3d"detail-content-button-'+json.id+'" class\x3d"product-shade hide"\x3e\x3cp\x3e');content.push('\x3ca id\x3d"pro-detail-down-btn-'+json.id+'" class\x3d"product-detail-btn"\x3e');content.push("\u67e5\u770b\u5168\u90e8\u4ea7\u54c1\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e");content.push('\x3ca href\x3d"javascript:;" id\x3d"pro-detail-up-btn-'+json.id+'" class\x3d"product-detail-btnup hide"\x3e\u6536\u8d77\u5168\u90e8\u4ea7\u54c1\u8be6\u60c5\x3c/a\x3e');content.push("\x3c/div\x3e");var feature=$("#pro-tab-feature-content \x3e div:first-child");feature.prepend(content.join(""));if(masterPlayer)setTimeout(function(){masterPlayer.dispose()},300);ec.product.payVideo();$("#pro-detail-content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();var imgHeight=0;$("#pro-detail-content-"+(ec.product.setSkuId||skuId)+" img").each(function(index){$(this).load(function(){imgHeight=imgHeight+$(this).height();if(imgHeight>=2E3){$("#pro-detail-content-"+json.id).height("2000");$("#detail-content-button-"+json.id).show();$("#pro-detail-down-btn-"+json.id).click(function(){$("#pro-detail-content-"+json.id).height($("#kindPicture-"+json.id).height()+$("#pro-detail-up-btn-"+json.id).height()+40);$("#detail-content-button-"+json.id).hide();$("#pro-detail-up-btn-"+json.id).css("display","block");upDownButton="true"});$("#pro-detail-up-btn-"+json.id).click(function(){$("#pro-detail-content-"+json.id).height("2000");$("#detail-content-button-"+json.id).show();$("#pro-detail-up-btn-"+json.id).css("display","none");upDownButton="false";$("body,html").animate({scrollTop:tit1+1575},0)});return false}})});if(imgHeight<2E3)$("#detail-content-button-"+json.id).hide();ec.diypkg.init()},errorFunction:function(){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-detail-contents").hide()},timeoutFunction:function(){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-detail-contents").hide()}})};var masterPlayer;ec.product.payVideo=function(){var skuId=ec.product.getSku();var video=$("#pro-detail-content-"+skuId).find(".J_videoTrigger");$("#player-container-id").remove();if(video)if(!$("#pro-detail-content-"+skuId).find("video")||$("#pro-detail-content-"+skuId).find("video").length==0){var videoUrl=video.attr("data-video");if(videoUrl&&videoUrl!=""){video.find("span.video-btn").remove();video.append("\x3cspan class\x3d'video-btn'\x3e\x3c/span\x3e");var playerContainerId="player-container-id-"+skuId;video.unbind("click");video.click(function(){videoUrl=$(this).attr("data-video");var videoHtml='\x3cvideo id\x3d"'+playerContainerId+'" preload\x3d"auto"  playsinline webkit-playinline x5-playinline src\x3d"'+ec.autoEncodeAttr(videoUrl)+'"\x3e\x3c/video\x3e';var videoBox=(new ec.box(videoHtml,{boxid:"video-box",boxclass:"ol_box_4 video-detail",width:800,height:450,draggable:false,showButton:false,zIndex:700,onclose:function(dom){masterPlayer.dispose()}})).open();masterPlayer=TCPlayer(playerContainerId,{autoplay:true})})}}};ec.product.rushbuyActivity=function(countTemp){rush.business.doIfSbomChanged(countTemp)};ec.product.switched=function(value,thix){$("input[name\x3d'type']").valS(value);$(thix).addClass("selected").siblings().removeClass("selected")};ec.product.getParameter=function(skuIds,skuCodes){$("#parameterDetailTips").hide();if(ec.product.getSkuForParement(skuIds)!=undefined){$("#main-parameter-content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();$("#content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();$("#productParameterId").show();$("#productParameterHr30").show();return}var skuList=skuIds.split(",");var skuCodeList=skuCodes.split(",");var reqParam="";for(var i=0;i<skuCodeList.length;i+=1){reqParam+=skuCodeList[i];if(i==0)break}$.ajax({url:domainMain+"/product/querySpecificationMulti/"+reqParam+".json?",dataType:"json",timeout:2E4,success:function(json){if(!json.success){$("#parameterDetailTips").show();return}$("#parameterDetailTips").hide();ec.product.setSkuForParement(skuIds);for(var n=0;n<skuList.length;n+=1){var skuId=skuList[n];var sbomCode=skuCodeList[n];var attrs=null;var mainAttrs=null;for(var m=0;m<json.info.length;m+=1){var specificationInfo=json.info[m];if(sbomCode==specificationInfo.sbomCode){attrs=specificationInfo.specificationList;mainAttrs=specificationInfo.majorSpecificationList;break}}var mainHtml=[];if(mainAttrs!=null&&mainAttrs.length>0){var mainP;mainHtml.push("\x3ch2\x3e\u4e3b\u8981\u53c2\u6570\x3c/h2\x3e");mainHtml.push("\x3cul\x3e");for(var j=0;j<mainAttrs.length;j++){mainP=mainAttrs[j];if(mainP.attrValue!=null&&mainP.attrValue!=""&&mainP.attrValue!=undefined)mainHtml.push("\x3cli\x3e\x3clabel\x3e"+mainP.attrName+"\x3c/label\x3e\x3cspan\x3e"+mainP.attrValue+"\x3c/span\x3e\x3c/li\x3e")}mainHtml.push("\x3c/ul\x3e")}$("#product-parameter-main").append('\x3cdiv id\x3d"main-parameter-content-'+skuId+'" class\x3d"product-parameter-main clearfix hide"\x3e'+mainHtml.join("")+"\x3c/div\x3e");$("#main-parameter-content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();var html=[];if(attrs){var p;var html0=[];for(var i=0;i<attrs.length;i++){p=attrs[i];var html1=[];if("0"==p.parentAttrCode){html1.push('\x3cdiv class\x3d"product-parameter-list clearfix"\x3e');html1.push("\x3ch2\x3e"+p.attrName+"\x3c/h2\x3e");var code=p.attrCode;var html2=[];html2.push("\x3cul\x3e");for(var j=0;j<attrs.length;j++){var p2=attrs[j];if(p2.parentAttrCode!="0"&&p2.parentAttrCode==code)html2.push("\x3cli\x3e\x3clabel\x3e"+p2.attrName+"\x3c/label\x3e\x3cspan\x3e"+ec.autoEncodeAttr(p2.attrValue)+"\x3c/span\x3e\x3c/li\x3e")}html2.push("\x3c/ul\x3e");if(html2.length>2){html0.push(html1.join(""));html0.push(html2.join(""));html0.push("\x3c/div\x3e")}}}html0.push('\x3cdiv class\x3d"product-parameter-list clearfix"\x3e');html0.push("\x3ch2\x3e\u5546\u54c1\u7f16\u7801\x3c/h2\x3e");html0.push("\x3cul\x3e\x3cli\x3e\x3clabel\x3e"+sbomCode+"\x3c/label\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e");if(html0.length>0){html.push('\x3cdiv id\x3d"content-'+skuId+'" \x3e');html.push('\x3cdiv id\x3d"parameterContentButton-'+skuId+'" class\x3d"product-shade hide"\x3e');html.push('\x3cp\x3e\x3ca id\x3d"parameterDownButton-'+skuId+'"  href\x3d"javascript:;"  class\x3d"product-detail-btn"\x3e\u67e5\u770b\u5168\u90e8\u53c2\u6570\x3c/a\x3e\x3c/p\x3e');html.push("\x3c/div\x3e");html.push('\x3cdiv id\x3d"pro-tab-parameter-content-'+skuId+'" class\x3d"layout"\x3e');html.push('\x3cdiv id\x3d"parameter-content-'+skuId+'"\x3e');html.push(html0.join(""));html.push("\x3c/div\x3e");html.push("\x3c/div\x3e");html.push('\x3ca id\x3d"parameterUpButton-'+skuId+'" href\x3d"javascript:;" class\x3d"product-detail-btnup hide"\x3e\u6536\u8d77\u53c2\u6570\u8be6\u60c5\x3c/a\x3e');html.push("\x3c/div\x3e")}}$("#productDetailParameter").prepend(html.join(""));$("#content-"+(ec.product.setSkuId||skuId)).show().siblings().hide()}$("#productParameterId").show();$("#productParameterHr30").show();var sku=ec.product.getSku();sku=ec.product.getSkuInfo(sku);var detailHeight=$("#parameter-content-"+sku.id).height();if(detailHeight<=540&&detailHeight>0)$("#parameterContentButton-"+sku.id).removeClass("show").addClass("hide");else{$("#parameterContentButton-"+sku.id).removeClass("hide").addClass("show");$("#pro-tab-parameter-content-"+sku.id).css({"height":"540","overflow":"hidden"});$("#parameterDownButton-"+sku.id).click(function(){$("#pro-tab-parameter-content-"+sku.id).height($("#parameter-content-"+sku.id).height());$("#parameterContentButton-"+sku.id).removeClass("show").addClass("hide");$("#parameterUpButton-"+sku.id).removeClass("hide").addClass("show")});$("#parameterUpButton-"+sku.id).click(function(){$("#parameterContentButton-"+sku.id).removeClass("hide").addClass("show");$("#parameterUpButton-"+sku.id).removeClass("show").addClass("hide");$("#pro-tab-parameter-content-"+sku.id).height("540");$("body,html").animate({scrollTop:tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height()+270},0)})}},error:function(){$("#parameterDetailTips").show()}})};function stopConsultation(){$("#stopConsultationId").hide();$("#myConsultation").show();$("#upUserAdvisory").removeClass("show").addClass("hide")}ec.product.switchSku=function(){oTop=$(".product-tab").offset().top;clickFlag=false};ec.product.pagerScroll=function(id){$("#"+id+" li.link").click(function(){$("html, body").animate({scrollTop:$("#productAsk").offset().top-$("#product-tab").height()})})};ec.product.serverCommodity=function(id){var num=$("#"+id+" ul li").length,lineNum=Math.ceil((num-1)/2);liHeight=$("#"+id+" ul li").height();$("#"+id+" ul li").eq(0).css({"height":lineNum*24-6})};ec.product.scroll=function(id,num){var $div=$("#"+id).parent().parent();var len=$div.find(".swiper-slide").length;if(len<=num){$div.find(".swiper-button-prev").addClass("disabled");$div.find(".swiper-button-next").addClass("disabled")}else $div.find(".swiper-button-next").removeClass("disabled");var mySwiper=new Swiper("#"+id,{slidesPerView:num,slidesPerGroup:num});$div.find(".swiper-button-prev").click(function(){mySwiper.swipePrev()});$div.find(".swiper-button-next").click(function(){mySwiper.swipeNext()})};$(document).ready(function(){var c=$(".swiper-container"),a=[];c.each(function(f,g){var xid=$(this).attr("id");if(!(""+xid).startsWith("omb-pro-"))a.push(xid)});$.each(a,function(f,g){var totalLen=$("#"+g).find(".swiper-slide").length;if(totalLen<=5){$("#"+g).parent().find(".swiper-button-prev").hide();$("#"+g).parent().find(".swiper-button-next").hide()}else $("#"+g).find(".swiper-button-next").show();var mySwiper=new Swiper("#"+g,{slidesPerView:2,slidesPerGroup:2});$("#"+g).parent().find(".btn-prev").click(function(){mySwiper.swipePrev()});$("#"+g).parent().find(".btn-next").click(function(){mySwiper.swipeNext()})});$("#pro-relation-scroll").find("li").mousedown(function(){return false})});function pushProHistoryMsg(productId,column){ec.dapClick(300020801,{"SKUCode":productId,"click":"1"})}function pushProGiftBuySerMsg(){var skucode=$("#pro-sku-code").val();ec.dapClick(300021001,{"selectGiftbuy":"1","SKUCode":skucode,"click":"1"})}function checkedThis(obj,id,cname,idName){var boxArray=document.getElementsByName(cname);var flag=false;var checkBoxObj=$(obj).children("input:first-child")[0];if($("#"+id).hasClass("red")){checkBoxObj.checked=false;$("#"+idName).parent().parent().removeClass("hover")}else for(var i=0;i<=boxArray.length-1;i++){if(boxArray[i]==checkBoxObj){boxArray[i].checked=true;if(idName=="extendProtected"||idName=="accidentProtected"){$('#ucareProtected input[type\x3d"checkbox"]').removeAttr("checked");$("#ucareProtected .product-service-listcon.red").removeClass("red");$("#ucareProtected").parent().parent().removeClass("selected");$("#ucareSelect").attr("data-scode","");$("#ucareSelect").attr("skuid","");$("#ucare-selected").remove()}if(idName=="ucareProtected"){$('#extendProtected input[type\x3d"checkbox"]').removeAttr("checked");$("#extendProtected .product-service-listcon.red").removeClass("red");$("#extendProtected").parent().parent().removeClass("selected");$('#accidentProtected input[type\x3d"checkbox"]').removeAttr("checked");$("#accidentProtected .product-service-listcon.red").removeClass("red");$("#accidentProtected").parent().parent().removeClass("selected");$("#extendSelect").attr("data-scode","");$("#accidentSelect").attr("data-scode","");$("#extendSelect").attr("skuid","");$("#accidentSelect").attr("skuid","");$("#extend-selected").remove();$("#accident-selected").remove()}}else boxArray[i].checked=false;$("#extendProtected").parent().parent().removeClass("hover");$("#accidentProtected").parent().parent().removeClass("hover");$("#ucareProtected").parent().parent().removeClass("hover")}if($("input[name\x3d"+cname+"]:checked").length==0){$("#"+id).removeClass("red");$("#"+idName).parent().parent().removeClass("selected");var selectNo=$("#"+idName).parent().parent().find("span").eq(0).attr("id");$("#"+selectNo).html("");$("#"+selectNo).attr("skuid","");$("#"+selectNo).attr("data-scode","");if(idName=="extendProtected")$("#extend-selected").remove();if(idName=="accidentProtected")$("#accident-selected").remove();if(idName=="ucareProtected")$("#ucare-selected").remove()}else{var attrSelectService=[];if($("#"+id).hasClass("red"))$("#"+id).removeClass("red");if(idName=="extendProtected"){$("#extendProtected").parent().parent().find("a").eq(0).remove();var productId=$("#"+id).attr("id"),name=$("#"+id).attr("title");name=ec.autoEncodeAttr(name);$("#extendSelect").textS(name);$("#extendSelect").attr("skuid",$("#"+id).attr("skuID"));$("#extendSelect").attr("data-scode",$("#"+id).attr("data-scode"));$("#extendSelect").attr("interest-price",$("#"+id).attr("data-price"));var textName='\x3cspan class\x3d"fl max-w"\x3e'+name+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+$("#"+id).attr("data-price")+"\x3c/span\x3e";$("#extendProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+textName+"\x3c/a\x3e");$("#extendProtected").parent().parent().addClass("selected");$("#"+id).addClass("red");$("#extendProtected ul li .product-service-listcon").not("#"+id).removeClass("red");$("#extend-selected").remove();var temp1=$("#extendSelect").text();temp1=ec.autoEncodeAttr(temp1);if(temp1!=""){attrSelectService.push('\x3cdiv id\x3d"extend-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;'+temp1+"\x3c/div\x3e");var selected_attributes=$("#pro-select-sku").html();$("#pro-select-sku").html(selected_attributes+attrSelectService.join(""))}}if(idName=="accidentProtected"){$("#accidentProtected").parent().parent().find("a").eq(0).remove();var productId=$("#"+id).attr("id"),name=$("#"+id).attr("title");name=ec.autoEncodeAttr(name);$("#accidentSelect").textS(name);$("#accidentSelect").attr("skuid",$("#"+id).attr("skuID"));$("#accidentSelect").attr("data-scode",$("#"+id).attr("data-scode"));$("#accidentSelect").attr("interest-price",$("#"+id).attr("data-price"));var textName='\x3cspan class\x3d"fl max-w"\x3e'+name+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+$("#"+id).attr("data-price")+"\x3c/span\x3e";$("#accidentProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+textName+"\x3c/a\x3e");$("#accidentProtected").parent().parent().addClass("selected");$("#"+id).addClass("red");$("#accidentProtected ul li .product-service-listcon").not("#"+id).removeClass("red");$("#accident-selected").remove();var temp2=$("#accidentSelect").text();temp2=ec.autoEncodeAttr(temp2);if(temp2!=""){attrSelectService.push('\x3cdiv id\x3d"accident-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;'+temp2+"\x3c/div\x3e");var selected_attributes=$("#pro-select-sku").html();$("#pro-select-sku").html(selected_attributes+attrSelectService.join(""))}}if(idName=="ucareProtected"){$("#ucareProtected").parent().parent().find("a").eq(0).remove();var productId=$("#"+id).attr("id"),name=$("#"+id).attr("title");name=ec.autoEncodeAttr(name);$("#ucareSelect").textS(name);$("#ucareSelect").attr("skuid",$("#"+id).attr("skuID"));$("#ucareSelect").attr("data-scode",$("#"+id).attr("data-scode"));$("#ucareSelect").attr("interest-price",$("#"+id).attr("data-price"));var textName='\x3cspan class\x3d"fl max-w"\x3e'+name+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+$("#"+id).attr("data-price")+"\x3c/span\x3e";$("#ucareProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+textName+"\x3c/a\x3e");$("#ucareProtected").parent().parent().addClass("selected");$("#"+id).addClass("red");$("#ucareProtected ul li .product-service-listcon").not("#"+id).removeClass("red");$("#ucare-selected").remove();var temp2=$("#ucareSelect").text();temp2=ec.autoEncodeAttr(temp2);if(temp2!=""){attrSelectService.push('\x3cdiv id\x3d"ucare-selected" class\x3d"inline"\x3e\x26nbsp;/\x26nbsp;'+temp2+"\x3c/div\x3e");var selected_attributes=$("#pro-select-sku").html();$("#pro-select-sku").html(selected_attributes+attrSelectService.join(""))}}}ec.product.interest.queryFreeDetail();ec.product.refreshStyle()}ec.product.click_function=function(dom){var domIdName=$(dom).parent().find(".product-service-list").attr("id");$(dom).parent().data("flag","1");$("#"+domIdName).parent().parent().removeClass("hover");if($(dom).parent().hasClass("selected")){$(dom).parent().removeClass("selected");$(dom).parent().find("p").removeClass("red");var select_no=$(dom).parent().find("span").eq(0).attr("id");$("#"+select_no).attr("skuid","");$("#"+select_no).attr("data-scode","");$("#"+select_no).attr("interest-price","");if(domIdName=="extendProtected"){$("#extendProtected").parent().parent().find("a").eq(0).remove();$("#extendProtected ul").find("li").find("input").prop("checked",false);$("#extendProtected ul").find("li").find(".product-service-listcon").removeClass("red");$("#extend-selected").remove();var tempE=$("#extendProtected ul").find("li").eq(0).find(".product-service-listcon");var extend_name='\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(tempE.attr("title"))+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+tempE.attr("data-price")+"\x3c/span\x3e";$("#extendProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+extend_name+"\x3c/a\x3e")}if(domIdName=="accidentProtected"){$("#accidentProtected").parent().parent().find("a").eq(0).remove();$("#accidentProtected ul").find("li").find("input").prop("checked",false);$("#accidentProtected ul").find("li").find(".product-service-listcon").removeClass("red");$("#accident-selected").remove();var tempA=$("#accidentProtected ul").find("li").eq(0).find(".product-service-listcon");var accident_name='\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(tempA.attr("title"))+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+tempA.attr("data-price")+"\x3c/span\x3e";$("#accidentProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+accident_name+"\x3c/a\x3e")}if(domIdName=="ucareProtected"){$("#ucareProtected").parent().parent().find("a").eq(0).remove();$("#ucareProtected ul").find("li").find("input").prop("checked",false);$("#ucareProtected ul").find("li").find(".product-service-listcon").removeClass("red");$("#ucare-selected").remove();var tempA=$("#ucareProtected ul").find("li").eq(0).find(".product-service-listcon");var ucare_name='\x3cspan class\x3d"fl max-w"\x3e'+ec.autoEncodeAttr(tempA.attr("title"))+'\x3c/span\x3e\x3cspan class\x3d"fl"\x3e\x26nbsp;\uffe5'+tempA.attr("data-price")+"\x3c/span\x3e";$("#ucareProtected").parent().before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.click_function(this)" class\x3d"product-service-btn"\x3e'+ucare_name+"\x3c/a\x3e")}ec.product.interest.queryFreeDetail()}};ec.product.newpackageView=function(dom,packageCode,skuCode){var proPriceHtml=[];var sku=ec.product.getSku();var skuInfo=ec.product.getSkuInfo(sku);ec.product.packageViewChange(dom,packageCode);$("#packageCode").valS(packageCode);$("#packageList").html("");_giftBuyItemId=[];if(packageCode==null){if($("#giftBuy_dl").length>0){if($("#giftBuy_dl").hasClass("hide"))$("#giftBuy_dl").removeClass("hide");$.each($("#giftBuy_dl").find("li"),function(){if($(this).attr("data-attrname")&&$(this).attr("data-attrname").transHtmlAttribute()=="\u65e0\u589e\u503c\u670d\u52a1"){$(this).addClass("selected");$("#giftBuy-selected").html("/ \u65e0\u589e\u503c\u670d\u52a1")}});if($("#pro-operation").find("a").length==2&&$("#pro-operation").find("a").first().find("span").html()=="\u52a0\u5165\u8d2d\u7269\u8f66")$("#pro-operation").find("a").first().attr("onclick","").click(function(){ec.product.addCart()});if($("#pro-operation").find("a").length==1&&$("#pro-operation").find("a").first().find("span").html()=="\u7acb\u5373\u4e0b\u5355"){$("#pro-operation").attr("data-gift",0);$("#pro-operation").find("a").before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01"\x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e')}}if(skuInfo.price!=skuInfo.originPrice){$("#pro-price-label").html("\u62a2\u8d2d\u4ef7");$("#pro-price-label").removeClass("f24").addClass("type");$("#pro-price").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+parseFloat(skuInfo.price).toFixed(2));$("#pro-price-old").html("\x26yen;\x26nbsp;"+parseFloat(skuInfo.originPrice).toFixed(2));$("#pro-price-label").show();$("#pro-price").show();$("#pro-price-old").show()}else{$("#pro-price-label").hide();$("#pro-price").html("\x3cem\x3e\u00a5\x3c/em\x3e"+parseFloat(skuInfo.originPrice).toFixed(2)+"")}if(Number(skuInfo.price)>0)$("#pro-price").show();else{$("#pro-price-label").text("\u6682\u65e0\u62a5\u4ef7");$("#pro-price").hide()}ec.product.showTips();ec.product.processSupportDisplayDilieryTime(skuInfo);ec.product.interest.queryFreeDetail();ec.diypkg.init();return}else ec.diypkg.hide();ec.product.hiddenTips();if($("#giftBuy_dl").length>0){if(!$("#giftBuy_dl").hasClass("hide"))$("#giftBuy_dl").addClass("hide");$("#giftBuy_dl").find("li").removeClass("selected");$("#giftBuy-selected").html("");if($("#pro-operation").find("a").length==2&&$("#pro-operation").find("a").first().find("span").html()=="\u52a0\u5165\u8d2d\u7269\u8f66")$("#pro-operation").find("a").first().attr("onclick","").click(function(){ec.product.addCart()});if($("#pro-operation").find("a").length==1&&$("#pro-operation").find("a").first().find("span").html()=="\u7acb\u5373\u4e0b\u5355"){$("#pro-operation").attr("data-gift",0);$("#pro-operation").find("a").before('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.addCart()" class\x3d"product-button01"\x3e\x3cspan\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/span\x3e\x3c/a\x3e')}}var pro_sbomList=skuInfo.pro_sbomList;var new_package="";var newpackage="";for(var i=0;i<pro_sbomList.length;i++)if(skuCode==pro_sbomList[i].sbomCode){new_package=pro_sbomList[i].sbomPackageList;break}if(new_package!=""&&new_package.length>0)for(var o=0;o<new_package.length;o++)if(packageCode==new_package[o].packageCode){newpackage=new_package[o];break}var newpackageListHtml=[];var prdId=$("#product_productId").val();if(newpackage!=""&&newpackage!=null){newpackageListHtml.push('\x3cdiv class\x3d"product-recommend product-package-mini"\x3e');newpackageListHtml.push('\x3cdiv class\x3d"product-recommend-con clearfix"\x3e');newpackageListHtml.push('\x3cdiv class\x3d"product-recommend-main"\x3e');newpackageListHtml.push('\x3cdiv class\x3d"product-recommend-thumbs"\x3e');newpackageListHtml.push('\x3cul class\x3d"clearfix"\x3e');newpackageListHtml.push('\x3cli\x3e \x3ca\x3e \x3cimg src\x3d"'+ec.mediaPath+skuInfo.photoPath+"100_100_"+skuInfo.photoName+'"\x3e');newpackageListHtml.push('\x3cp title\x3d"'+skuInfo.name+'"\x3e'+skuInfo.name+"\x3c/p\x3e");newpackageListHtml.push("\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e");var sbomPackageInfo=newpackage.packageList;if(sbomPackageInfo!=""&&sbomPackageInfo.length>0){newpackageListHtml.push('\x3cdiv class\x3d"goods-rolling product-recommend-detail"\x3e');newpackageListHtml.push('\x3cdiv id\x3d"btn-prev" class\x3d"grid-btn btn-prev disabled"\x3e');newpackageListHtml.push("\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");newpackageListHtml.push('\x3cdiv id\x3d"btn-next" class\x3d"grid-btn btn-next"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e');newpackageListHtml.push('\x3cdiv id\x3d"goodsRecommend-recommend" class\x3d"swiper-container product-recommend-thumbs"\x3e');newpackageListHtml.push('\x3cul class\x3d" swiper-wrapper clearfix" style\x3d"width: 1000px;"\x3e');for(var j=0;j<sbomPackageInfo.length;j++){newpackageListHtml.push('\x3cli class\x3d"swiper-slide" attr-packageSkuCode\x3d"'+sbomPackageInfo[j].sbomCode+'"\x3e\x3ca href\x3d"/product/'+sbomPackageInfo[j].disPrdId+'.html" target\x3d"_blank"\x3e\x3cimg src\x3d"'+ec.mediaPath+sbomPackageInfo[j].photoPath+"100_100_"+sbomPackageInfo[j].photoName+'"\x3e');newpackageListHtml.push('\x3cp title\x3d"'+sbomPackageInfo[j].sbomName+'"\x3e'+sbomPackageInfo[j].sbomName+"\x3c/p\x3e\x3c/a\x3e");var GbomAttr=sbomPackageInfo[j].gbomAttrList;if(GbomAttr!=""&&GbomAttr.length>0){newpackageListHtml.push('\x3cdl class\x3d"color clearfix"\x3e');for(var p=0;p<GbomAttr.length;p++){if(p==0)newpackageListHtml.push('\x3cdd class\x3d"selected"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.packageChangeColor(this)" attr-name\x3d"'+sbomPackageInfo[j].sbomName+'" attr-imgSrc\x3d"'+ec.mediaPath+sbomPackageInfo[j].photoPath+"100_100_"+sbomPackageInfo[j].photoName+'" attr-prdId\x3d"'+sbomPackageInfo[j].disPrdId+'" attr-packageSkuCode\x3d"'+sbomPackageInfo[j].sbomCode+'"\x3e'+GbomAttr[p].attrValue+"\x3c/a\x3e\x3c/dd\x3e");else newpackageListHtml.push('\x3cdd\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.packageChangeColor(this)" attr-name\x3d"'+sbomPackageInfo[j].sbomName+'" attr-imgSrc\x3d"'+ec.mediaPath+sbomPackageInfo[j].photoPath+"100_100_"+sbomPackageInfo[j].photoName+'" attr-prdId\x3d"'+sbomPackageInfo[j].disPrdId+'" attr-packageSkuCode\x3d"'+sbomPackageInfo[j].sbomCode+'"\x3e'+GbomAttr[p].attrValue+"\x3c/a\x3e\x3c/dd\x3e");if(j!=sbomPackageInfo.length-1){var k=j;for(var t=1;t<sbomPackageInfo.length-k;t++)if(sbomPackageInfo[k].disPrdId==sbomPackageInfo[k+t].disPrdId){GbomAttr=sbomPackageInfo[k+t].gbomAttrList;newpackageListHtml.push('\x3cdd\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.packageChangeColor(this)" attr-name\x3d"'+sbomPackageInfo[k+t].sbomName+'" attr-imgSrc\x3d"'+ec.mediaPath+sbomPackageInfo[k+t].photoPath+"100_100_"+sbomPackageInfo[k+t].photoName+'" attr-prdId\x3d"'+sbomPackageInfo[k+t].disPrdId+'" attr-packageSkuCode\x3d"'+sbomPackageInfo[k+t].sbomCode+'"\x3e'+GbomAttr[0].attrValue+"\x3c/a\x3e\x3c/dd\x3e");j=k+t}}}newpackageListHtml.push("\x3c/dl\x3e\x3c/li\x3e")}}newpackageListHtml.push("\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")}var savingPrice=(newpackage.totalPrice-newpackage.packageTotalPrice).toFixed(2);newpackageListHtml.push('\x3cdiv class\x3d"product-package-mini-tool clearfix"\x3e');newpackageListHtml.push('\x3cp\x3e\x3cspan class\x3d"f14"\x3e\u5957\u9910\u4ef7\uff1a\x3c/span\x3e\x3cstrong class\x3d"red"\x3e\uffe5'+newpackage.packageTotalPrice+'\x3c/strong\x3e\x3cspan class\x3d"save"\x3e \x3cstrong\x3e\u7701\x3c/strong\x3e\x3cem\x3e\uffe5'+savingPrice+"\x3c/em\x3e \x3c/span\x3e\x3c/p\x3e");newpackageListHtml.push('\x3cdiv class\x3d"fr"\x3e\x3ca href\x3d"#" class\x3d"product-package-mini-btn product-button02" onclick\x3d"ec.product.buyBundle(1,this)"\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/a\x3e\x3c/div\x3e');newpackageListHtml.push("\x3c/div\x3e\x3c/div\x3e")}$("#packageList").html(newpackageListHtml.join(""));ec.product.packageGetSkuCode();$("#pro-price-label").html("\u5957\u9910\u4ef7");$("#pro-price-label").removeClass("f24").addClass("type");$("#pro-price-label").show();$("#pro-price").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+newpackage.packageTotalPrice).show();$("#pro-price-old").hide();ec.product.newPackageSwiper();ec.product.interest.queryFreeDetail()};ec.product.packageViewChange=function(dom,packageCode,type){if($(dom).parent().parent().hasClass("selected"))if($(dom).parent().parent().hasClass("click")){$(dom).parent().parent().removeClass("click");if(type=="gift")$("#giftPackageList").addClass("hide");else $("#packageList").addClass("hide")}else if(type=="gift"){$(dom).parent().parent().parent().find("li").removeClass("click");$(dom).parent().parent().addClass("click");$("#giftPackageList").removeClass("hide")}else if(packageCode==null){$("#packageList").html("");return}else{$(dom).parent().parent().addClass("click");$("#packageList").removeClass("hide")}else{$(dom).parent().parent().parent().find("li").removeClass("selected click");if(type=="gift"){$(dom).parent().parent().addClass("selected click");$("#giftPackageList").removeClass("hide")}else{if(packageCode==null){$(dom).parent().parent().addClass("selected");$("#packageList").html("");$("#packageCode").val("");$("#packageListCode").val("")}else{$(dom).parent().parent().addClass("selected click");$("#packageList").removeClass("hide")}$("#package-selected").html();$("#package-selected").textS("\x26nbsp;/\x26nbsp;"+$(dom).parent().parent().attr("data-attrname"))}}};$(document).on("click",function(e){if($(e.target).closest("div.sku").length>0)return;if(!($("#package_dl").length>0)&&!$("#bundlePackage").length>0)return;if(!$("#packageList").hasClass("hide"))if($(e.target).parents("#packageList").length>0||$(e.target).parents("#packageSelect").length>0)return;else{if($("#packageList").hasClass("hide"))return;$("#packageSelect").find(".click").removeClass("click");$("#packageList").addClass("hide");ec.product.packageGetSkuCode()}if(!$("#giftPackageList").hasClass("hide"))if($(e.target).parents("#giftPackageList").length>0||$(e.target).parents("#bundlePackageSelect").length>0)return;else{if($("#giftPackageList").hasClass("hide"))return;$("#bundlePackageSelect").find(".click").removeClass("click");$("#giftPackageList").addClass("hide");ec.product.packageGetSkuCode("gift")}});ec.product.packageChangeColor=function(dom,type){if($(dom).parent().hasClass("selected"))return;else{$(dom).parent().parent().find("dd").removeClass("selected");$(dom).parent().addClass("selected");ec.product.packageGetSkuCode(type)}};ec.product.packageGetSkuCode=function(type){var packageListCode=[];var giftPackageListCode=[];if(type=="gift"){$("#bundlePackageSelect").find("ul").find("dl").find(".selected").find("a").each(function(){if($(this).attr("attr-packageskucode")!=""){$(this).parent().parent().parent().attr("attr-packageskucode",$(this).attr("attr-packageskucode"));$(this).parent().parent().parent().find("img").attr("src",$(this).attr("attr-imgSrc"));$(this).parent().parent().parent().find("p").attr("title",$(this).attr("attr-name"));$(this).parent().parent().parent().find("p").text($(this).attr("attr-name"))}});$("#goodsRecommend-recommend-gift").find("li").each(function(){giftPackageListCode.push($(this).attr("attr-packageskucode"))});var skuId=$("#bundlePackageSelect").find(".product-recommend-main").find("a").attr("sku-id");ec.product.gift.packageGiftMap[skuId]=giftPackageListCode}else{$("#packageSelect").find("ul").find("dl").find(".selected").find("a").each(function(){if($(this).attr("attr-packageskucode")!=""){$(this).parent().parent().parent().attr("attr-packageskucode",$(this).attr("attr-packageskucode"));$(this).parent().parent().parent().find("img").attr("src",$(this).attr("attr-imgSrc"));$(this).parent().parent().parent().find("p").attr("title",$(this).attr("attr-name"));$(this).parent().parent().parent().find("p").text($(this).attr("attr-name"))}});$("#goodsRecommend-recommend").find("li").each(function(){packageListCode.push($(this).attr("attr-packageskucode"))});$("#packageListCode").valS(packageListCode)}};ec.product.newPackageSwiper=function(id){if(id==null||typeof id=="undefined")id="";var totalLen=$("#goodsRecommend-recommend"+id).find(".swiper-slide").length;if(totalLen<=2){$("#btn-prev"+id).addClass("disabled");$("#btn-next"+id).addClass("disabled")}else $("#btn-next"+id).removeClass("disabled");var mySwiper=new Swiper("#goodsRecommend-recommend"+id,{slidesPerView:2,slidesPerGroup:2});$("#btn-prev"+id).click(function(){mySwiper.swipePrev();ec.product.showSwiper(id)});$("#btn-next"+id).click(function(){mySwiper.swipeNext();ec.product.showSwiper(id)})};ec.product.showSwiper=function(id){var slideLen=$("#goodsRecommend-recommend"+id).find("li").length;$.each($("#goodsRecommend-recommend"+id).find("li"),function(index,obj){if(index==0&&$(obj).hasClass("swiper-slide-visible"))$("#btn-prev"+id).addClass("disabled");else if(index==0&&!$(obj).hasClass("swiper-slide-visible"))$("#btn-prev"+id).removeClass("disabled");if(index==slideLen-1&&$(obj).hasClass("swiper-slide-visible"))$("#btn-next"+id).addClass("disabled");else if(index==slideLen-1&&!$(obj).hasClass("swiper-slide-visible"))$("#btn-next"+id).removeClass("disabled")})};ec.product.hidebundleView=function(){if($("#bundlePackage").length>0&&$("#bundlePackage").find("li").length>1)return;else if($("#bundlePackage").find("li").length==1)$("#bundlePackage").addClass("hide")};ec.product.showCmbSelector=function(list,hbList){$("#hbShow").css("float","left").css("margin-right","10px");$("#hlShow").css("margin-right","10px");if(list.length>0){var sku=ec.product.getSkuInfo(ec.product.getSku());if(hbList&&hbList.length>0){var promotionTxt="";if(sku.promotionLst&&sku.promotionLst.length>0)sku.promotionLst.forEach(function(v){if("\x26#x5206;\x26#x671f;\x26#x514d;\x26#x606f;"===v.promoLabel||"\u5206\u671f\u514d\u606f"===v.promoLabel)promotionTxt=v.ruleDescription});promotionTxt=promotionTxt.transHtmlAttribute();if(promotionTxt&&promotionTxt.indexOf("\u82b1\u5457")>promotionTxt.indexOf("\u638c\u4e0a")){$("#hbShow").css("float","right").css("margin-right","0");$("#hlShow").css("margin-right","0");$("#hbShow").parent().css("width",$("#hbShow").width()+$("#hlShow").width()+10+"px")}}$("#hlShow").show();var defSelect=0;for(var i=0;i<list.length;i++){if("undefined"===typeof list[i].flag)list[i].flag=list[i].installmentFlag;if(list[i].flag>0&&list[i].num>defSelect)defSelect=list[i].num}var htmlHLShow=[];for(var i=0;i<list.length;i++){if(defSelect===list[i].num){$("#interestPayHLNow").removeClass("disabled");htmlHLShow.push('\x3cli class\x3d"selected"\x3e')}else htmlHLShow.push("\x3cli\x3e");htmlHLShow.push('\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.interest.checkOne(this);" interest-info\x3d"2:'+list[i].num+'"\x3e');htmlHLShow.push('\x3cp class\x3d"price"\x3e\x26yen;\x26nbsp;'+list[i].amount+"\x3cem\x3ex\x3c/em\x3e"+list[i].num+"\u671f\x3c/p\x3e");if(list[i].flag==0)htmlHLShow.push("\x3cp\x3e\u624b\u7eed\u8d39\x26yen;"+list[i].fee+"/\u671f\x3c/p\x3e\x3c/a\x3e\x3c/li\x3e");else htmlHLShow.push('\x3cp class\x3d"red"\x3e\u514d\u606f\uff0c0\u624b\u7eed\u8d39\x3c/p\x3e\x3c/a\x3e\x3c/li\x3e')}$("#hlDetail").find("ul").html(htmlHLShow.join(""));$("#hlShow").find(".sku").unbind("mouseover");$("#hlShow").unbind("mouseleave");$("#hlShow").find(".sku").mouseover(function(){if(!$("#hlShow").hasClass("click")){$("#hlDetail").show();$("#hlShow").addClass("click")}});$("#hlShow").mouseleave(function(e){if(!e.relatedTarget)return;$("#hlDetail").hide();$("#hlShow").removeClass("click")})}else{$("#hlShow").hide();$("#hlDeatil").hide()}};ec.product.showSbomInterest=function(sku){ec.product.inventory.wait(function(){var showCart=true;if($("#pro-operation").css("visibility")=="hidden")showCart=false;$("#interestOrderNow").val("");$("#interestOrderNow2").val("");if(showCart&&(sku.buttonMode=="1"||sku.buttonMode=="3"||sku.buttonMode=="10")&&$("#pro-operation a:first-child").text()=="\u52a0\u5165\u8d2d\u7269\u8f66"&&!$("#pro-operation a:first-child").hasClass("disabled")||ec.product.productType=="9"&&(sku.buttonMode=="12"||sku.buttonMode=="18")||$("#pro-operation").find("span.product-button-tips").text()=="\u9650\u65f6\u62a2\u8d2d\u8fdb\u884c\u4e2d"){$("#prd-noInterset").attr("interest-allow","1");var buttonNowInterest=$("#pro-operation a:first-child").text();if(buttonNowInterest!="\u52a0\u5165\u8d2d\u7269\u8f66"){$("#prd-noInterset").attr("interest-button","0");if(ec.product.productType=="9"&&(sku.buttonMode=="12"||sku.buttonMode=="18")&&buttonNowInterest=="\u7acb\u5373\u4e0b\u5355")$("#prd-noInterset").attr("interest-button","1")}$("#hbShow").removeClass("selected click");$("#hlShow").removeClass("selected click");if(!$("#interestHBPayNow").hasClass("disabled"))$("#interestHBPayNow").addClass("disabled");if(!$("#interestPayHLNow").hasClass("disabled"))$("#interestPayHLNow").addClass("disabled");if(sku.hbInterestLst.length>0||sku.hlInterestLst.length>0){var hbList=[];var handLifeList=[];$("#prd-noInterset").removeClass("hide");$("#hbDetail").hide();$("#hlDetail").hide();$("#hbShow").hide();$("#hlShow").hide();if(sku.hbInterestLst.length>0){$("#hbShow").show();var htmlHBShow=[];for(var i=0;i<sku.hbInterestLst.length;i++){htmlHBShow.push('\x3cli\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.product.interest.checkOne(this);" interest-info\x3d"1:'+sku.hbInterestLst[i].num+'"\x3e');htmlHBShow.push('\x3cp class\x3d"price"\x3e\x26yen;\x26nbsp;'+sku.hbInterestLst[i].amount+"\x3cem\x3ex\x3c/em\x3e"+sku.hbInterestLst[i].num+"\u671f\x3c/p\x3e");if(sku.hbInterestLst[i].flag==0)htmlHBShow.push("\x3cp\x3e\u624b\u7eed\u8d39\x26yen;"+sku.hbInterestLst[i].fee+"/\u671f\x3c/p\x3e\x3c/a\x3e\x3c/li\x3e");else htmlHBShow.push('\x3cp class\x3d"red"\x3e\u514d\u606f\uff0c0\u624b\u7eed\u8d39\x3c/p\x3e\x3c/a\x3e\x3c/li\x3e')}$("#hbDetail").find("ul").html(htmlHBShow.join(""));$("#hbShow").find(".sku").unbind("mouseover");$("#hbShow").unbind("mouseleave");$("#hbShow").find(".sku").mouseover(function(){$("#hbDetail").show();$("#hbShow").addClass("click")});$("#hbShow").mouseleave(function(e){if(!e.relatedTarget)return;$("#hbDetail").hide();$("#hbShow").removeClass("click")})}else{$("#hbShow").hide();$("#hbDetail").hide()}ec.product.showCmbSelector(sku.hlInterestLst,sku.hbInterestLst);if($("#prd-noInterset").attr("interest-button")=="0"){$("#interestHBPayNow").each(function(){$(this).addClass("disabled");this.backup=this.onclick;this.onclick=""});$("#interestPayHLNow").each(function(){$(this).addClass("disabled");this.backup=this.onclick;this.onclick=""})}}else{if(!$("#prd-noInterset").hasClass("hide"))$("#prd-noInterset").addClass("hide");$("#hbDetail").find("ul").html("");$("#hlDetail").find("ul").html("")}}else{$("#prd-noInterset").attr("interest-allow","0");$("#hbDetail").find("ul").html("");$("#hlDetail").find("ul").html("");if(!$("#prd-noInterset").hasClass("hide"))$("#prd-noInterset").addClass("hide")}})};ec.pkg("ec.diypkg");ec.load({url:scriptPath+"/common/base/lodash.min.js",type:"js"});ec.diypkg.valid=function(){ec.diypkg.selected=[];ec.diypkg.data.groupList.forEach(function(g,idx){var gc={groupId:g.groupId,groupName:g.groupName,minQuantiry:g.minQuantiry,maxQuantity:g.maxQuantity,chked:0,data:[]};g.packageList.forEach(function(v){var sCode=ec.diypkg.res.chked[g.groupId+"_"+v.disPrdId];if(sCode&&v.sbomCode==sCode){gc.chked++;gc.data.push(v.sbomCode)}});ec.diypkg.selected.push(gc)});return true};ec.diypkg.addCart=function(thix){if(!ec.diypkg.valid())return false;var temp=ec.product.finalGift();paras={salePortal:1,saleChannel:1001,needResultset:0,cartjson:temp.cartjson};paras.cartjson=JSON.parse(paras.cartjson);paras.cartjson.itemType="DP";paras.cartjson.attrs=paras.cartjson.attrs||{};paras.cartjson.attrs.dp_package_code=ec.diypkg.data.packageCode;ec.diypkg.selected.forEach(function(g){g.data.forEach(function(itemCode){paras.cartjson.subs.push({itemCode:itemCode,itemType:"DP",qty:paras.cartjson.qty,attrs:{dp_group:g.groupId}})})});ec.product.disableAddCartButtons();var buyNumber=parseInt($("#pro-quantity").val()),cartNUmber=parseInt($("#header-cart-total").html());ec.minicart.setNum(cartNUmber+buyNumber);ec.cart.add(paras,{successFunction:function(json){if(json.resultCode==2E5){var cartText="\u81ea\u9009\u5957\u9910\u5df2\u6210\u529f\u52a0\u5165\u8d2d\u7269\u8f66!";var computeRes=ec.product.compute($("#pro-add-success-mask"),cartText);if(computeRes.h>27)$("#cart-tips").find("p").parent().removeClass("box-right-1").addClass("box-right-2");else $("#cart-tips").find("p").parent().removeClass("box-right-2").addClass("box-right-1");$("#cart-tips").find("p").textS(cartText);$(".pro-add-success-total").hide();ec.minicart.setNum(json.cartNumber);var box=(new ec.box($("#cart-tips").html(),{boxclass:"ol_box_4",showButton:false})).open()}ec.product.enableAddCartButtons()},errorFunction:function(json){var box=(new ec.box('\x3cdiv class\x3d"box-errors-1"\x3e\x3cspan\x3e'+json.msg+"\x3c/span\x3e\x3c/div\x3e",{boxclass:"ol_box_4",showButton:true})).open();ec.product.enableAddCartButtons()}})};ec.diypkg.order=function(thix){if(!ec.diypkg.valid())return false;ec.account.afterLogin(function(){var skusListArr=$("#pro-skus").find("dl").not($("#giftPackageList").find("dl")).not($("#packageList").find("dl"));for(p=0;p<skusListArr.length;p++){var flag=false;var skuInfoArr=skusListArr.get(p);$(skuInfoArr).children(".product-choose-detail").children("ul").find("li").each(function(index){if($(this).parents("#giftPackageList").length>0||$(this).parents("#packageList").length>0)return true;if($(this).hasClass("selected")){flag=true;return}});if(!flag){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var orderItemReqArgList=[];var orderitem={};orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=$("#pro-quantity").val();orderitem.itemType="S0";if(ec.product.productType==9)orderitem.itemType="S9";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();var gifts2Order=[];if(finalGift)for(var key in finalGift){var aGift={"sbomCode":finalGift[key].giftSkuCode};gifts2Order.push(aGift)}if(ec.product.gift.packageGiftMap[skuIds])for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={"sbomCode":ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}orderitem.gifts=gifts2Order;orderitem.subOrderItemReqArgs=[];orderitem.subOrderItemReqArgs=ec.product.subServices(orderitem.subOrderItemReqArgs);orderitem.itemType="DP";orderitem.itemProp=orderitem.itemProp||{};orderitem.itemProp.dp_package_code=ec.diypkg.data.packageCode;ec.diypkg.selected.forEach(function(g){g.data.forEach(function(itemCode){orderitem.subOrderItemReqArgs.push({itemId:itemCode,itemType:"DP",qty:orderitem.qty,itemProp:{dp_group:g.groupId}})})});orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);var input='\x3cinput name\x3d"orderReqJson" type\x3d"text" value\x3d\''+jsonReqArg+"'\x3e";input+='\x3cinput name\x3d"state" type\x3d"text" value\x3d"0"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(ec.product.productType==9)if(parseInt(getSku.buttonMode)==18)input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"36"\x3e';else input+='\x3cinput name\x3d"routingTag" type\x3d"text" value\x3d"28"\x3e';var getSku=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);var form=$("#order-confirm-form").append(input);ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){form.submit()},500)})})};ec.diypkg.render=function(){if(!ec.diypkg.pkgs){ec.diypkg.hide();return false}var sku=ec.product.getSkuInfo(ec.product.getSku());if(!sku||!sku.code){ec.diypkg.hide();return false}if(sku.priceMode!=1){ec.diypkg.hide();return false}if(sku.buttonMode!=1&&sku.buttonMode!=3&&sku.buttonMode!=10&&sku.buttonMode!=8){ec.diypkg.hide();return false}if(sku.buttonMode==10){if(sku.startTime&&ec.util.parseDate(sku.startTime)>new Date){ec.diypkg.hide();return false}if(sku.endTime&&ec.util.parseDate(sku.endTime)<new Date){ec.diypkg.hide();return false}}sku.originPrice=parseFloat(sku.originPrice);sku.price=parseFloat(sku.price);var data=ec.diypkg.pkgs[sku.code];ec.diypkg.data=data;if(!data||!data.groupList||!data.groupList[0]||!data.groupList[0].packageList||!data.groupList[0].packageList.length){ec.diypkg.hide();return false}if(!$("#pro-global-parameter").attr("data-skulist-rushbuy"))if(!ec.product.inventory.haveInventory(sku.id)){ec.diypkg.hide();return false}data.price=sku.price;if(!data.res)data.res={tab:0,num:0,price:data.price,chked:{}};var res=data.res;ec.diypkg.res=res;if(!data.groupList[0].packageListGrouped)data.groupList.forEach(function(group,gidx){var tmpGrped=_.groupBy(group.packageList,"disPrdId");var tmpSort=[];data.groupList[gidx].packageListGrouped=[];group.packageList.forEach(function(sbom){if(tmpSort.indexOf(sbom.disPrdId)<0){tmpSort.push(sbom.disPrdId);data.groupList[gidx].packageListGrouped.push(tmpGrped[sbom.disPrdId])}})});var h='\x3cul data-size\x3d"" class\x3d"product-package-tab clearfix"\x3e';data.groupList.forEach(function(group,idx){var cssShow="";if(idx==res.tab)cssShow=' class\x3d"current"';h+="\x3cli"+cssShow+' data-min\x3d"'+group.minQuantiry+'" data-max\x3d"'+group.maxQuantity+'" data-idx\x3d"'+idx+'"\x3e';h+='\x3ca href\x3d"javascript:;" onclick\x3d"ec.diypkg.showTab(this)"\x3e'+group.groupName+"\x3c/a\x3e";h+="\x3c/li\x3e"});h+="\x3c/ul\x3e";h+='\x3cdiv class\x3d"product-recommend-con clearfix"\x3e';h+='\x3cdiv class\x3d"product-recommend-main"\x3e';h+='\x3cdiv class\x3d"product-recommend-thumbs"\x3e';h+='\x3cul class\x3d"clearfix"\x3e';h+="\x3cli\x3e";h+='\x3ca href\x3d"javascript:;"\x3e';h+='\x3cimg src\x3d"'+ec.mediaPath+sku.photoPath+"100_100_"+sku.photoName+'" alt\x3d""\x3e';h+="\x3cp\x3e"+sku.name+"\x3c/p\x3e";h+="\x3c/a\x3e";h+='\x3cdiv class\x3d"price"\x3e';h+='\x3cspan class\x3d"red" data-price\x3d"'+data.price+'"\x3e\x26yen;'+data.price+"\x3c/span\x3e";if(sku.originPrice!=data.price)h+="\x3cs\x3e\u00a5"+sku.originPrice+"\x3c/s\x3e";h+="\x3c/div\x3e";h+="\x3c/li\x3e";h+="\x3c/ul\x3e";h+="\x3c/div\x3e";h+="\x3c/div\x3e";data.groupList.forEach(function(group,idx){var cssRolling="";if(group.packageListGrouped.length>5)cssRolling=" goods-rolling";var cssShow="";if(idx!=res.tab)cssShow=' style\x3d"display: none;"';h+='\x3cdiv class\x3d"product-recommend-detail'+cssRolling+'"'+cssShow+"\x3e";h+='\x3cdiv class\x3d"product-recommend-thumbs swiper-container" id\x3d"j-swiper-'+idx+'"\x3e';h+='\x3cdiv class\x3d"grid-btn btn-prev swiper-button-prev j-prd-prev disabled"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e';h+='\x3cdiv class\x3d"grid-btn btn-next swiper-button-next j-prd-next"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e';h+='\x3cul class\x3d"clearfix swiper-wrapper j-grp" data-gid\x3d"'+idx+'"\x3e';group.packageListGrouped.forEach(function(pkg,pid){var cpkg={};pkg.forEach(function(b){if(res.chked[group.groupId+"_"+b.disPrdId]&&res.chked[group.groupId+"_"+b.disPrdId]==b.sbomCode)cpkg=b});if(!cpkg.sbomCode)cpkg=pkg[0];h+='\x3cli class\x3d"swiper-slide j-prd" data-pid\x3d"'+pid+'"\x3e';h+='\x3ca href\x3d"/product/'+cpkg.disPrdId+'.html" target\x3d"_blank" class\x3d"j-pimg"\x3e';h+='\x3cimg src\x3d"'+ec.mediaPath+cpkg.photoPath+"100_100_"+cpkg.photoName+'"\x3e';h+='\x3cp id\x3d"numb-time" title\x3d"'+cpkg.sbomName+'"\x3e'+cpkg.sbomName+"\x3c/p\x3e";h+="\x3c/a\x3e";var cssCRolling="";if(pkg.length>3)cssCRolling=" j-color-rolling";h+='\x3cdiv class\x3d"color-rolling'+cssCRolling+'"\x3e';h+='\x3cdiv class\x3d"color-rolling-detail" id\x3d"color-rolling-'+group.groupId+"-"+cpkg.disPrdId+'"\x3e';h+='\x3cdiv class\x3d"grid-btn swiper-button-prev btn-prev j-cbtn-prev disabled"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e';h+='\x3cdiv class\x3d"grid-btn swiper-button-next btn-next j-cbtn-next disabled"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e';h+='\x3cul class\x3d"clearfix swiper-wrapper" style\x3d"width: 600px;"\x3e';pkg.forEach(function(b){var cssSelect="";if(cpkg.sbomCode==b.sbomCode)cssSelect=" selected";h+='\x3cli class\x3d"swiper-slide'+cssSelect+'" data-code\x3d"'+b.sbomCode+'"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.diypkg.attr(this);"\x3e\x3cimg src\x3d"'+ec.mediaPath+b.photoPath+"100_100_"+b.photoName+'"\x3e\x3c/a\x3e\x3c/li\x3e'});h+="\x3c/ul\x3e";h+="\x3c/div\x3e";h+="\x3c/div\x3e";h+='\x3cdiv class\x3d"price"\x3e';var chked="";if(res.chked[group.groupId+"_"+cpkg.disPrdId])chked=' checked\x3d"checked"';h+='\x3cinput class\x3d"j-input" type\x3d"checkbox" name\x3d"skuId[]" value\x3d"1" data-id\x3d"'+group.groupId+"_"+cpkg.disPrdId+'" data-code\x3d"'+cpkg.sbomCode+'" autocomplete\x3d"off" data-price\x3d"'+cpkg.packagePrice+'"'+chked+"\x3e";h+='\x3cspan class\x3d"red"\x3e\x26yen;'+cpkg.packagePrice+"\x3c/span\x3e";var attrOriPrice="";if(cpkg.price==cpkg.packagePrice)attrOriPrice=' style\x3d"display: none;"';h+="\x3cs"+attrOriPrice+"\x3e\x26yen;"+cpkg.price+"\x3c/s\x3e";h+="\x3c/div\x3e";h+="\x3c/li\x3e"});h+="\x3c/ul\x3e";h+="\x3c/div\x3e";h+="\x3c/div\x3e"});h+='\x3cul class\x3d"product-recommend-operation"\x3e';h+='\x3cli class\x3d"chk-num"\x3e\u6bcf\u4e2a\u5957\u9910\u642d\u914d\x3cem\x3e'+res.num+"\x3c/em\x3e\u4ef6\x3c/li\x3e";h+='\x3cli class\x3d"product-recommend-price chk-price"\x3e\u7ec4\u5408\u4ef7\uff1a\x3cspan\x3e\x26yen;'+res.price+"\x3c/span\x3e\x3c/li\x3e";if($("#pro-operation a:first-child").text()=="\u52a0\u5165\u8d2d\u7269\u8f66"&&$("#pro-operation a:odd").children().text()=="\u7acb\u5373\u4e0b\u5355"){h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button01" title\x3d"\u52a0\u5165\u8d2d\u7269\u8f66" onclick\x3d"ec.diypkg.addCart(this);"\x3e\u52a0\u5165\u8d2d\u7269\u8f66\x3c/a\x3e\x3c/li\x3e';h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"\u7acb\u5373\u4e0b\u5355" onclick\x3d"ec.diypkg.order(this);"\x3e\u7acb\u5373\u4e0b\u5355\x3c/a\x3e\x3c/li\x3e'}else{if($("#pro-operation a:first-child").text()=="\u6682\u65f6\u7f3a\u8d27"||$("#pro-operation a:first-child").text()=="\u5df2\u552e\u5b8c"){ec.diypkg.hide();return false}if($("#pro-operation a:odd").children().text()=="\u6682\u65f6\u7f3a\u8d27"||$("#pro-operation a:odd").children().text()=="\u5df2\u552e\u5b8c"){ec.diypkg.hide();return false}if($("#pro-operation a:first-child").text()=="\u63d0\u524d\u767b\u5f55")h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"'+$("#pro-operation a:first-child").text()+'" onclick\x3d"rush.business.clickBtn()"\x3e'+$("#pro-operation a:first-child").text()+"\x3c/a\x3e\x3c/li\x3e";if($("#pro-operation a:odd").children().text()=="\u63d0\u524d\u767b\u5f55")h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"'+$("#pro-operation a:odd").children().text()+'" onclick\x3d"rush.business.clickBtn()"\x3e'+$("#pro-operation a:odd").children().text()+"\x3c/a\x3e\x3c/li\x3e";if($("#pro-operation a:first-child").text()=="\u7acb\u5373\u7533\u8d2d"&&$("#pro-operation a:first-child").hasClass("disabled"))h+='\x3cli\x3e\x3ca class\x3d"product-button02 disabled" title\x3d"'+$("#pro-operation a:first-child").text()+'"\x3e'+$("#pro-operation a:first-child").text()+"\x3c/a\x3e\x3c/li\x3e";else if($("#pro-operation a:first-child").text()=="\u7acb\u5373\u7533\u8d2d")h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"'+$("#pro-operation a:first-child").text()+'" onclick\x3d"rush.business.clickBtn(2)"\x3e'+$("#pro-operation a:first-child").text()+"\x3c/a\x3e\x3c/li\x3e";if($("#pro-operation a:odd").text()=="\u7acb\u5373\u7533\u8d2d"&&$("#pro-operation a:odd").hasClass("disabled"))h+='\x3cli\x3e\x3ca class\x3d"product-button02 disabled" title\x3d"'+$("#pro-operation a:odd").text()+'"\x3e'+$("#pro-operation a:odd").text()+"\x3c/a\x3e\x3c/li\x3e";else if($("#pro-operation a:odd").children().text()=="\u7acb\u5373\u7533\u8d2d")h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"'+$("#pro-operation a:odd").children().text()+'" onclick\x3d"rush.business.clickBtn(2)"\x3e'+$("#pro-operation a:odd").children().text()+"\x3c/a\x3e\x3c/li\x3e";if($("#pro-operation a:first-child").text()=="\u7acb\u5373\u767b\u5f55")h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"'+$("#pro-operation a:first-child").text()+'" onclick\x3d"rush.business.clickBtn()"\x3e'+$("#pro-operation a:first-child").text()+"\x3c/a\x3e\x3c/li\x3e";if($("#pro-operation a:odd").children().text()=="\u7acb\u5373\u767b\u5f55")h+='\x3cli\x3e\x3ca href\x3d"javascript:;" class\x3d"product-button02" title\x3d"'+$("#pro-operation a:odd").children().text()+'" onclick\x3d"rush.business.clickBtn()"\x3e'+$("#pro-operation a:odd").children().text()+"\x3c/a\x3e\x3c/li\x3e"}h+="\x3c/ul\x3e";h+="\x3c/div\x3e";$("#product-recommend-all").html(h).show();$('#product-recommend-all input[name\x3d"skuId[]"]').bind("change",function(){var itkey=$(this).attr("data-id");if($(this).attr("checked")){ec.diypkg.res.chked[itkey]=$(this).attr("data-code");ec.diypkg.res.num++;ec.diypkg.res.price+=parseFloat($(this).attr("data-price"));ec.diypkg.res.price=parseFloat(ec.diypkg.res.price.toFixed(2))}else{ec.diypkg.res.chked[itkey]=false;ec.diypkg.res.num--;ec.diypkg.res.price-=parseFloat($(this).attr("data-price"));ec.diypkg.res.price=parseFloat(ec.diypkg.res.price.toFixed(2))}$("#product-recommend-all .product-recommend-operation .chk-num em").textS(ec.diypkg.res.num);$("#product-recommend-all .product-recommend-operation .chk-price span").textS("\x26yen;"+ec.diypkg.res.price)});$(".goods-rolling:visible").each(function(){$(this).closest(".product-recommend-con").addClass("product-recommend-rolling")});$(".goods-rolling .swiper-container").each(function(){ec.diypkg.initSwiper("#"+$(this).attr("id"),5,"j-prd")});$(".j-color-rolling .color-rolling-detail").each(function(){ec.diypkg.initSwiper("#"+$(this).attr("id"),3,"j-cbtn")});return true};ec.diypkg.initSwiper=function(xpath,num,btnPrefix){var jobj=$(xpath);var liNum=jobj.find(".swiper-slide").length;if(liNum>num)jobj.find("."+btnPrefix+"-next").removeClass("disabled");else{jobj.find("."+btnPrefix+"-prev").addClass("disabled");jobj.find("."+btnPrefix+"-next").addClass("disabled")}var mySwiper=new Swiper(xpath,{slidesPerView:num,slidesPerGroup:num,btnPrefix:btnPrefix});jobj.find("."+btnPrefix+"-prev").click(function(){mySwiper.swipePrev()});jobj.find("."+btnPrefix+"-next").click(function(){mySwiper.swipeNext()})};ec.diypkg.showTab=function(thix){ec.diypkg.res.tab=parseInt($(thix).closest("li").attr("data-idx"));ec.product.inventory.wait(function(){ec.diypkg.render()})};ec.diypkg.attr=function(thix){var jli=$(thix).closest("li");var sCode=jli.attr("data-code");var gid=jli.closest("ul.j-grp").attr("data-gid");var jprd=jli.closest("li.j-prd");var pid=jprd.attr("data-pid");var cpkg={};ec.diypkg.data.groupList[gid].packageListGrouped[pid].forEach(function(pkg){if(pkg.sbomCode==sCode)cpkg=pkg});if(!cpkg.sbomCode)return false;jli.siblings().removeClass("selected");jli.addClass("selected");var jpimg=jprd.find("a.j-pimg");jpimg.find("img").attrS("src",ec.mediaPath+cpkg.photoPath+"100_100_"+cpkg.photoName);jpimg.find("p").textS(cpkg.sbomName).attrS("title",cpkg.sbomName);var jprice=jprd.find("div.price");jprice.find("span").textS("\x26yen;"+cpkg.packagePrice);jprice.find("s").textS("\x26yen;"+cpkg.price);if(cpkg.packagePrice==cpkg.price)jprice.find("s").hide();else jprice.find("s").show();var jinput=jprice.find("input.j-input");var oriPrice=parseFloat(jinput.attr("data-price"));jinput.attr("data-code",sCode).attr("data-price",cpkg.packagePrice);var itkey=jinput.attr("data-id");if(ec.diypkg.res.chked[itkey]){ec.diypkg.res.chked[itkey]=sCode;ec.diypkg.res.price=ec.diypkg.res.price-oriPrice+cpkg.packagePrice;ec.diypkg.res.price=parseFloat(ec.diypkg.res.price.toFixed(2));$("#product-recommend-all .product-recommend-operation .chk-price span").textS("\x26yen;"+ec.diypkg.res.price)}};ec.diypkg.hide=function(){$("#product-recommend-all").html("").hide()};ec.diypkg.init=function(){ec.diypkg.hideAll();ec.product.inventory.wait(function(){if(!ec.diypkg.render())ec.multiComb.init()})};ec.diypkg.hideAll=function(){$("#product-recommend-all").html("").hide();$("#product-recommend-all2").closest(".layout").hide()};ec.pkg("ec.multiComb");ec.multiComb.init=function(){var sku=ec.product.getSku();var layout=$("#product-recommend-all2").closest(".layout");var combList=$("#comb-list-"+sku);if(combList&&combList.length>0&&ec.product.productType!=4){$("#product-recommend-all2 .product-package-tab").hide();$("#product-recommend-all2 .product-recommend-con").hide();$("#comb-list-"+sku).show();$("div[id^\x3d'comb-pro-"+sku+"-0'] ").show();layout.show();$(".goods-rolling .swiper-container").each(function(){ec.diypkg.initSwiper("#"+$(this).attr("id"),5,"swiper-button")})}else layout.hide();var flag=0;$("div[id^\x3d'comb-list-'] input").unbind("click");$("div[id^\x3d'comb-list-"+sku+"-'] input").bind("click",function(){$(this).attr("disabled","disabled");if(flag!=0)return;if($(this).hasClass("protect")==false){$(this).addClass("protect");$(this).attr("checked","checked")}else{$(this).removeClass("protect");$(this).removeAttr("checked")}var dataIndex=$(this).attr("data-index");var productNum=$("#comb-count-"+sku+"-"+dataIndex).html();var totalPrice=parseFloat($("#comb-price-"+sku+"-"+dataIndex).html());flag=1;if($(this).attr("checked")){price=totalPrice+parseFloat($(this).attr("data-price"));productNum++}else{price=totalPrice-parseFloat($(this).attr("data-price"));productNum--}$("#comb-price-"+sku+"-"+dataIndex).html(price.toFixed(2));$("#comb-count-"+sku+"-"+dataIndex).html(productNum);flag=0;$(this).removeAttr("disabled")})};ec.product.showPosters=function(){var sku=ec.product.getSkuInfo(ec.product.getSku());var timeIn=function(start,end,now){now=now?ec.util.parseDate(now):new Date;start=start?ec.util.parseDate(start):new Date(now.getTime()+1E8);end=end?ec.util.parseDate(end):new Date(now.getTime()-1E8);return start<=now&&end>now};var html=[];if("undefined"===typeof prdPosters)prdPosters={prd:[],sbom:[]};var poster=_.find(prdPosters.sbom,function(o){return o.sbomCode===sku.code&&timeIn(o.startDate,o.endDate)});if(!poster)poster=_.find(prdPosters.prd,function(o){return timeIn(o.startDate,o.endDate)});if(poster)html.push('\x3cli\x3e\x3ca href\x3d"javascript:;"\x3e\x3cimg src\x3d"'+ec.mediaPath+poster.path+"78_78_"+poster.name+'" alt\x3d"'+sku.name+'"/\x3e\x3c/a\x3e\x3c/li\x3e');html.push('\x3cli\x3e\x3ca href\x3d"javascript:;"\x3e\x3cimg src\x3d"'+ec.mediaPath+sku.photoPath+"78_78_"+sku.photoName+'" alt\x3d"'+sku.name+'"/\x3e\x3c/a\x3e\x3c/li\x3e');if(sku.groupPhotoList)for(var i=0;i<sku.groupPhotoList.length;i++){var c=sku.groupPhotoList[i];html.push('\x3cli\x3e\x3ca href\x3d"javascript:;"\x3e\x3cimg src\x3d"'+ec.mediaPath+c.path+"/78_78_"+c.name+'"  alt\x3d"'+sku.name+'"/\x3e\x3c/a\x3e\x3c/li\x3e')}html=$(html.join(""));html.find("img").mouseover(_proGallerysMouseOver);$("#pro-gallerys").empty().html(html);$("#pro-gallerys li:first").addClass("current");var cimg=$("#pro-gallerys li:first img").attr("src");$("#product-img").attr("href",cimg.replace("78_78","800_800")).find("img").attr("src",cimg.replace("78_78","428_428"));$("#product-img").CloudZoom();setTimeout(function(){var imgLoader=new Image;imgLoader.onload=function(){$("#pic-container .cloud-zoom-loading").remove()};imgLoader.src=cimg.replace("78_78","800_800")},1E3);ec.product.imgSlider.reset()};ec.product.showPrice=function(depositObject){var sku=ec.product.getSkuInfo(ec.product.getSku());var price=parseFloat(sku.price);var originPrice=parseFloat(sku.originPrice);if(depositObject)if(depositObject.isSurePrice<1)price=0;$("#pro-price-label").removeClass("type").addClass("f24");$("#pro-price-label-deposit").hide();$("#pro-price-deposit").text("").hide();$("#pro-price-label-amount").hide();$("#pro-price-amount").text("").hide();$("#pro-price-hide").valS(price);$("#pro-price-old").text("").hide();if(price<.01||sku.priceMode==2){$("#pro-price-label").text("\u6682\u65e0\u62a5\u4ef7").show();$("#pro-price").text("").hide()}else{$("#pro-price-label").hide();$("#pro-price").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+price.toFixed(2)).show();if(originPrice!=price){$("#pro-price-old").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+originPrice.toFixed(2)).show();$("#pro-price-label").removeClass("f24").addClass("type").text("\u62a2\u8d2d\u4ef7").show()}}if(depositObject){if(depositObject.depositPrice){$("#pro-price-old").hide();$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+parseFloat(depositObject.depositPrice).toFixed(2)).show()}if(depositObject.amountPrice){$("#pro-price-label-amount").text("\u53ef\u62b5").show();$("#pro-price-amount").html("\x3cem\x3e\x26yen;\x3c/em\x3e"+parseFloat(depositObject.amountPrice).toFixed(2)).show()}}else $("#buyProcessIDD").hide();ec.product.refreshStyle()};$(function(){function getBtnDapData(){return{number:$("#pro-quantity").val(),SKUCode:$("#pro-sku-code").val(),packagecode:$("#packageCode").val(),packageSKUCode:$("#packageListCode").val(),click:1}}$("body").on("click","#pro-operation a.product-button01",function(){var d=getBtnDapData();d.buttonName=$(this).find("span").text();d.location=1;ec.dapClick("300020401",d)});$("body").on("click","#pro-operation a.product-button02",function(){var d=getBtnDapData();d.buttonName=$(this).find("span").text();if($("#pro-operation").attr("data-gift")>0)d.giftbuy=1;ec.dapClick("300020501",d)});$("#layoutRelative").on("click","a.product-button02",function(){var d=getBtnDapData();d.buttonName=$(this).text();d.location=2;ec.dapClick("300020401",d)});var names={"pro-tab-feature":"\u8be6\u60c5","pro-tab-parameter":"\u53c2\u6570","pro-tab-package-service":"\u5305\u88c5","pro-tab-evaluate":"\u8bc4\u4ef7"};$("#layoutRelative p a:visible").each(function(idx,self){$(self).click(function(){ec.dapClick("300021001",{productId:ec.product.id,index:idx,name:names[$(self).attr("id")],click:1})})})});$(function(){if(ec.product.seCode&&ec.product.seCode!=="VMALL-HUAWEIDEVICE"){var carrierCode=ec.product.seCode;$.ajax({url:"/queryCarrierCert.json",type:"post",data:{jsonParamString:JSON.stringify([carrierCode])},dataType:"json",success:function(r){if(r&&r.carrierCertList&&r.carrierCertList.length>0){var timeIn=function(start,end,now){now=now?ec.util.parseDate(now):new Date;start=start?ec.util.parseDate(start):new Date(0);end=end?ec.util.parseDate(end):new Date(now.getTime()+1E8);return start<=now&&end>now};var certs=_.filter(r.carrierCertList,function(v){return v.certStatus&&timeIn(v.startTime,v.endTime)});certs=_.sortBy(certs,"orderNum");if(certs.length>0){ec.Cache.set("carrierCert."+carrierCode,certs);$("#j-carrierCertBtn").show()}}}})}});ec.product.showCarrierCert=function(carrierCode){carrierCode=carrierCode||ec.product.seCode;var certs=ec.Cache.contains("carrierCert."+carrierCode);if(certs){var html="";certs.forEach(function(v){html+='\x3cp\x3e\x3cimg width\x3d"100%" src\x3d"'+ec.mediaPath+v.certFilePath+'" name\x3d"'+v.certName+'"\x3e\x3c/p\x3e'});html='\x3cdiv style\x3d"padding-right:7px; text-align: center; height: 412px; overflow: auto; margin-top: 8px;"\x3e'+html+"\x3c/div\x3e";(new ec.box(html,{boxid:"jb-showCarrierCert",boxclass:"ol_box_4",title:"\u5546\u5bb6\u8d44\u8d28\u8bc1\u7167",width:700,height:432,remember:false,showButton:false})).open()}else alert("\u6682\u65e0\u6570\u636e")};ec.pkg("ec.product");ec.load("ajax");ec.load("ec.dh");var _defaultAddress=["广东","深圳","龙岗区"];var _defaultTimeOut=1e4;var address=[];var tree_url=domainShoppingConfig+"/data/region/tree/{id}.json";var children_url=domainShoppingConfig+"/data/region/children/{id}.json";var addressInfoMap={};var commonAddress={};var _tempAddress=[];var _tempAddressIds=[];var addressConfig=null;var cache={},ajaxer;var skuAddress;var ipAddress=[];var ipAddressCookie=[];var sbomCode=null;ec.product.parseUrl=function(url,id){return url.replace(/{id}/g,id)};ec.product.processAddress=function(skuTmp){_tempAddressIds=[];_tempAddress=[];skuAddress=skuTmp;var provice=address[0];var proviceInfo=[];proviceInfo.push("<dt>选择新地址</dt>");if(provice!=null&&provice!=""){proviceInfo.push('<dd id="provice" level-value="1" data-value="" class="current">'+provice+"</dd>")}else{proviceInfo.push('<dd id="provice" level-value="1" data-value="">请选择</dd>')}proviceInfo.push('<dd id="city" level-value="2" data-value="">请选择</dd>');proviceInfo.push('<dd id="district" level-value="3" data-value="">请选择</dd>');$("#provice_info").html(proviceInfo.join(""));$("#provice_info").find("dd").bind("click",ec.product.againSelectAddress);ec.product.queryData(ec.product.parseUrl(tree_url,"0"),true,1,ec.product.queryProvince)};ec.product.againSelectAddress=function(){var id=$(this).attr("data-value");var addrType=parseInt($(this).attr("level-value"));if((id==null||id=="")&&addrType!=1){return}$(".address-new").find("dd").removeClass();switch(addrType){case 1:$("#provice").addClass("current");$("#city").html("请选择");break;case 2:$("#provice").removeClass("current");$("#city").addClass("current");break;case 3:$("#provice").removeClass("current");$("#city").removeClass("current");$("#district").addClass("current");break}if(addrType==1){ec.product.queryData(ec.product.parseUrl(tree_url,"0"),true,1,ec.product.queryProvince)}else{var parentId=parseInt(id);ec.product.queryData(ec.product.parseUrl(children_url,parentId),true,addrType,ec.product.queryProvince)}};ec.product.selectedAddress=function(){var districtId=$(this).attr("districtId");var addrId=$(this).attr("id");var amount=skuAddress.price;ec.util.cookie.set("selectedAddress",$(this).attr("provinceId")+"|"+$(this).attr("cityId")+"|"+districtId,{expires:30,domain:"vmall.com"});ec.util.cookie.set("shopAddressID",addrId,{expires:30,domain:"vmall.com"});ec.product.showAddress(commonAddress[addrId]);ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,districtId,amount,null,sbomCode)};ec.product.changeAddress=function(){var id=$(this).attr("id");_tempAddressIds.push(id);_tempAddress.push($(this).html());var name=ec.product.replaceChar($(this).html());var addrType=parseInt($(this).attr("addrType"));$(".address-new").find("dd").removeClass();switch(addrType){case 1:$("#provice").html(name);$("#city").attr("data-value",id);$("#provice").removeClass("current");$("#city").addClass("current");break;case 2:$("#city").html(name);$("#district").attr("data-value",id);$("#provice").removeClass("current");$("#city").removeClass("current");$("#district").addClass("current");break;case 3:$("#district").html(name);$("#district").attr("data-value",id);$("#provice").removeClass("current");$("#city").removeClass("current");$("#district").addClass("current");$("#address_table").hide();break}if(addrType<3){ec.product.queryData(ec.product.parseUrl(children_url,id),true,addrType+1,ec.product.queryProvince)}else{if(addrType==3&&_tempAddress.length==3&&_tempAddressIds.length==3){address=_tempAddress;ec.product.showAddress(address);ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,_tempAddressIds[2],skuAddress.price,null,sbomCode);ec.util.cookie.set("selectedAddress",_tempAddressIds[0]+"|"+_tempAddressIds[1]+"|"+_tempAddressIds[2],{expires:30,domain:"vmall.com"})}}};ec.product.userAddress=function(addressListInfo,addrFlag){var htmlFtl=[],lst=addressListInfo;htmlFtl.push("<dt>常用地址</dt>");commonAddress={};for(var i=0;i<lst.length;i++){var tempCommonAddress=[];var provinceName=lst[i].provinceName;var cityName=lst[i].cityName;var districtName=ec.product.replaceChar(lst[i].districtName);var streetName=lst[i].streetName==null?"":lst[i].streetName;addressInfoMap[lst[i].id]=provinceName+"&nbsp;"+cityName+"&nbsp;"+districtName+streetName+"&nbsp;"+ec.autoEncodeAttr(lst[i].address);var newTitle=addressInfoMap[lst[i].id];htmlFtl.push('<dd title="'+newTitle+'" id="'+lst[i].id+'" provinceId="'+lst[i].province+'" cityId="'+lst[i].city+'" districtId = "'+lst[i].district+'">'+cityName+"&nbsp;"+districtName+"</dd>");tempCommonAddress.push(provinceName);tempCommonAddress.push(cityName);tempCommonAddress.push(lst[i].districtName);commonAddress[lst[i].id]=tempCommonAddress}$("#in_common_use_address").html(htmlFtl.join(""));$("#in_common_use_address").find("dd").bind("click",ec.product.selectedAddress)};ec.product.queryTips=function(addressId,obj){$("#deatilAddress").html(addressInfoMap[addressId]);$("#deatilAddress").css("position","absolute");$("#deatilAddress").css("z-index","9999");$("#deatilAddress").css("top",parseInt(obj.position().top)+obj.innerHeight()+12+"px");$("#deatilAddress").css("display","block");$("#deatilAddress").show()};ec.product.queryProvince=function(addressListInfo,addrType,K){var lst;if(addrType==1){lst=addressListInfo.data[0]}else{lst=addressListInfo.data}var htmlFtl=[];var lstLength=lst.length;htmlFtl.push('<table style="min-height=180px;" width="100%" border="0" cellpadding="0" cellspacing="0">');htmlFtl.push("<tbody>");var position=0;for(var i=0;i<lstLength;i++){if(position==0){htmlFtl.push("<tr>")}var nodeName=ec.product.replaceChar(lst[i].name);nodeName=ec.autoEncodeAttr(nodeName);htmlFtl.push('<td id="'+lst[i].id+'" addrType="'+addrType+'">'+nodeName+"</td>");position=position+1;if(position==4||i==lstLength-1){position=0;htmlFtl.push("</tr>")}}htmlFtl.push("</tbody>");htmlFtl.push("</table>");$("#address_table").css({"min-height":"180px"}).html(htmlFtl.join(""));$("#address_table").find("td").bind("click",ec.product.changeAddress);$("#address_table").show();if(ec.account.isLogin()){ec.addr.list(ec.product.userAddress)}};ec.product.queryData=function(url,usecache,addrType,callback){var json;if(usecache&&(json=cache[url])){return callback(json,addrType)}if(ajaxer){ajaxer.abort()}ajaxer=$.ajax({url:url,dataType:"json",beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(usecache)cache[url]=json;callback(json,addrType)},error:function(xhr,status){logger.warn("load data fail.")}})};var isSucTemp=false;ec.product.processExpectDelivery=function(skuTmp){address=[];skuAddress=skuTmp;var passDistrict=true;if(ec.product.status==3){ec.product.hiddenTips();passDistrict=false}if(ec.product.seCode!=ec.product.productSeCode||parseInt(ec.product.productType)!=0){ec.product.hiddenTips();passDistrict=false}var normalButton=skuAddress.buttonMode;if(parseInt(normalButton)!=1&&parseInt(normalButton)!=10){ec.product.hiddenTips();passDistrict=false}if(parseInt(normalButton)==11||parseInt(normalButton)==16){ec.product.hiddenTips();return}if(parseInt(normalButton)==10){var _now=ec.product.getSysDate();var end=ec.product.getSkuInfo(skuAddress.id||ec.product.defaultSku).endTime;var endTime=new Date;if(null==end||""==end){endTime=new Date(2999,1,1,0,0,0)}else{endTime.setTime(ec.util.parseDate(end))}if(_now-endTime>0){ec.product.hiddenTips();passDistrict=false}}if(ec.product.isSupportDisTime=="0"){passDistrict=false}if(!passDistrict){var resultjson=JSON.parse(ec.product.deliveryArrival.transHtmlAttribute()||null);if(resultjson!=undefined&&resultjson!=""){ec.product.processPreDeliveryAndArrivalTime(resultjson[skuAddress.id],false)}else{ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,null,null,null,skuTmp.code)}return}isSucTemp=true;var selectedAddress=ec.util.cookie.get("selectedAddress");if(selectedAddress==null){if(ec.account.isLogin()){ec.product.getUserDefaultAddress()}else{ec.product.parseCookie()}}else{var addressArray=selectedAddress.split("|");if(addressArray.length==3){var distrackId=addressArray[2];ec.product.queryData(ec.product.parseUrl(tree_url,distrackId),true,1,ec.product.getCitydistrict)}}};ec.product.processSupportDisplayDilieryTime=function(sku){sbomCode=sku.code;ec.product.processExpectDelivery(sku)};ec.product.parseCookie=function(){var _ipCookieAddress=ec.util.cookie.get("ipaddress");if(_ipCookieAddress!=null){var _tmpIpAddrArray=_ipCookieAddress.split(",");var _temp=[];for(var i=0;i<3;i++){_temp[i]=_tmpIpAddrArray[i]}ec.product.showAddress(_temp);var amount=skuAddress.price;ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,_tmpIpAddrArray[3],amount,"-1",sbomCode)}else{ec.product.getUserAddressByIP(ec.product.addressCall)}};ec.product.getCitydistrict=function(addressListInfo){address=[];var addrsIdArray=addressListInfo.values;var proviceAddrs=addressListInfo.data[0];for(var i=0;i<proviceAddrs.length;i++){var json=proviceAddrs[i];if(json.id==addrsIdArray[0]){address.push(json.name)}}var cityAddrs=addressListInfo.data[1];for(var i=0;i<cityAddrs.length;i++){var json=cityAddrs[i];if(json.id==addrsIdArray[1]){address.push(json.name)}}var districtAddrs=addressListInfo.data[2];for(var i=0;i<districtAddrs.length;i++){var json=districtAddrs[i];if(json.id==addrsIdArray[2]){address.push(json.name)}}var addressId=addrsIdArray[2];if($.trim(addressId)==""){ec.product.hiddenTips();return}ec.product.showAddress(address);var amount=skuAddress.price;var selectedAddress=ec.util.cookie.get("selectedAddress");if(selectedAddress==null){var resultjson=JSON.parse(ec.product.deliveryArrival.transHtmlAttribute()||null);if(resultjson!=undefined&&resultjson!=""){ec.product.processPreDeliveryAndArrivalTime(resultjson[skuAddress.id],false)}}else{ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,addressId,amount,null,sbomCode)}};ec.product.addressCall=function(json){var userAddress=[];ipAddress=[];ipAddressCookie=[];if(json!=null&&json!=undefined&&json.success&&(json.address.province!=null&&json.address.province!="null"&&$.trim(json.address.province)!="")){userAddress.push(json.address.province);ipAddress.push(json.address.province);if(json.address.city=="null"||json.address.city==null||$.trim(json.address.city)==""){userAddress.push(null);ec.product.getAddressId(userAddress,ec.product.queryAddressByName)}else if(json.address.district=="null"||json.address.district==null||$.trim(json.address.district)==""){userAddress.push(json.address.city);ipAddress.push(json.address.city);userAddress.push(null);ec.product.getAddressId(userAddress,ec.product.queryAddressByName)}else{userAddress.push(json.address.city);userAddress.push(json.address.district);address=userAddress;ipAddressCookie[0]=userAddress;ec.product.getAddressId(address,ec.product.setIpCookie)}}else{address=_defaultAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}};ec.product.queryAddressByName=function(json,callback){var _tempAddress=[];var provinceId=json.provinceId;var cityId=json.cityId;var districtId=json.districtId;if(cityId!=null&&cityId!=""&&(districtId==null||districtId=="")){ec.product.queryData(ec.product.parseUrl(children_url,parseInt(cityId)),true,2,ec.product.queryCitydistrict)}else{ec.product.queryData(ec.product.parseUrl(children_url,parseInt(provinceId)),true,1,ec.product.queryCitydistrict)}};ec.product.queryCitydistrict=function(addressListInfo,addrType){var _address=addressListInfo.data;if(_address==null||$.trim(_address)==""||_address==undefined){address=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}else{var cityId=_address[0].id;ipAddress.push(_address[0].name.transHtmlAttribute());if(parseInt(addrType)==1){ec.product.queryData(ec.product.parseUrl(children_url,parseInt(cityId)),true,2,ec.product.queryCitydistrict)}else{address=ipAddress;ipAddressCookie.push(ipAddress);ec.product.getAddressId(ipAddress,ec.product.setIpCookie)}}};ec.product.saveIPAddressToCookie=function(ipAddressCookie){ec.util.cookie.set("ipaddress",ipAddressCookie,{expires:1/12,domain:"vmall.com"})};ec.product.setIpCookie=function(json){var addressId=json.districtId;ipAddressCookie.push(addressId);ec.product.saveIPAddressToCookie(ipAddressCookie);ec.product.getAddressIdCallBack(json)};ec.product.getUserDefaultAddress=function(){var defaulUserAddress=[];$.ajax({type:"get",url:domainShoppingConfig+"/address/getDefault.json?t="+(new Date).getTime(),dataType:"json",timeout:_defaultTimeOut,async:false,beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(!json.success||json.shoppingConfg==null||json.shoppingConfg==""){ec.product.parseCookie();return}ec.util.cookie.set("sc_p",json.pubkey);var _tempDefaulUserAddress=ec.lang.json.parse(json);_tempDefaulUserAddress=json.shoppingConfg;defaulUserAddress.push(_tempDefaulUserAddress.provinceName);defaulUserAddress.push(_tempDefaulUserAddress.cityName);defaulUserAddress.push(_tempDefaulUserAddress.districtName);if(defaulUserAddress==null||defaulUserAddress.length==0){ec.product.parseCookie()}else{address=defaulUserAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}},error:function(){address=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}})};ec.product.showSupportDisplayDilieryTime=function(info,isException){var tips="";if(!isException){if(info.length){var effectivenessTime=info.deliveryTime;var effectivenessTimeAndWeek=ec.product.getEffectivenessTime(effectivenessTime);tips="23:00前完成支付，预计"+effectivenessTimeAndWeek+"送达"}}$("#pro-predict").find("span:first").html(tips);ec.product.showTips();if(isException){$("#order_confirm_tips").hide()}};ec.product.getUserAddressByIP=function(callBack){$.ajax({url:"/getLocation.json",type:"get",dataType:"json",timeout:_defaultTimeOut,success:function(json){if(json.success){callBack(json)}else{address=_defaultAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}},error:function(){address=_defaultAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}})};ec.product.getAddressIdCallBack=function(json){var addressId=json.districtId;if($.trim(addressId)==""){ec.product.hiddenTips();return}ec.product.showAddress(address);var amount=skuAddress.price;ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,addressId,amount,null,sbomCode)};ec.product.getAddressId=function(address,callback){$.ajax({url:domainShoppingConfig+"/matchRegion.json",type:"get",dataType:"json",data:{provinceName:address[0],cityName:address[1],districtName:address[2]},timeout:_defaultTimeOut,beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(json.success){callback(json)}else{if(address!==_defaultAddress){address=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}}},error:function(){if(address!==_defaultAddress){address=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}}})};ec.product.showAddress=function(address){$("#address").find("a").textS(address[0]+"&nbsp;&gt;&nbsp;"+address[1]+"&nbsp;&gt;&nbsp;"+ec.product.replaceChar(address[2]))};ec.product.hiddenTips=function(){$("#product-pulldown1").addClass("product-description");$("#pro-predict").hide();$("#notesID").hide()};ec.product.showTips=function(){$("#product-pulldown1").removeClass("product-description");$("#pro-predict").show();$("#notesID").show()};ec.product.showExpectTime=function(flag){$("#product-pulldown1").removeClass("product-description");if(flag==1){$("#address").parent().hide()}else{if($("#address").find("a").html().length>1){$("#address").parent().show()}else{$("#address").parent().hide()}}$("#pro-predict").show()};ec.product.getEffectivenessTime=function(effectivenessTime,deadlineTime){var effectivenessTimeAndWeek;var _now=ec.product.getSysDate();var nowHours=_now.getHours();var date=_now.getTime();var newEffectiveTime=new Date;newEffectiveTime.setTime(date);deadlineTime=deadlineTime.substring(0,2);if(nowHours>=0&&nowHours<deadlineTime){newEffectiveTime.setHours(parseInt(deadlineTime)+effectivenessTime)}else{newEffectiveTime.setHours(parseInt(deadlineTime)+effectivenessTime)}var result=parseInt(newEffectiveTime.getMonth())+1+"月"+newEffectiveTime.getDate()+"日（"+ec.product.getWeekByTime(newEffectiveTime)+"）";return result};ec.product.getWeekByTime=function(effectivenessTime){var day=effectivenessTime.getDay();var week="";switch(day){case 0:week="周日";break;case 1:week="周一";break;case 2:week="周二";break;case 3:week="周三";break;case 4:week="周四";break;case 5:week="周五";break;case 6:week="周六";break}var now=new Date;var dateTemp=now.diff(effectivenessTime);if(dateTemp==0){week="今天"}if(dateTemp==1){week="明天"}return week};Date.prototype.diff=function(date){return Math.floor((date.getTime()-new Date((new Date).setHours(0,0,0,0)).getTime())/(24*60*60*1e3))};ec.product.replaceChar=function(srcChar){if(srcChar!=null&&srcChar!=""&&srcChar=="-"){return"其它地区"}else{return srcChar}};ec.product.processPreDeliveryAndArrivalTime=function(json,isException){ec.product.inventory.wait(function(){var tempWT=false;var tips=null,flag=0;var mode=skuAddress.buttonMode;var haveQuantity=ec.product.inventory.haveInventory(skuAddress.id);if(!isException){if(json&&json.success){var info=json.info;if(info.shippingDate&&info.shippingDate.length>0){if(mode==1&&!haveQuantity){tempWT=true}else{flag=1;tips=info.shippingDate;$(".product-address-prompt").find("em").eq(0).show();$("#expectTimeDesc").html("订单按照支付顺序发货，预计发货时间在支付全部完成前可能变更；预计发货时间根据商品库存信息计算得出，受诸多因素影响可能会产生偏差，我们会为您积极备货。");$("#notesDescription").hide().html("")}}else if(info.estimatedArrivalTime!=null&&info.estimatedArrivalTime!=""){flag=2;var timeTemp="";var toDate="";var estimatedArrivalTime=info.estimatedArrivalTime;if(json.beforeAndAfterFlag=="1"){timeTemp=estimatedArrivalTime.earlyArrivalTime;toDate="今天"}else{timeTemp=estimatedArrivalTime.lateArrivalTime;toDate="明天"}var effectivenessTimeAndWeek=ec.product.getEffectivenessTime(timeTemp,estimatedArrivalTime.deadlineTime);tips="<span class='red'>现货</span>，"+toDate+estimatedArrivalTime.deadlineTime+"前付款，"+"预计"+effectivenessTimeAndWeek+"送达";$(".product-address-prompt").find("em").eq(0).show();$("#expectTimeDesc").html("”预计送达时间”功能处于试运营，可能会略有偏差，最终以实际到货时间为准，如有疑问请您联系商城客服。感谢您对华为商城的支持和理解！");$("#notesDescription").show().html(estimatedArrivalTime.notes)}if(tips!=null){$("#pro-predict").find("span:first").html(tips);ec.product.showTips();ec.product.showExpectTime(flag)}else{if(tempWT){ec.product.hiddenTips()}if(info.arrivalTimeStatus=="1"){ec.product.hiddenTips()}if(info.arrivalTimeStatus=="2"){if(isSucTemp){$("#address").parent().show();ec.product.showTips();$("#pro-predict").find("span:first").html("<span class='red'>现货</span>");$(".product-address-prompt").find("em").eq(0).hide();$("#notesID").hide()}else{ec.product.hiddenTips()}}}ec.product.deliveryArrival="";var getSku=ec.product.getSkuInfo(ec.product.getSku());if((info.shippingDate==null||info.shippingDate=="")&&info.estimatedArrivalTime!=null&&info.estimatedArrivalTime!=""){if(ec.product.productType==4||parseInt(getSku.buttonMode)==8){ec.product.hiddenTips()}}}else{ec.product.hiddenTips()}}})};ec.pkg("ec.product.gift");ec.product.gift={proGiftChosenImgSrc:"",proGiftChosenImgAlt:"",proGiftGallerys:[],giftTrees:[],data:"",giftArrays:{},defaultGift:[],mainSkuGiftMap:{},mainSkuGiftKeyMap:{},defaultGiftMap:{},finalMainSbomGiftMap:{},packageGiftMap:{},tempMainSbomGiftMap:{},isChange:"true",picMediaServer:ec.mediaPath,sku:"",middleImgSize:"55_55_",navImgSize:"55_55_",ITEM_WIDTH:52,isChange:false,popupHtml:function(){var box=[],html=[],cnt=0,cntOne=0;var mainSKu="";var mainSbom=ec.product.getSku();defaultGift=this.defaultGiftMap[mainSbom];multiGiftVO=this.mainSkuGiftMap[mainSbom];multiGiftVOKeys=this.mainSkuGiftKeyMap[mainSbom];finalGift=this.finalMainSbomGiftMap[mainSbom]||{};giftSize=multiGiftVOKeys.length;var giftArrs=[],giftKeyArrs=[];for(var i=0;i<giftSize;i++){var gift=multiGiftVO[multiGiftVOKeys[i]];if(multiGiftVOKeys[i].indexOf("_")<0){if(i>0){html.push(this.renderSingleGift(giftKeyArrs,giftArrs));giftArrs=[];giftKeyArrs=[]}giftArrs.push(gift);giftKeyArrs.push(multiGiftVOKeys[i])}if(multiGiftVOKeys[i].indexOf("_")>0&&i>0){giftArrs.push(gift);giftKeyArrs.push(multiGiftVOKeys[i])}if(i==giftSize-1){html.push(this.renderSingleGift(giftKeyArrs,giftArrs));giftArrs=[];giftKeyArrs=[]}}box.push(html.join(" "));return box.join(" ")},renderSingleGift:function(giftKeyArrs,giftArrs){var len=giftArrs.length;defaultGift=giftArrs[0];finalGift=this.finalMainSbomGiftMap[this.sku];choseGift=finalGift[giftKeyArrs[0]];if(giftKeyArrs.length!=giftArrs.length){}html=[];if(choseGift!=null&&choseGift!=""){html.push('<div class="product-partscolor-layer">');html.push('<div class="product-partscolor-detail clearfix"> ');html.push('<a id="gift-detail-'+giftKeyArrs[0]+'"   href="/product/'+choseGift.giftId+".html#"+choseGift.giftSkuId+'" target="_blank">');html.push('<img class="product-partscolor-detailimg" src="'+ec.mediaPath+choseGift.photoPath+this.middleImgSize+choseGift.photoName+'">');html.push("</a>");html.push('<div class="product-partscolor-list"> ');html.push('<h2 id="gift-detail-name'+giftKeyArrs[0]+'">'+choseGift.giftName+"</h2>");html.push('<ul class="clearfix">');for(var i=0;i<len;i++){if(choseGift.giftSkuId==giftArrs[i].giftSkuId){html.push('<li class="selected h">')}else{html.push('<li class="h">')}html.push('<a href="javascript:;" key="'+giftKeyArrs[i]+'" defaultGiftKey="'+giftKeyArrs[0]+'" title="'+giftArrs[i].giftAttrVal+'">');html.push('<img src="'+ec.mediaPath+giftArrs[i].photoPath+this.navImgSize+giftArrs[i].photoName+'">');html.push("<p><span>"+giftArrs[i].giftAttrVal+"</span></p>");html.push('<input name= "box-value" type="hidden"  choseGiftKey="'+giftKeyArrs[i]+'" defaultGiftKey= "'+giftKeyArrs[0]+'"/>');html.push("</a>");html.push("</li>")}html.push("</ul>");html.push("</div>");html.push("</div> ");html.push("</div> ")}return html.join(" ")},ftl:function(mainSku){this.sku=ec.product.getSku();var ftl=[];var defaultGift=this.defaultGiftMap[mainSku];var multiGiftVO=this.mainSkuGiftMap[mainSku];var finalGift=this.finalMainSbomGiftMap[mainSku]||{};for(var i=0;i<defaultGift.length;i++){var gift=multiGiftVO[defaultGift[i]];if(gift){finalGift[gift.giftId]=gift;ftl.push('<a id="gift-'+gift.giftId+'"  href="/product/'+gift.giftId+".html#"+gift.giftSkuId+'" target="_blank" title="'+gift.giftName+'">');ftl.push('<img src="'+ec.mediaPath+gift.photoPath+this.navImgSize+gift.photoName+'" alt="'+gift.giftName+'"></a>')}}this.finalMainSbomGiftMap[mainSku]=finalGift;$("#pro-gift-list-detail").html(this.popupHtml());return ftl.join("")},init:function(mainSkuId,json){if(!json&&!mainSkuId){return}var multiGiftVO={};var multiGiftVOKeys=[];var defaultGift=[];this.giftArrays=json;var giftId=[];var index=0,indexForHeight=0;for(var i=0;i<json.length;i++){if(json[i].displayType==1){var gift=multiGiftVO[json[i].giftId];if(!gift){defaultGift.push(json[i].giftId);multiGiftVO[json[i].giftId]=json[i];multiGiftVOKeys.push(json[i].giftId);++indexForHeight}else{multiGiftVO[json[i].giftId+"_"+index]=json[i];multiGiftVOKeys.push(json[i].giftId+"_"+index);index++}}}this.mainSkuGiftMap[mainSkuId]=multiGiftVO;this.mainSkuGiftKeyMap[mainSkuId]=multiGiftVOKeys;this.defaultGiftMap[mainSkuId]=defaultGift},cloneObj:function(obj){var str,newobj=obj.constructor===Array?[]:{};if(typeof obj!=="object"){return}else if(window.JSON){str=JSON.stringify(obj),newobj=JSON.parse(str)}else{for(var i in obj){newobj[i]=typeof obj[i]==="object"?cloneObj(obj[i]):obj[i]}}return newobj},getGiftsSize:function(){var mainSbom=ec.product.getSku(),countGiftForBoxHeigth=0;multiGiftVOKeys=this.mainSkuGiftKeyMap[mainSbom];giftSize=multiGiftVOKeys.length;for(var i=0;i<giftSize;i++){if(multiGiftVOKeys[i].indexOf("_")<0){++countGiftForBoxHeigth}}return countGiftForBoxHeigth},showGiftPackageView:function(dom,flag){var packageHeight=0;if($(dom).length>0&&$(dom).position()){packageHeight=$(dom).position().top+29}if($(dom).find("img").length>0){packageHeight+=10}if($(dom).parent().parent().hasClass("selected")){if($("#giftPackageList").hasClass("hide")&&$("#giftPackageList").html()!=""&&flag){if(packageHeight)$(".product-choosepic .product-package-mini").css("top",packageHeight+"px");$("#giftPackageList").removeClass("hide");$(dom).parent().parent().addClass("click");if($("#product-operation").css("display")!="none"){$("#minButtom").html($("#pro-operation").html())}$("#minButtom").find("a").addClass("product-package-mini-btn");$("#minButtom").find(".product-time").remove();$("#minButtom").find(".product-button-tips").remove();$("#minButtom").find(".product-button-priority").remove();return}}var giftPackListHtml=[];var giftPackListLiHtml=[];var sku=ec.product.getSku();var skuInfo=ec.product.getSkuInfo(sku);var giftList_l=skuInfo.giftList;var giftList=[];for(var i=0;i<giftList_l.length;i++){if(giftList_l[i].displayType==2){giftList.push(giftList_l[i])}}var type="gift";if(giftList!=null&&giftList.length>0){giftPackListHtml.push('<div class="product-recommend product-package-mini">');giftPackListHtml.push('<div class="product-recommend-con clearfix">');giftPackListHtml.push('<div class="product-recommend-main">');giftPackListHtml.push('<div class="product-recommend-thumbs">');giftPackListHtml.push('<ul class="clearfix">');giftPackListHtml.push('<li> <a sku-id="'+skuInfo.id+'"> <img src="'+ec.mediaPath+skuInfo.photoPath+"100_100_"+skuInfo.photoName+'">');giftPackListHtml.push('<p title="'+skuInfo.name+'">'+skuInfo.name+"</p>");giftPackListHtml.push("</a></li></ul></div></div>");giftPackListHtml.push('<div class="goods-rolling product-recommend-detail">');giftPackListHtml.push('<div id="goodsRecommend-recommend-gift" class="product-recommend-thumbs">');giftPackListHtml.push('<div id="btn-prev-gift" class="grid-btn btn-prev disabled"><span></span></div>');giftPackListHtml.push('<div id="btn-next-gift" class="grid-btn btn-next"><span></span></div>');giftPackListHtml.push('<ul class=" swiper-wrapper clearfix" style="width: 1000px;">');for(var i=0;i<giftList.length;i++){if(giftList[i].displayType==2){giftPackListLiHtml.push('<li class="swiper-slide" attr-packageSkuCode="'+giftList[i].giftSkuCode+'"><a href="/product/'+giftList[i].giftId+".html#"+giftList[i].giftSkuId+'" target="_blank"><img src="'+ec.mediaPath+giftList[i].photoPath+"100_100_"+giftList[i].photoName+'">');giftPackListLiHtml.push('<p title="'+giftList[i].giftName+'">'+giftList[i].giftName+"</p></a>");giftPackListLiHtml.push('<dl class="color clearfix">');giftPackListLiHtml.push('<dd><a href="javascript:;" onclick="ec.product.packageChangeColor(this,\''+type+'\')" attr-name="'+giftList[i].giftName+'"interest-skuid="'+giftList[i].giftSkuId+'" attr-imgSrc="'+ec.mediaPath+giftList[i].photoPath+"100_100_"+giftList[i].photoName+'" attr-prdId="'+giftList[i].giftId+'" attr-packageskuCode="'+giftList[i].giftSkuCode+'">'+giftList[i].giftAttrVal+"</a></dd>");if(i!=giftList.length-1){var t=i;for(var q=1;q<giftList.length-t;q++){if(giftList[t].giftId==giftList[t+q].giftId){giftPackListLiHtml.push('<dd><a href="javascript:;" onclick="ec.product.packageChangeColor(this,\''+type+'\')" attr-name="'+giftList[t+q].giftName+'"interest-skuid="'+giftList[i].giftSkuId+'" attr-imgSrc="'+ec.mediaPath+giftList[t+q].photoPath+"100_100_"+giftList[t+q].photoName+'" attr-prdId="'+giftList[t+q].giftId+'" attr-packageskuCode="'+giftList[t+q].giftSkuCode+'">'+giftList[t+q].giftAttrVal+"</a></dd>");i=t+q}}}giftPackListLiHtml.push("</dl></li>")}}if(giftPackListLiHtml!=[]&&giftPackListLiHtml.length>0){if(flag){ec.product.packageViewChange(dom,"","gift")}else{$(dom).parent().parent().removeClass("click");$("#giftPackageList").addClass("hide")}giftPackListHtml.push(giftPackListLiHtml.join(""));giftPackListHtml.push("</ul></div></div></div>");giftPackListHtml.push('<div class="product-package-mini-tool clearfix" id="giftPackageButton">');giftPackListHtml.push('<p><span class="f14">套餐价：</span><strong class="red">');if(skuInfo.price&&skuInfo.price>0){giftPackListHtml.push("￥"+parseFloat(skuInfo.price).toFixed(2))}else{giftPackListHtml.push("暂无报价")}giftPackListHtml.push('</strong><span class="save"></span></p><div class="fr" id="minButtom">');if($("#product-operation").css("display")!="none"){giftPackListHtml.push($("#pro-operation").html())}giftPackListHtml.push("</div></div></div>");$("#giftPackageList").html(giftPackListHtml.join(""));if(packageHeight)$(".product-choosepic .product-package-mini").css("top",packageHeight+"px");$("#goodsRecommend-recommend-gift").find("li").each(function(){$(this).find("dd").first().addClass("selected")});$("#minButtom").find("a").addClass("product-package-mini-btn");$("#minButtom").find(".product-time").remove();$("#minButtom").find(".product-button-tips").remove();$("#minButtom").find(".product-button-priority").remove();ec.product.packageGetSkuCode("gift");if($("#pro-price").html()!=""&&$("#giftPackageList").html()!=null){if("暂无报价"!==$("#pro-price").text()){$("#pro-price-label").html("套餐价");$("#pro-price-label").removeClass("f24").addClass("type")}$("#pro-price-label").show()}ec.product.newPackageSwiper("-gift")}}else{$("#bundlePackageSelect").find("li").removeClass("click")}},updateOperationBtns:function(){$("#minButtom").html($("#pro-operation").html());$("#minButtom").find("a").addClass("product-package-mini-btn");$("#minButtom").find(".product-time").remove();$("#minButtom").find(".product-button-tips").remove();$("#minButtom").find(".product-button-priority").remove()}};ec.pkg("ec.product.interest");ec.product.interest.queryFreeDetail=function(){$("#prd-noInterset").addClass("hide");skuForInterest=ec.product.getSku();if(skuForInterest.priceMode==2){return}if($("#prd-noInterset").attr("interest-allow")!="1"){return}var h=0;var m="";m+=$("#pro-sku-code2").text()+"|";var c=$("#pro-price").text();c=parseFloat(c.substring(1,c.length));if(!c>0){return}h+=c;var f=($("#packageListCode").val()).split(",");for(var g=0;g<f.length;g++){if(f[g]!=""){m+=f[g]+"|"}}var l=ec.product.gift.packageGiftMap[ec.product.getSku()];if(l!=null){for(var g=0;g<l.length;g++){m+=l[g]+"|"}}var k=$("#extendSelect").attr("data-scode");var b=$("#extendSelect").attr("interest-price");var e=$("#accidentSelect").attr("data-scode");var n=$("#accidentSelect").attr("interest-price");var o=$("#ucareSelect").attr("data-scode");var d=$("#ucareSelect").attr("interest-price");var j=$("#giftBuy_dl").children(".product-choose-detail ").children().children("li.selected").find("a").attr("data-code");var a=$("#giftBuy_dl").children(".product-choose-detail ").children().children("li.selected").find("a").attr("interest-price");if(k!=null&&b!=null&&k!=""){m+=k+"|";h+=parseFloat(b)}if(e!=null&&n!=null&&e!=""){m+=e+"|";h+=parseFloat(n)}if(o!=null&&d!=null&&o!=""){m+=o+"|";h+=parseFloat(d)}if(j!=null&&a!=null&&j!=null){m+=j+"|";a=a.substring(1,a.length);h+=parseFloat(a)}if(h>0&&(m!=null&&m!="")){h=h+""}else{return}$.ajax({url:"/product/queryInterest.json",type:"get",dataType:"json",timeout:10000,data:{price:h,skuList:m},timeoutFunction:function(){if(!$("#prd-noInterset").hasClass("hide")){$("#prd-noInterset").addClass("hide")}$("#hbDetail").find("ul").html("");$("#hlDetail").find("ul").html("");$("#interestOrderNow").val("");$("#interestOrderNow2").val("");return},success:function(i){if(!i.success){if(!$("#prd-noInterset").hasClass("hide")){$("#prd-noInterset").addClass("hide")}$("#hbDetail").find("ul").html("");$("#hlDetail").find("ul").html("");$("#interestOrderNow").val("");$("#interestOrderNow2").val("");return}ec.product.interest.queryFreeDetailJsonShow(i);ec.product.refreshStyle()},error:function(){if(!$("#prd-noInterset").hasClass("hide")){$("#prd-noInterset").addClass("hide")}$("#hbDetail").find("ul").html("");$("#hlDetail").find("ul").html("");$("#interestOrderNow").val("");$("#interestOrderNow2").val("");return}})};ec.product.interest.queryFreeDetailJsonShow=function(e){if(e.hbNoINterestList.length>0||e.hlNoINterestList.length>0){var c=[];var a=[];if(!$("#interestHBPayNow").hasClass("disabled")){$("#interestHBPayNow").addClass("disabled")}if(!$("#interestPayHLNow").hasClass("disabled")){$("#interestPayHLNow").addClass("disabled")}$("#hbDetail").hide();$("#hlDetail").hide();$("#prd-noInterset").removeClass("hide");$("#hbShow").hide();$("#hlShow").hide();$("#interestOrderNow").val("");$("#interestOrderNow2").val("");if(e.hbNoINterestList.length>0){$("#hbShow").show();var d=[];for(var b=0;b<e.hbNoINterestList.length;b++){d.push('<li><a href="javascript:;" onclick="ec.product.interest.checkOne(this);" interest-info="1:'+e.hbNoINterestList[b].num+'">');d.push('<p class="price">&yen;&nbsp;'+e.hbNoINterestList[b].amount+"<em>x</em>"+e.hbNoINterestList[b].num+"\u671f</p>");if(e.hbNoINterestList[b].installmentFlag==0){d.push("<p>\u624b\u7eed\u8d39&yen;"+e.hbNoINterestList[b].fee+"/\u671f</p></a></li>")}else{d.push('<p class="red">\u514d\u606f\uff0c0\u624b\u7eed\u8d39</p></a></li>')}}$("#hbDetail").find("ul").html(d.join(""));$("#hbShow").find(".sku").unbind("mouseover");$("#hbShow").unbind("mouseleave");$("#hbShow").find(".sku").mouseover(function(){$("#hbDetail").show();$("#hbShow").addClass("click")});$("#hbShow").mouseleave(function(){$("#hbDetail").hide();$("#hbShow").removeClass("click")})}else{$("#hbShow").hide();$("#hbDetail").hide()}ec.product.showCmbSelector(e.hlNoINterestList,e.hbNoINterestList);if($("#prd-noInterset").attr("interest-button")=="0"){$("#interestHBPayNow").each(function(){$(this).addClass("disabled");this.backup=this.onclick;this.onclick=""});$("#interestPayHLNow").each(function(){$(this).addClass("disabled");this.backup=this.onclick;this.onclick=""})}}};ec.product.interest.checkOne=function(a){if($(a).parent().hasClass("selected")){$(a).parent().siblings().removeClass("selected");$(a).parent().removeClass("selected");$("#interestOrderNow").val("");$("#interestOrderNow2").val("");if(!$(a).parents(".product-stages-con").siblings(".product-package-mini-tool").find("a").hasClass("disabled")){$(a).parents(".product-stages-con").siblings(".product-package-mini-tool").find("a").addClass("disabled")}return}else{$(a).parent().siblings().removeClass("selected");$(a).parent().addClass("selected");var b=$(a).attr("interest-info").split(":")[0];if(b==2){$("#interestOrderNow2").val($(a).attr("interest-info"))}else{$("#interestOrderNow").val($(a).attr("interest-info"))}$(a).parents(".product-stages-con").siblings(".product-package-mini-tool").find("a").removeClass("disabled")}};ec.product.interest.payByInterest=function(b){var c="";var a="0:0";if(b===2){c="HL";if($("#interestPayHLNow").hasClass("disabled")){return}a=$("#hlDetail .product-stages-main li.selected a").attr("interest-info")}else{if(b===1){c="HB";if($("#interestHBPayNow").hasClass("disabled")){return}a=$("#hbDetail .product-stages-main li.selected a").attr("interest-info")}}a=a||"0:0";ec.dapClick(300021302,{SKUCode:ec.product.getSkuInfo(ec.product.getSku()).code,name:["","\u82b1\u5457\u5206\u671f","\u638c\u4e0a\u751f\u6d3b"][b],number:a.split(":")[1],click:1});ec.product.orderNow("2",c)};
ec.pkg("deposit");ec.product.depositInfo={};ec.product.depositInit=function(skuId){if(ec.product.runningSkuId!=skuId){return}ec.product.depositInfo={};if($("#product-deposit-agreement-area")){$("#product-deposit-agreement-area").hide()}$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").hide();$("#pro-operation").css("visibility","hidden");$("#buyProcessIDD").hide();$("#pro-price-label-deposit").html("订金");$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("暂无报价");$("#pro-price-old").html("");$("#pro-price-deposit").show();$("#pro-price-old").hide();$("#pro-operation").css("visibility","hidden");$("#tab-notice-button").hide();$("#tab-addcart-button").hide()};ec.product.isDespositSku=0;ec.product.runningSkuId=0;deposit.business={offsetTime:0,setOffsetTime:function(time1,time2){deposit.business.offsetTime=time2-time1},getSysDate:function(){return new Date((new Date).getTime()+deposit.business.offsetTime)}};ec.product.depositActivity=function(skuId){ec.product.inventory.wait(function(){var sku=ec.product.getSkuInfo(skuId);if(sku.buttonMode!=7){$("#pro-operation").css("visibility","hidden");$("#pro-operation").html("")}if($("#product-deposit-agreement-area")){$("#product-deposit-agreement-area").hide()}ec.product.isDespositSku=0;ec.product.runningSkuId=skuId;ec.ui.loading.show();(new ec.ajax).get({url:"/product/queryDeposit.json",data:{sbomCode:sku.code},timeout:1e4,timeoutFunction:function(){if(ec.product.runningSkuId!=skuId){return}ec.product.isDespositSku=2;if(sku.buttonMode==7){ec.product.showPrice();return false}if(sku&&sku.buttonMode==8){ec.product.rushbuyActivity(1)}else{ec.product.depositInit(skuId);alert(timeOutInfo)}$("#pro-price").html("暂无报价");$("#pro-price-deposit").html("暂无报价");$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("")},afterSendFunction:ec.ui.loading.hide,successFunction:function(json){$("#package_dl").remove();_updateSelect();if(ec.product.runningSkuId!=skuId){return}if(json.isSuccess=="false"||json.resultCode==0&&json.promoActivity==null||json.resultCode==0&&json.promoActivity==""){ec.product.isDespositSku=2;if(sku.buttonMode==7){ec.product.showPrice();return false}$("#buyProcessIDD").hide();$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("");if(sku&&sku.buttonMode==8){ec.product.rushbuyActivity(1)}else{ec.product.depositInit(skuId)}ec.product.showPrice();return}ec.product.isDespositSku=1;var depositArray=json.promoActivity.depositSkuList;var depositObject="";if(depositArray!=""){depositObject=depositArray[0]}if(sku.buttonMode==7&&(json.unStart=="unStart"||json.end=="end")){ec.product.showPrice(depositObject);return false}ec.product.depositInit(skuId);if(depositObject.isSurePrice<1){$("#pro-price").html("暂无报价")}else{var depositPrice=parseFloat($("#pro-price-hide").val());var skuPrice=parseFloat(ec.product.getSkuInfo(ec.product.getSku()).price);if(skuPrice>depositPrice){$("#pro-price").html("<em>&yen;</em>"+$("#pro-price-hide").val())}}ec.product.depositInfo=json;if(json.promoActivity.description.length>0){if($("#pro-parts-area").length>0)$("#pro-parts-area").find("dt").text("")}$("#buyProcessIDD").show();$("#balanceStartDateIDD").html(timestampToTime(json.deposit.balanceStartTime)+"&nbsp;~&nbsp;"+timestampToTime(json.deposit.balanceEndTime));if(sku&&sku.buttonMode!=8){$("#startDateIDD").html(timestampToTime(json.deposit.startTime)+"&nbsp;~&nbsp;"+timestampToTime(json.deposit.endTime))}else{$("#startDateIDD").html("提前锁定购买资格")}ec.product.showPrice(depositObject);if(ec.product.inventory.haveInventory(skuId)){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDeposit(1);">支付订金</a>');$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#product-operation").show()}else{$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()">到货通知</a>');$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#product-operation").show()}ec.product.refreshStyle();deposit.business.setOffsetTime((new Date).getTime(),json.serverCurrentTime);var nowDate=deposit.business.getSysDate();if(json.unStart=="unStart"){$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">活动即将开始</a><div id="pro-operation-countdown" class="product-time"></div>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();var startTimeStr=ec.util.parseDate(json.deposit.startTime).format("yyyy-MM-dd HH:mm:ss");var startTimeStrTemp=ec.util.parseDate(json.deposit.startTime).format("MM月dd日 HH:mm");var nowDate=deposit.business.getSysDate();ec.ui.countdown2($("#pro-operation-countdown"),{html:"<p>"+startTimeStrTemp+"开售:\t</p><ul><li><span>{#day}</span></li><li><em>天</em></li><li><span>{#hours}</span></li><li><em>:</em></li><li><span>{#minutes}</span></li><li><em>:</em></li><li><span>{#seconds}</span></li>",now:nowDate,endTime:startTimeStr,callback:function(json){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDeposit(1);">支付订金</a>');ec.product.gift.updateOperationBtns();if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}}});rush.business.timer=$($("#pro-operation-countdown")).data("countdown");if(!rush.business.timer){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDeposit(1);">支付订金</a>');if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}}ec.product.refreshStyle()}if(json.end=="end"){$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">活动已结束</a>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();ec.product.refreshStyle()}if(sku&&sku.buttonMode==8){ec.product.rushbuyActivity(2)}else{$("#goAddressId").hide()}ec.product.gift.updateOperationBtns()}})})};function timestampToTime(timestamp){var date=ec.util.parseDate(timestamp);Y=date.getFullYear()+".";M=(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+".";D=(date.getDate()<10?"0"+date.getDate():date.getDate())+" ";h=(date.getHours()<10?"0"+date.getHours():date.getHours())+":";m=date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes();return Y+M+D+h+m}ec.product.showDepositAgreement=function(){var boxHtml='<div class="box-agreement-area">'+ec.product.depositInfo.promoActivity.ruleText+"</div>";new ec.box(boxHtml,{boxclass:"ol_box_4 ol_box_agreement",title:"订金支付协议",width:678,height:350,autoHeight:false}).open()};ec.product.pushAddress=function(){ec.dapClick(3000020503,{SKUCode:$("#pro-sku-code2").text(),login:ec.account.isLogin()?0:1})};ec.product.payDeposit=function(type){if(!$("#pro-agreement-area-check").attr("checked")){var boxHtml='<div class="box-prompt-error-area"><div class="b"><p>您必须先勾选同意订金支付协议，才可以进行订金支付。</p></div></div>';new ec.box(boxHtml,{boxclass:"ol_box_4",title:"温馨提示",showCancel:false}).open();return}ec.account.afterLogin(function(){ec.binding.cart.withPhone(function(){dealDepositInfo(type)})})};dealDepositInfo=function(type){var buyQuantity=$("#pro-quantity").val();var skuId=ec.product.getSku()||ec.product.defaultSku;var orderItemReqArgList=[];var orderitem={};orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=$("#pro-quantity").val();orderitem.itemType="S0";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();if((finalGift||ec.product.gift.packageGiftMap[skuIds])&&type==1){var gifts2Order=[];if(finalGift){for(var key in finalGift){var aGift={sbomCode:finalGift[key].giftSkuCode};gifts2Order.push(aGift)}}if(ec.product.gift.packageGiftMap[skuIds]){for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={sbomCode:ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}}orderitem.gifts=gifts2Order}if(type==2){$('[id="comb-pro-'+skuId+'"]').find("input[name=skuId]:checked").each(function(){var orderitem={};orderitem.itemId=$(this).attr("data-scode");orderitem.qty=1;orderitem.itemType="S0";orderItemReqArgList.push(orderitem)})}orderitem.subOrderItemReqArgs=[];orderitem.subOrderItemReqArgs=ec.product.subServices(orderitem.subOrderItemReqArgs);orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);var input="";input+='<input name="orderReqJson" type="text" value=\''+jsonReqArg+"'>";input+='<input name="state" type="text" value="0">';$("#order-confirm-deposit-form").append(input).submit()};ec.pkg("depositNew");ec.product.depositInfoNew={};ec.product.depositInit_new=function(skuId){if(ec.product.runningSkuId!=skuId){return}ec.product.depositInfoNew={};if($("#product-deposit-agreement-area")){$("#product-deposit-agreement-area").hide()}$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").hide();$("#pro-operation").css("visibility","hidden");$("#buyProcessIDD").hide();$("#pro-price-label-deposit").html("");$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("");$("#pro-price-old").html("");$("#pro-price-deposit").show();$("#pro-price-old").hide();$("#pro-operation").css("visibility","hidden");$("#tab-notice-button").hide();$("#tab-addcart-button").hide()};ec.product.isDespositSku=0;ec.product.runningSkuId=0;depositNew.business={offsetTime:0,setOffsetTime:function(time1,time2){depositNew.business.offsetTime=time2-time1},getSysDate:function(){return new Date((new Date).getTime()+depositNew.business.offsetTime)}};ec.product.depositNewActivity=function(skuId){ec.product.inventory.wait(function(){var sku=ec.product.getSkuInfo(skuId);$("#product-recommend-all").hide();if($("#product-deposit-agreement-area")){$("#product-deposit-agreement-area").hide()}$("#pro-operation").css("visibility","hidden");ec.product.isDespositSku=0;ec.product.runningSkuId=skuId;$("#pro-operation").html("");(new ec.ajax).get({url:"/product/queryDeposit.json",data:{sbomCode:sku.code},timeout:1e4,timeoutFunction:function(){if(ec.product.runningSkuId!=skuId){return}ec.product.isDespositSku=2;if(sku&&sku.buttonMode==7){$("#pro-operation").css("visibility","visible");return}ec.product.depositInit_new(skuId);alert(timeOutInfo);$("#pro-price-deposit").html("暂无报价");$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("")},beforeSendFunction:function(xhr){ec.ui.loading.show()},afterSendFunction:ec.ui.loading.hide,successFunction:function(json){$("#package_dl").remove();_updateSelect();if(ec.product.runningSkuId!=skuId){return}if(json.isSuccess=="false"||json.resultCode==0&&json.promoActivity==null||json.resultCode==0&&json.promoActivity==""){ec.product.isDespositSku=2;if(sku&&sku.buttonMode==7){$("#pro-operation").css("visibility","visible");return}$("#pro-price-label-deposit").html("");$("#pro-price-label-deposit").show();$("#pro-price-deposit").show();$("#pro-price-deposit").html("");$("#buyProcessIDD").hide();$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("");ec.product.depositInit_new(skuId);return}ec.product.isDespositSku=1;ec.product.depositInit_new(skuId);var depositArray=json.promoActivity.depositSkuList;var depositObject="";if(depositArray!=""){depositObject=depositArray[0]}if(depositObject.isSurePrice<1){$("#pro-price").html("暂无报价")}else{$("#pro-price").html("<em>&yen;</em>"+$("#pro-price-hide").val())}ec.product.depositInfoNew=json;if(json.promoActivity.description.length>0){if($("#pro-parts-area").length>0)$("#pro-parts-area").find("dt").text("")}$("#buyProcessIDD").show();$("#balanceStartDateIDD").html(timestampToTime(json.deposit.balanceStartTime)+"&nbsp;~&nbsp;"+timestampToTime(json.deposit.balanceEndTime));if(sku&&sku.buttonMode!=8){$("#startDateIDD").html(timestampToTime(json.deposit.startTime)+"&nbsp;~&nbsp;"+timestampToTime(json.deposit.endTime))}else{$("#startDateIDD").html("提前锁定购买资格")}$("#pro-price-label-deposit").html("订金");$("#pro-price-label-deposit").removeClass("f24").addClass("type");$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("<em>&yen;</em>"+depositObject.depositPrice.toFixed(2));$("#pro-price-deposit").show();if(depositObject.amountPrice>0){$("#pro-price-label-amount").html("可抵");$("#pro-price-label-amount").show();$("#pro-price-amount").html("<em>&yen;</em>"+depositObject.amountPrice.toFixed(2));$("#pro-price-amount").show()}else{$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("")}if(ec.product.inventory.haveInventory(skuId)){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDepositNew(1);">支付订金</a>');$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#product-operation").show()}else{$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()">到货通知</a>');$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#product-operation").show()}ec.product.refreshStyle();depositNew.business.setOffsetTime((new Date).getTime(),json.serverCurrentTime);var nowDate=depositNew.business.getSysDate();if(json.unStart=="unStart"){$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">活动即将开始</a><div id="pro-operation-countdown" class="product-time"></div>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();var startTimeStr=ec.util.parseDate(json.deposit.startTime).format("yyyy-MM-dd HH:mm:ss");var startTimeStrTemp=ec.util.parseDate(json.deposit.startTime).format("MM月dd日 HH:mm");var nowDate=depositNew.business.getSysDate();ec.ui.countdown2($("#pro-operation-countdown"),{html:"<p>"+startTimeStrTemp+"开售:\t</p><ul><li><span>{#day}</span></li><li><em>天</em></li><li><span>{#hours}</span></li><li><em>:</em></li><li><span>{#minutes}</span></li><li><em>:</em></li><li><span>{#seconds}</span></li>",now:nowDate,endTime:startTimeStr,callback:function(json){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDepositNew(1);">支付订金</a>');ec.product.gift.updateOperationBtns();if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}}});rush.business.timer=$($("#pro-operation-countdown")).data("countdown");if(!rush.business.timer){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDepositNew(1);">支付订金</a>');if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}}ec.product.refreshStyle()}if(json.end=="end"){$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">活动已结束</a>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();ec.product.refreshStyle()}$("#goAddressId").hide();ec.product.gift.updateOperationBtns()}})})};function timestampToTime(timestamp){var date=ec.util.parseDate(timestamp);Y=date.getFullYear()+".";M=(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+".";D=(date.getDate()<10?"0"+date.getDate():date.getDate())+" ";h=(date.getHours()<10?"0"+date.getHours():date.getHours())+":";m=date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes();return Y+M+D+h+m}ec.product.showDepositAgreement=function(){var boxHtml='<div class="box-agreement-area">'+ec.product.depositInfoNew.promoActivity.ruleText+"</div>";new ec.box(boxHtml,{boxclass:"ol_box_4 ol_box_agreement",title:"订金支付协议",width:678,height:350,autoHeight:false}).open()};ec.product.payDepositNew=function(type){if(!$("#pro-agreement-area-check").attr("checked")){var boxHtml='<div class="box-prompt-error-area"><div class="b"><p>您必须先勾选同意订金支付协议，才可以进行订金支付。</p></div></div>';new ec.box(boxHtml,{boxclass:"ol_box_4",title:"温馨提示",showCancel:false}).open();return}ec.account.afterLogin(function(){ec.binding.cart.withPhone(function(){dealDepositInfoNew(type)})})};dealDepositInfoNew=function(type){var buyQuantity=$("#pro-quantity").val();var skuId=ec.product.getSku()||ec.product.defaultSku;var orderItemReqArgList=[];var orderitem={};orderitem.itemId=$("#pro-sku-code").val();orderitem.qty=$("#pro-quantity").val();orderitem.itemType="DE";var finalGift=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var skuIds=ec.product.getSku();if((finalGift||ec.product.gift.packageGiftMap[skuIds])&&type==1){var gifts2Order=[];if(finalGift){for(var key in finalGift){var aGift={sbomCode:finalGift[key].giftSkuCode};gifts2Order.push(aGift)}}if(ec.product.gift.packageGiftMap[skuIds]){for(var giftKey=0;giftKey<ec.product.gift.packageGiftMap[skuIds].length;giftKey++){var pGift={sbomCode:ec.product.gift.packageGiftMap[skuIds][giftKey]};gifts2Order.push(pGift)}}orderitem.gifts=gifts2Order}if(type==2){$('[id="comb-pro-'+skuId+'"]').find("input[name=skuId]:checked").each(function(){var orderitem={};orderitem.itemId=$(this).attr("data-scode");orderitem.qty=1;orderitem.itemType="S0";orderItemReqArgList.push(orderitem)})}orderitem.subOrderItemReqArgs=[];orderitem.subOrderItemReqArgs=ec.product.subServices(orderitem.subOrderItemReqArgs);orderItemReqArgList.push(orderitem);var jsonReqArg=ec.lang.json.stringify(orderItemReqArgList);var input="";input+='<input name="orderReqJson" type="text" value=\''+jsonReqArg+"'>";input+='<input name="state" type="text" value="0">';$("#order-confirm-deposit-form-new").append(input).submit()};ec.pkg("ec.product.coupon");ec.load("ec.box");ec.product.coupon={sbomCouponList:{},applyResultList:{},loadCoupon:function(sbom){ec.product.coupon.loadCouponEx(sbom,function(json){if(json&&json.success&&json.couponList&&json.couponList.length>0){ec.product.coupon.sbomCouponList[sbom]=json.couponList;$("#couponBtn").show();$("#couponTag").html("");var couponTagHtml=[];if(json.couponList.length>3){for(var i=0;i<json.couponList.length;i++){if(i<3){if(json.couponList[i].couponTag!=null){couponTagHtml.push("<span onclick=\"ec.product.coupon.clickBtn('"+ec.encodeForJS(sbom)+'\')" class="product-ticket">'+json.couponList[i].couponTag+"</span>")}}if(i>=3){break}}}else{for(var i=0;i<json.couponList.length;i++){if(json.couponList[i].couponTag!=null){couponTagHtml.push("<span onclick=\"ec.product.coupon.clickBtn('"+ec.encodeForJS(sbom)+'\')" class="product-ticket">'+json.couponList[i].couponTag+"</span>")}}}couponTagHtml.push(' <a href="javascript:;" id="immediatelyReceiveID" class="product-ticket-link" onclick="ec.product.coupon.clickBtn(\''+ec.encodeForJS(sbom)+"')\">立即领取&nbsp;&gt;</a>");$("#couponTag").html(couponTagHtml.join(" "))}else{ec.product.coupon.sbomCouponList[sbom]="";$("#couponBtn").hide()}},function(json){},function(){})},loadCouponEx:function(sbom,successCallback,errorCallback,timoutCallback){$.ajax({url:"/product/queryCoupon.json",type:"post",data:{sbom:sbom},dataType:"json",timeout:1e4,success:function(json){successCallback(json);return},error:function(){errorCallback(json)}})},clickBtn:function(sbom){ec.product.coupon.showDialog(sbom)},closeDialog:function(){$("#pro-roll-page").hide()},showDialog:function(sbom){$("#pro-roll-message").html("");$("#pro-roll-list").html("");$("#pro-roll-page").hide();var couponList=ec.product.coupon.sbomCouponList[sbom];if(couponList){ec.product.coupon.showDialogEx(sbom,couponList)}else{ec.product.coupon.loadCouponEx(sbom,function(json){if(json&&json.success&&json.couponList&&json.couponList.length>0){ec.product.coupon.sbomCouponList[sbom]=json.couponList;ec.product.coupon.showDialogEx(sbom,json.couponList)}else{}},function(){},function(){})}},showDialogEx:function(sbom,couponList){var box=new ec.box($("#pro-roll-textarea").val(),{boxid:"successBox",boxclass:"ol_box_4 ol_box_title",width:700,title:"领取优惠券",showButton:false,onopen:function(box){ec.product.coupon.couponBuildText(sbom,couponList);box.setPosition()},onclose:function(box){ec.product.coupon.closeDialog()}});box.open()},couponBuildText:function(sbom,couponList){var html=[];for(var i=0;i<couponList.length;i++){var infoTitle="";var kindInfo=couponList[i].kind;if(kindInfo=="2"){infoTitle='<i class="tag"><span>叠加劵</span></i>'}paramsReceiveCoupon="'"+ec.encodeForJS(couponList[i].activityCode)+"','"+ec.encodeForJS(couponList[i].batchCode)+"','"+ec.encodeForJS(sbom)+"'";var detailId=couponList[i].activityCode+"-"+couponList[i].batchCode;var state="";var couponStyle="";var couponKind="";var priceLabel="";if(couponList[i].couponType==1&&couponList[i].deliveryFree==0){couponKind="<span>"+couponList[i].amount+"</span><p><strong>优惠券</strong></p>"+infoTitle;priceLabel="<em>&yen;</em>"}else if(couponList[i].couponType==2&&couponList[i].deliveryFree==0){couponStyle=" roll-discount";couponKind="<span>"+couponList[i].discount*10+"</span><p><b>折</b></p>"}else{couponStyle=" roll-type";couponKind="<span>免邮券</span>"+infoTitle}switch(couponList[i].state){case-1:html.push('<li id="roll-detail-'+detailId+'" class="roll-detail receive'+couponStyle+'" title="'+ec.autoEncodeAttr(couponList[i].batchName)+'">');html.push(' <a id="roll-link-'+detailId+'" href="javascript:;" >'+priceLabel);state="已<br>领<br>完";break;case 1:html.push('<li id="roll-detail-'+detailId+'" class="roll-detail'+couponStyle+'" title="'+ec.autoEncodeAttr(couponList[i].batchName)+'">');html.push(' <a id="roll-link-'+detailId+'" href="javascript:;"  onclick="ec.product.coupon.receiveCoupon('+paramsReceiveCoupon+')">'+priceLabel);state="立<br>即<br>领<br>取";break;case 2:html.push('<li id="roll-detail-'+detailId+'" class="roll-detail receive'+couponStyle+'" title="'+ec.autoEncodeAttr(couponList[i].batchName)+'">');html.push(' <a id="roll-link-'+detailId+'" href="javascript:;" >'+priceLabel);state="已<br>领<br>取";break;case 3:html.push('<li id="roll-detail-'+detailId+'" class="roll-detail begin'+couponStyle+'" title="'+ec.autoEncodeAttr(couponList[i].batchName)+'">');html.push(' <a id="roll-link-'+detailId+'" href="javascript:;" >'+priceLabel);state="即<br>将<br>开<br>始";break;case 4:html.push('<li id="roll-detail-'+detailId+'" class="roll-detail disabled'+couponStyle+'" title="'+ec.autoEncodeAttr(couponList[i].batchName)+'">');html.push(' <a id="roll-link-'+detailId+'" href="javascript:;" >'+priceLabel);state="已<br>结<br>束";break;default:html.push('<li id="roll-detail-'+detailId+'" class="roll-detail'+couponStyle+'" title="'+ec.autoEncodeAttr(couponList[i].batchName)+'">');html.push(' <a id="roll-link-'+detailId+'" href="javascript:;" >'+priceLabel);state="";break}html.push(' <div class="roll-info">');html.push('  <div class="roll-price clearfix">');html.push(couponKind);html.push("  </div>");html.push(' <p class="roll-word">'+ec.autoEncodeAttr(couponList[i].batchName)+"</p>");html.push(' <p class="roll-time">'+ec.util.parseDate(couponList[i].beginDate).format("yyyy.MM.dd")+" - "+ec.util.parseDate(couponList[i].endDate).format("yyyy.MM.dd")+"</p>");html.push("</div>");html.push('<div id="roll-state-'+detailId+'" class="roll-btn">'+state+"</div>");html.push("</a></li>")}var html='<ul class="clearfix">'+html.join(" ")+"</ul>";$("#pro-roll-list").html(html);if(couponList.length==1){$("#pro-roll-list ul li").removeClass("disabled");$("#pro-roll-list ul li").addClass("roll-detail-one")}$("#pro-roll-page").show()},goLogin:function(){$(".box-cancel").click();var targetURL=domainMain+encodeURIComponent(window.location.pathname+"#"+ec.product.getSku());ec.account.afterLogin(function(){$("#immediatelyReceiveID").click()})},showMsg:function(msg,code){code=""+code;var html="";html="<span>"+msg+"</span>";switch(code){case"9206":html+='<a href="javascript:;" onclick="ec.product.coupon.goLogin()" >马上登录</a>';break;case"9208":html+='<a href="'+$("#accountCenterUrl").val()+'" target="_blank" >去绑定</a>';break;case"9209":html+='<a href="'+$("#authUrl").val()+'" target="_blank" >去认证</a>';break;case"9210":html+='<a href="'+$("#notFinishAllUPDataURL").val()+'" target="_blank" >完善资料</a>';break;default:html+=""}$("#pro-roll-message").html(html);$("#pro-roll-message").addClass("product-layer-tips")},receiveCoupon:function(activityCode,batchCode,sbom){var detailId=activityCode+"-"+batchCode;ec.product.syncCustomSession();$("#pro-roll-message").html("");$("#pro-roll-message").removeClass();$.ajax({url:openApiDomain+"/ams/coupon/receive?t="+(new Date).getTime(),type:"POST",dataType:"json",data:JSON.stringify({activityCode:activityCode,batchCode:batchCode}),timeout:1e4,beforeSend:function(xhr){xhr.withCredentials=true},success:function(json){if(json&&json.state){switch(json.state){case-1:$("#roll-detail-"+detailId).addClass("receive");$("#roll-state-"+detailId).html("已<br>领<br>完");$("#roll-link-"+detailId).removeAttr("onclick");break;case 1:break;case 2:$("#roll-detail-"+detailId).addClass("receive");$("#roll-state-"+detailId).html("已<br>领<br>取");$("#roll-link-"+detailId).removeAttr("onclick");break;case 3:$("#roll-detail-"+detailId).addClass("begin");$("#roll-state-"+detailId).html("即<br>将<br>开<br>始");$("#roll-link-"+detailId).removeAttr("onclick");break;case 4:$("#roll-detail-"+detailId).addClass("disabled");$("#roll-state-"+detailId).html("已<br>结<br>束");$("#roll-link-"+detailId).removeAttr("onclick");break;default:break}}if(json&&json.success){$("#pro-roll-message").html("<span>"+json.pcReviceSuccTip+"</span>");$("#pro-roll-message").addClass("product-layer-tips product-layer-success");delete ec.product.coupon.sbomCouponList[sbom];return}if(!json||!json.code){$("#pro-roll-message").addClass("product-layer-tips");$("#pro-roll-message").html("<span>亲，瞬间被你的热情吓到了，容我缓缓，请稍候再来哦~</span>");return}ec.product.coupon.showMsg(json.errorTip,json.code)},error:function(){$("#pro-roll-message").addClass("product-layer-tips");$("#pro-roll-message").html("<span>亲，瞬间被你的热情吓到了，容我缓缓，请稍候再来哦~</span>")}})}};